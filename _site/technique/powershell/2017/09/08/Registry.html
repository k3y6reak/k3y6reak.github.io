<!DOCTYPE html>
<html lang="en">

  



<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">
<link rel="stylesheet" href="/assets/css/cs_style.css">
<link rel="stylesheet" href="/assets/css/post.css">
<link rel="stylesheet" href="/assets/css/syntax.css">
<script src="https://code.jquery.com/jquery-3.1.1.slim.min.js" integrity="sha384-A7FZj7v+d/sdmMqp/nOQwliLvUsJfDHW+k9Omg/a/EheAdgtzNs3hpfag6Ed950n" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js" integrity="sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js" integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn" crossorigin="anonymous"></script>


  <body>

    <div class="container">
  <nav class="navbar navbar-default navbar-toggleable-md navbar-light bg-white">
  <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#containerNavbar" aria-controls="containerNavbar" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <a class="navbar-brand" href="/">K3Y6REAK</a>

  <div class="collapse navbar-collapse flex-row-reverse" id="containerNavbar">
    <ul class="navbar-nav my-2 my-md-0">
      <li class="nav-item active">
        <a class="nav-link" href="/about.html">About</a>
      </li>

      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="http://example.com" id="dropdown04" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Programming</a>
        <div class="dropdown-menu" aria-labelledby="dropdown04">
          <a class="dropdown-item" href="/programming/c">C</a>
          <a class="dropdown-item" href="/programming/cpp">C++</a>
          <a class="dropdown-item" href="/programming/python">Python</a>
          <a class="dropdown-item" href="/programming/ruby">Ruby</a>
        </div>
      </li>

      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="http://example.com" id="dropdown04" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">High Level Technique</a>
        <div class="dropdown-menu" aria-labelledby="dropdown04">
          <a class="dropdown-item" href="/technique/reversing">Reversing</a>
          <a class="dropdown-item" href="/technique/android">Android</a>
          <a class="dropdown-item" href="/technique/system_hacking">System Hacking</a>
          <a class="dropdown-item" href="/technique/powershell">PowerShell</a>
          <a class="dropdown-item" href="/technique/web_hacking">Web Hacking</a>
          <a class="dropdown-item" href="/technique/shellcoding">Shellcoding</a>
          <a class="dropdown-item" href="/technique/windows_system">Windows System</a>
          <a class="dropdown-item" href="/technique/windows_forensic">Windows Forensic</a>
          <a class="dropdown-item" href="/technique/linux_forensic">Linux Forensic</a>
        </div>
      </li>

      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="http://example.com" id="dropdown04" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Wargame</a>
        <div class="dropdown-menu" aria-labelledby="dropdown04">
          <a class="dropdown-item" href="/wargame/reversing_kr">reversing.kr</a>
          <a class="dropdown-item" href="/wargame/pwnable_kr">pwnable.kr</a>
          <a class="dropdown-item" href="/wargame/wargame_kr">wargame.kr</a>
        </div>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="/ctfs">CTFs</a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="/misc">MISC</a>
      </li>

    </ul>
  </div>
</nav>
</div>

    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">Registry</h1>
    <p class="post-meta">
      <time datetime="2017-09-08T14:56:00+09:00" itemprop="datePublished">
        
        Sep 8, 2017
      </time>
      </p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <p><br /><br /></p>

<p>PowerShell에서 레지스트리에 접근하고자 하는 경우 <code class="highlighter-rouge">Get-Item</code>, <code class="highlighter-rouge">Get-ChildItem</code>, <code class="highlighter-rouge">Get-ItemProperty</code>를 사용할 수 있습니다.</p>

<h4 id="get-item">Get-Item</h4>

<figure class="highlight"><pre><code class="language-ps" data-lang="ps">PS C:\Users\k3y6reak&gt; Get-Item 'HKLM:\Software\Microsoft\Windows NT\CurrentVersion'


    Hive: HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT


Name                           Property
----                           --------
CurrentVersion                 SystemRoot                : C:\WINDOWS
                               BuildBranch               : rs2_release
                               BuildGUID                 : ffffffff-ffff-ffff-ffff-ffffffffffff
                               BuildLab                  : 15063.rs2_release.170317-1834
                               BuildLabEx                : 15063.0.amd64fre.rs2_release.170317-1834
                               CompositionEditionID      : Education
                               CurrentBuild              : 15063
                               CurrentBuildNumber        : 15063
                               CurrentMajorVersionNumber : 10
                               CurrentMinorVersionNumber : 0
                               CurrentType               : Multiprocessor Free
                               CurrentVersion            : 6.3
                               EditionID                 : Education
                               EditionSubstring          :
                               InstallationType          : Client
                               InstallDate               : 1502094253
                               ProductName               : Windows 10 Education
                               ReleaseId                 : 1703
                               SoftwareType              : System
                               UBR                       : 540
                               PathName                  : C:\WINDOWS
                               ProductId                 : 
                               DigitalProductId          : 
                               DigitalProductId4         : 
                               RegisteredOrganization    :
                               RegisteredOwner           : k3y6reak
                               InstallTime               : 131465678534059230</code></pre></figure>

<h4 id="get-itemproperty">Get-ItemProperty</h4>

<figure class="highlight"><pre><code class="language-ps" data-lang="ps">PS C:\Users\k3y6reak&gt; Get-ItemProperty 'HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion'


SystemRoot                : C:\WINDOWS
BuildBranch               : rs2_release
BuildGUID                 : ffffffff-ffff-ffff-ffff-ffffffffffff
BuildLab                  : 15063.rs2_release.170317-1834
BuildLabEx                : 15063.0.amd64fre.rs2_release.170317-1834
CompositionEditionID      : Education
CurrentBuild              : 15063
CurrentBuildNumber        : 15063
CurrentMajorVersionNumber : 10
CurrentMinorVersionNumber : 0
CurrentType               : Multiprocessor Free
CurrentVersion            : 6.3
EditionID                 : Education
EditionSubstring          :
InstallationType          : Client
InstallDate               : 1502094253
ProductName               : Windows 10 Education
ReleaseId                 : 1703
SoftwareType              : System
UBR                       : 540
PathName                  : C:\WINDOWS
ProductId                 : 
DigitalProductId          : 
DigitalProductId4         : 
RegisteredOrganization    :
RegisteredOwner           : k3y6reak
InstallTime               : 131465678534059230
PSPath                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion
PSParentPath              : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT
PSChildName               : CurrentVersion
PSDrive                   : HKLM
PSProvider                : Microsoft.PowerShell.Core\Registry</code></pre></figure>

<h4 id="get-childitem">Get-ChildItem</h4>

<figure class="highlight"><pre><code class="language-ps" data-lang="ps">PS C:\Users\k3y6reak&gt; Get-ChildItem 'HKLM:\software\microsoft\windows nt\CurrentVersion' -Recurse | more
Get-ChildItem : 요청한 레지스트리에 액세스할 수 없습니다.
위치 줄:1 문자:1
+ Get-ChildItem 'HKLM:\software\microsoft\windows nt\CurrentVersion' -R ...
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : PermissionDenied: (HKEY_LOCAL_MACH...lags\CIT\System:String) [Get-ChildItem], SecurityException
    + FullyQualifiedErrorId : System.Security.SecurityException,Microsoft.PowerShell.Commands.GetChildItemCommand


...(중략)


    Hive: HKEY_LOCAL_MACHINE\software\microsoft\windows nt\CurrentVersion


Name                           Property
----                           --------
Accessibility


    Hive: HKEY_LOCAL_MACHINE\software\microsoft\windows nt\CurrentVersion\Accessibility


Name                           Property
----                           --------
ATs


    Hive: HKEY_LOCAL_MACHINE\software\microsoft\windows nt\CurrentVersion\Accessibility\ATs


Name                           Property
----                           --------
animations                     Description   :
                               Profile       : &lt;HCIModel&gt;&lt;Accommodation type="mild cognitive" /&gt;&lt;Accommodation type="severe cognitive" /&gt;&lt;Accommodation type="severe vision" /&gt;&lt;Accommodation type="mild vision"
                               /&gt;&lt;/HCIModel&gt;
                               SimpleProfile : SystemSetting
                               StartExe      : 13
...(생략)</code></pre></figure>

<p>추가적으로 <code class="highlighter-rouge">Set-Location</code>을 이용하여 레지스트리에 직접 접근할 수 있습니다.</p>

<figure class="highlight"><pre><code class="language-ps" data-lang="ps">PS C:\Users\k3y6reak&gt; Set-Location Registry::
PS Microsoft.PowerShell.Core\Registry::&gt; ls


    Hive:


Name                           Property
----                           --------
HKEY_LOCAL_MACHINE
HKEY_CURRENT_USER
HKEY_CLASSES_ROOT
HKEY_CURRENT_CONFIG
HKEY_USERS
HKEY_PERFORMANCE_DATA          Global : {80, 0, 69, 0...}
                               Costly : {80, 0, 69, 0...}</code></pre></figure>

<p>이번에는 레지스트리를 수정하고 생성하는 방법을 알아 봅시다.</p>

<p><code class="highlighter-rouge">New-Item</code>, <code class="highlighter-rouge">New-ItemProperty</code>, <code class="highlighter-rouge">Rename-Item</code>, <code class="highlighter-rouge">Rename-ItemProperty</code>, <code class="highlighter-rouge">Set-ItemProperty</code>가 있습니다.</p>

<h4 id="new-item">New-Item</h4>

<figure class="highlight"><pre><code class="language-ps" data-lang="ps">PS C:\Users\k3y6reak&gt; Get-PSProvider

Name                 Capabilities                                                                     Drives
----                 ------------                                                                     ------
Registry             ShouldProcess, Transactions                                                      {HKLM, HKCU}
Alias                ShouldProcess                                                                    {Alias}
Environment          ShouldProcess                                                                    {Env}
FileSystem           Filter, ShouldProcess, Credentials                                               {C, D, E, Y...}
Function             ShouldProcess                                                                    {Function}
Variable             ShouldProcess                                                                    {Variable}

PS C:\Users\k3y6reak&gt; New-Item -Path HKCU:\k3y6reak


    Hive: HKEY_CURRENT_USER


Name                           Property
----                           --------
k3y6reak</code></pre></figure>

<p>위와 같이 스크립트를 실행하면 아래 그림 처럼 레지스트리를 등록할 수 있습니다.</p>

<p><img src="/img/powershell/registry/registry.png" alt="powershell_create_registry" /></p>

<h4 id="new-itemproperty">New-ItemProperty</h4>

<figure class="highlight"><pre><code class="language-ps" data-lang="ps">PS C:\Users\k3y6reak&gt; New-ItemProperty -Path HKCU:\k3y6reak\ -Name Reg1 -PropertyType String -Value 2


Reg1         : 2
PSPath       : Microsoft.PowerShell.Core\Registry::HKEY_CURRENT_USER\k3y6reak\
PSParentPath : Microsoft.PowerShell.Core\Registry::HKEY_CURRENT_USER
PSChildName  : k3y6reak
PSDrive      : HKCU
PSProvider   : Microsoft.PowerShell.Core\Registry</code></pre></figure>

<p>위와 같이 해당 위치에 값 또한 설정할 수 있습니다.</p>

<h4 id="rename-item">Rename-Item</h4>

<figure class="highlight"><pre><code class="language-ps" data-lang="ps">PS C:\Users\k3y6reak&gt; Rename-Item HKCU:\k3y6reak -newname k3y6reak2</code></pre></figure>

<p>특정 레지스트리의 이름을 변경할 수 있습니다.</p>

<h4 id="rename-itemproperty">Rename-ItemProperty</h4>

<figure class="highlight"><pre><code class="language-ps" data-lang="ps">PS C:\Users\k3y6reak&gt; Rename-ItemProperty HKCU:\k3y6reak2 -Name Reg1 -NewName Reg2</code></pre></figure>

<p>마찬가지로 특정 레지스트리의 값 또한 변경할 수 있습니다.</p>

<h4 id="set-itemproperty">Set-ItemProperty</h4>

<figure class="highlight"><pre><code class="language-ps" data-lang="ps">PS C:\Users\k3y6reak&gt; Set-ItemProperty -Path HKCU:\k3y6reak2 -Name Reg2 -Value 4855</code></pre></figure>


  </div>

  
</article>

      </div>
    </main>

    



<div class="container">
	<hr>
	<section class="float-left">
		&copy; 2017. SAHONG PAK all rights reserved.
	</section>
	<section class="float-right">
		<a href="http://blog.rebforpwn.com">
			<img src="/assets/img/rebforpwn.png" alt="RebForPwn" height="32" width="100">
		</a>

		<a href="http://">
		<img src="/assets/img/github.svg" alt="github" height="32" width="32">
		</a>

		<a href="mailto:k3y6reak@naver.com">
		<img src="/assets/img/mail.svg" alt="mail" height="32" width="32">
		</a>
	</section>
</div>

  </body>

</html>
