<!DOCTYPE html>
<html lang="en">

  



<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">
<link rel="stylesheet" href="/assets/css/cs_style.css">
<link rel="stylesheet" href="/assets/css/post.css">
<link rel="stylesheet" href="/assets/css/syntax.css">
<script src="https://code.jquery.com/jquery-3.1.1.slim.min.js" integrity="sha384-A7FZj7v+d/sdmMqp/nOQwliLvUsJfDHW+k9Omg/a/EheAdgtzNs3hpfag6Ed950n" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js" integrity="sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js" integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn" crossorigin="anonymous"></script>


  <body>

    <div class="container">
  <nav class="navbar navbar-default navbar-toggleable-md navbar-light bg-white">
  <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#containerNavbar" aria-controls="containerNavbar" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <a class="navbar-brand" href="/">K3Y6REAK</a>

  <div class="collapse navbar-collapse flex-row-reverse" id="containerNavbar">
    <ul class="navbar-nav my-2 my-md-0">
      <li class="nav-item active">
        <a class="nav-link" href="/about.html">About</a>
      </li>

      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="http://example.com" id="dropdown04" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Programming</a>
        <div class="dropdown-menu" aria-labelledby="dropdown04">
          <a class="dropdown-item" href="/programming/c">C</a>
          <a class="dropdown-item" href="/programming/cpp">C++</a>
          <a class="dropdown-item" href="/programming/python">Python</a>
          <a class="dropdown-item" href="/programming/ruby">Ruby</a>
        </div>
      </li>

      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="http://example.com" id="dropdown04" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">High Level Technique</a>
        <div class="dropdown-menu" aria-labelledby="dropdown04">
          <a class="dropdown-item" href="/technique/reversing">Reversing</a>
          <a class="dropdown-item" href="/technique/android">Android</a>
          <a class="dropdown-item" href="/technique/system_hacking">System Hacking</a>
          <a class="dropdown-item" href="/technique/powershell">PowerShell</a>
          <a class="dropdown-item" href="/technique/web_hacking">Web Hacking</a>
          <a class="dropdown-item" href="/technique/shellcoding">Shellcoding</a>
          <a class="dropdown-item" href="/technique/windows_system">Windows System</a>
          <a class="dropdown-item" href="/technique/windows_forensic">Windows Forensic</a>
          <a class="dropdown-item" href="/technique/linux_forensic">Linux Forensic</a>
        </div>
      </li>

      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="http://example.com" id="dropdown04" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Wargame</a>
        <div class="dropdown-menu" aria-labelledby="dropdown04">
          <a class="dropdown-item" href="/wargame/reversing_kr">reversing.kr</a>
          <a class="dropdown-item" href="/wargame/pwnable_kr">pwnable.kr</a>
          <a class="dropdown-item" href="/wargame/wargame_kr">wargame.kr</a>
        </div>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="/ctfs">CTFs</a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="/misc">MISC</a>
      </li>

    </ul>
  </div>
</nav>
</div>

    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">Recon and Scan</h1>
    <p class="post-meta">
      <time datetime="2017-09-21T21:00:00+09:00" itemprop="datePublished">
        
        Sep 21, 2017
      </time>
      </p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <p><br /><br /></p>

<p>PowerShell을 이용해 모의해킹을 진행하는 방법에 대해서 알아보겠습니다.</p>

<p>임의의 한 사이트에 대해 점검하고자 할 때 해당 서버가 정상적으로 작동하는지, 어떤 포트가 열려있는지에 대해서 알아보겠습니다. <code class="highlighter-rouge">허락받지 않은 곳에서 테스트를 할 경우에는 본인에게 책임이 있습니다.</code></p>

<p>점검하기 위해서 여러가지 PowerShell Script를 사용할 수 있습니다.</p>

<p><br /><br /></p>
<h4 id="nishang">Nishang</h4>
<p><a href="http://github.com/samratashok/nishang">여기</a>에서 PowerShell Script를 받을 수 있습니다.</p>

<p>해당 스크립트를 다운받고 <code class="highlighter-rouge">Import-Module</code>명령어를 이용해 nishang.psm1 을 불러옵니다.</p>

<figure class="highlight"><pre><code class="language-ps" data-lang="ps">PS C:\Users\k3y6reak\Desktop\PowerShell&gt; ls


    디렉터리: C:\Users\k3y6reak\Desktop\PowerShell


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
d-----   2017. 9. 21.   오후 5:57                nishang-master
d-----   2017. 9. 21.   오후 5:57                Posh-SecMod-master
d-----   2017. 9. 21.   오후 5:57                PowerSploit-master
d-----   2017. 9. 21.   오후 5:57                PowerTools-master
-a----   2017. 9. 20.   오후 8:46        1762079 nishang-master.zip
-a----   2017. 9. 20.   오후 8:49        1542881 Posh-SecMod-master.zip
-a----   2017. 9. 20.   오후 8:47        1898185 PowerSploit-master.zip
-a----   2017. 9. 20.   오후 8:48       10422636 PowerTools-master.zip

PS C:\Users\k3y6reak\Desktop\PowerShell&gt; Import-Module .\nishang-master\nishang.psm1
경고: 'nishang' 모듈에서 가져온 일부 명령 이름에 검색 가능성을 낮출 수 있는 승인되지 않은 동사가 포함되어 있습니다.
승인되지 않은 동사가 포함된 명령을 찾으려면 Verbose 매개 변수와 함께 Import-Module 명령을 다시 실행하십시오. 승인된
동사 목록을 보려면 Get-Verb를 입력하십시오.
경고: 가져온 일부 명령 이름에 다음과 같은 제한 문자가 하나 이상 들어 있습니다. # , ( )  [ ] &amp; - / \ $ ^ ; : " ' &lt; | ? @ ` * % + = ~</code></pre></figure>

<p>위에서 본 결과처럼 nishang.psm1이 제대로 실행되지 않은 것을 볼 수 있습니다.</p>

<p>이러한 경우 사용하고자하는 스크립트를 <code class="highlighter-rouge">Dot Sourcing</code> 방법으로 사용할 수 있습니다.
Dot Sourcing에 대한 설명은 <a href="https://k3y6reak.github.io/technique/powershell/2017/08/08/Functios.html">여기</a>를 참고해 주세요.</p>

<figure class="highlight"><pre><code class="language-ps" data-lang="ps">PS C:\Users\k3y6reak\Desktop\PowerShell&gt; . .\nishang-master\Scan\Invoke-PortScan.ps1
PS C:\Users\k3y6reak\Desktop\PowerShell&gt; Invoke-PortScan -StartAddress XXX.XXX.XXX.XXX -EndAddress XXX.XXX.XXX.XXX -ResolveHost

IPAddress       HostName            Ports
---------       --------            -----
XXX.XXX.XXX.XXX abcde.abcedf.ab.ab</code></pre></figure>

<p><code class="highlighter-rouge">StartAddress</code>에 시작할 IP주소를 넣어주고 <code class="highlighter-rouge">EndAddress</code>에 끝날 IP주소를 넣어주면 됩니다. 그러면 시작 IP부터 끝 IP까지 진행하면서 서버가 작동하는 IP 주소를 출력해 줍니다.</p>

<p>또한 열려있는 포트를 찾고자 한다면 -ResolveHost 옵션 대신 <code class="highlighter-rouge">ScanPort</code>옵션을 사용하면 됩니다.</p>

<figure class="highlight"><pre><code class="language-ps" data-lang="ps">PS C:\Users\k3y6reak\Desktop\PowerShell&gt; Invoke-PortScan -StartAddress XXX.XXX.XXX.XXX -EndAddress XXX.XXX.XXX.XXX -ScanPort

IPAddress       HostName Ports
---------       -------- -----
XXX.XXX.XXX.XXX          {80, 443}</code></pre></figure>

<p><br /><br /></p>
<h4 id="powersploit">PowerSploit</h4>
<p>이번에는 다른 스크립트를 사용해 보겠습니다. <a href="https://github.com/mattifestation/PowerSploit">여기</a>에서 PowerShell Script를 받을 수 있습니다.</p>

<p>DotSourcing 방식으로 <code class="highlighter-rouge">Get-HttpStatus</code> 스크립트를 가져옵니다.</p>

<figure class="highlight"><pre><code class="language-ps" data-lang="ps">PS C:\Users\k3y6reak\Desktop\PowerShell&gt; . .\PowerSploit-master\Recon\Get-HttpStatus.ps1
PS C:\Users\k3y6reak\Desktop\PowerShell&gt; Get-HttpStatus -Target XXX.XXX.XXX.XXX -Path .\PowerSploit-master\Recon\Dictionaries\generic.txt -Port 80 | Where-Object {$_.Status -match "ok"}</code></pre></figure>

<p>테스트 하고자 하는 서버에서 일치하는 결과값이 없기 때문에 출력이 안되지만 결과가 존재한다면 취약점으로 작용할 수 있습니다.</p>

<p>이 외에도 PowerTools, Posh-SecMod 등 여러가지 스크립트들이 있습니다.</p>

  </div>

  
</article>

      </div>
    </main>

    



<div class="container">
	<hr>
	<section class="float-left">
		&copy; 2017. SAHONG PAK all rights reserved.
	</section>
	<section class="float-right">
		<a href="http://blog.rebforpwn.com">
			<img src="/assets/img/rebforpwn.png" alt="RebForPwn" height="32" width="100">
		</a>

		<a href="http://">
		<img src="/assets/img/github.svg" alt="github" height="32" width="32">
		</a>

		<a href="mailto:k3y6reak@naver.com">
		<img src="/assets/img/mail.svg" alt="mail" height="32" width="32">
		</a>
	</section>
</div>

  </body>

</html>
