<!DOCTYPE html>
<html lang="en">

  



<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">
<link rel="stylesheet" href="/assets/css/cs_style.css">
<link rel="stylesheet" href="/assets/css/post.css">
<link rel="stylesheet" href="/assets/css/syntax.css">
<script src="https://code.jquery.com/jquery-3.1.1.slim.min.js" integrity="sha384-A7FZj7v+d/sdmMqp/nOQwliLvUsJfDHW+k9Omg/a/EheAdgtzNs3hpfag6Ed950n" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js" integrity="sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js" integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn" crossorigin="anonymous"></script>


  <body>

    <div class="container">
  <nav class="navbar navbar-default navbar-toggleable-md navbar-light bg-white">
  <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#containerNavbar" aria-controls="containerNavbar" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <a class="navbar-brand" href="/">K3Y6REAK</a>

  <div class="collapse navbar-collapse flex-row-reverse" id="containerNavbar">
    <ul class="navbar-nav my-2 my-md-0">
      <li class="nav-item active">
        <a class="nav-link" href="/about.html">About</a>
      </li>

      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="http://example.com" id="dropdown04" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Programming</a>
        <div class="dropdown-menu" aria-labelledby="dropdown04">
          <a class="dropdown-item" href="/programming/c">C</a>
          <a class="dropdown-item" href="/programming/cpp">C++</a>
          <a class="dropdown-item" href="/programming/python">Python</a>
          <a class="dropdown-item" href="/programming/ruby">Ruby</a>
        </div>
      </li>

      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="http://example.com" id="dropdown04" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">High Level Technique</a>
        <div class="dropdown-menu" aria-labelledby="dropdown04">
          <a class="dropdown-item" href="/technique/reversing">Reversing</a>
          <a class="dropdown-item" href="/technique/system_hacking">System Hacking</a>
          <a class="dropdown-item" href="/technique/powershell">PowerShell</a>
          <a class="dropdown-item" href="/technique/web_hacking">Web Hacking</a>
          <a class="dropdown-item" href="/technique/shellcoding">Shellcoding</a>
          <a class="dropdown-item" href="/technique/windows_system">Windows System</a>
          <a class="dropdown-item" href="/technique/windows_forensic">Windows Forensic</a>
          <a class="dropdown-item" href="/technique/linux_forensic">Linux Forensic</a>
        </div>
      </li>

      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="http://example.com" id="dropdown04" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Wargame</a>
        <div class="dropdown-menu" aria-labelledby="dropdown04">
          <a class="dropdown-item" href="/wargame/reversing_kr">reversing.kr</a>
          <a class="dropdown-item" href="/wargame/pwnable_kr">pwnable.kr</a>
          <a class="dropdown-item" href="/wargame/wargame_kr">wargame.kr</a>
        </div>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="/ctfs">CTFs</a>
      </li>

    </ul>
  </div>
</nav>
</div>

    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">SHA2017 Suspect File1 (100)</h1>
    <p class="post-meta">
      <time datetime="2017-08-07T14:14:00+09:00" itemprop="datePublished">
        
        Aug 7, 2017
      </time>
      </p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <p><br /><br /></p>
<h3 id="문제">문제</h3>

<p>Suspect File 1 (100)</p>

<p>We found some software on our suspects development server, it looks like they created some different versions, are you able to crack the software?</p>

<p>Challenge created by the Digital and Biometric Traces division of the Netherlands Forensic Institute.</p>

<p><br /><br /></p>
<h3 id="풀이">풀이</h3>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="gp">root@ubuntu:/home/k3y6reak/Desktop# </span>./100
Sorry
<span class="gp">root@ubuntu:/home/k3y6reak/Desktop# </span>./100 a
Sorry</code></pre></figure>

<p>해당 바이너리를 실행하면 위와같이 Sorry만 출력한다.</p>

<p>IDA를 이용해서 디컴파일하여 소스코드를 보게 되면 아래와 같이 do~while()로 시작하는 것을 알 수 있으며 v10 값이 <code class="highlighter-rouge">0xc9702e05</code>되어야만 Yes!를 출력한다.</p>

<figure class="highlight"><pre><code class="language-c" data-lang="c">	<span class="k">do</span><span class="p">{</span>
		<span class="k">while</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="k">while</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
			<span class="p">{</span>
				<span class="p">...(</span><span class="err">생략</span><span class="p">)</span>
			<span class="p">}</span>
		<span class="p">}</span>
	<span class="p">}</span><span class="k">while</span><span class="p">(</span><span class="n">v10</span> <span class="o">!=</span> <span class="mh">0xc9702e05</span><span class="p">)</span></code></pre></figure>

<p>가장 처음 비교하는 부분인 <code class="highlighter-rouge">0x8048977</code>에 Breakpoint를 걸어두고 <code class="highlighter-rouge">finish</code> 명령을 계속해서 실행한다.</p>

<figure class="highlight"><pre><code class="language-ida" data-lang="ida">.text:08048977                 cmp     eax, 96C8ACCAh
.text:0804897C                 jg      short loc_8048990
.text:0804897E                 cmp     eax, 8FD5472Dh
.text:08048983                 jnz     short loc_8048977
.text:08048985                 jmp     short loc_8048940</code></pre></figure>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="o">[</span>----------------------------------registers-----------------------------------]
EAX: 0x5c4742c2
EBX: 0x8048164 <span class="o">(</span>&lt;_init&gt;:	push   ebx<span class="o">)</span>
ECX: 0x80ed5e8 --&gt; 0x0
EDX: 0xe6cbc1fb
ESI: 0x80ea0c4 --&gt; 0x8068270 <span class="o">(</span>&lt;__strcpy_sse2&gt;:	mov    edx,DWORD PTR <span class="o">[</span>esp+0x4]<span class="o">)</span>
EDI: 0x46 <span class="o">(</span><span class="s1">'F'</span><span class="o">)</span>
EBP: 0xffffd4f8 --&gt; 0x1000
ESP: 0xffffd370 <span class="o">(</span><span class="s2">"flag{57201791ea24f3acd852cee3271333a8}</span><span class="se">\0</span><span class="s2">02</span><span class="se">\0</span><span class="s2">02"</span><span class="o">)</span>
EIP: 0x8048977 <span class="o">(</span>&lt;main+263&gt;:	cmp    eax,0x96c8acca<span class="o">)</span>
EFLAGS: 0x246 <span class="o">(</span>carry PARITY adjust ZERO sign <span class="nb">trap </span>INTERRUPT direction overflow<span class="o">)</span>
<span class="o">[</span>-------------------------------------code-------------------------------------]
   0x804896d &lt;main+253&gt;:	or     cl,al
   0x804896f &lt;main+255&gt;:	mov    eax,0x6b8a9776
   0x8048974 &lt;main+260&gt;:	cmovne eax,edx
<span class="gp">=&gt; </span>0x8048977 &lt;main+263&gt;:	cmp    eax,0x96c8acca
   0x804897c &lt;main+268&gt;:	jg     0x8048990 &lt;main+288&gt;
   0x804897e &lt;main+270&gt;:	cmp    eax,0x8fd5472d
   0x8048983 &lt;main+275&gt;:	jne    0x8048977 &lt;main+263&gt;
   0x8048985 &lt;main+277&gt;:	jmp    0x8048940 &lt;main+208&gt;
<span class="o">[</span>------------------------------------stack-------------------------------------]
0000| 0xffffd370 <span class="o">(</span><span class="s2">"flag{57201791ea24f3acd852cee3271333a8}</span><span class="se">\0</span><span class="s2">02</span><span class="se">\0</span><span class="s2">02"</span><span class="o">)</span>
0004| 0xffffd374 <span class="o">(</span><span class="s2">"{57201791ea24f3acd852cee3271333a8}</span><span class="se">\0</span><span class="s2">02</span><span class="se">\0</span><span class="s2">02"</span><span class="o">)</span>
0008| 0xffffd378 <span class="o">(</span><span class="s2">"01791ea24f3acd852cee3271333a8}</span><span class="se">\0</span><span class="s2">02</span><span class="se">\0</span><span class="s2">02"</span><span class="o">)</span>
0012| 0xffffd37c <span class="o">(</span><span class="s2">"1ea24f3acd852cee3271333a8}</span><span class="se">\0</span><span class="s2">02</span><span class="se">\0</span><span class="s2">02"</span><span class="o">)</span>
0016| 0xffffd380 <span class="o">(</span><span class="s2">"4f3acd852cee3271333a8}</span><span class="se">\0</span><span class="s2">02</span><span class="se">\0</span><span class="s2">02"</span><span class="o">)</span>
0020| 0xffffd384 <span class="o">(</span><span class="s2">"cd852cee3271333a8}</span><span class="se">\0</span><span class="s2">02</span><span class="se">\0</span><span class="s2">02"</span><span class="o">)</span>
0024| 0xffffd388 <span class="o">(</span><span class="s2">"2cee3271333a8}</span><span class="se">\0</span><span class="s2">02</span><span class="se">\0</span><span class="s2">02"</span><span class="o">)</span>
0028| 0xffffd38c <span class="o">(</span><span class="s2">"3271333a8}</span><span class="se">\0</span><span class="s2">02</span><span class="se">\0</span><span class="s2">02"</span><span class="o">)</span>
<span class="o">[</span>------------------------------------------------------------------------------]
Legend: code, data, rodata, value

Breakpoint 1, 0x08048977 <span class="k">in </span>main <span class="o">()</span>
gdb-peda<span class="err">$</span></code></pre></figure>

<p><code class="highlighter-rouge">finish</code>명령을 계속해서 실행하면 위와같이 stack에 flag에 대한 정보가 나오게 된다.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="gp">root@ubuntu:/home/k3y6reak/Desktop# </span>./100 flag<span class="o">{</span>57201791ea24f3acd852cee3271333a8<span class="o">}</span>
Yes!
root@ubuntu:/home/k3y6reak/Desktop#</code></pre></figure>

<p>따라서 <code class="highlighter-rouge">flag{57201791ea24f3acd852cee3271333a8}</code>가 된다.</p>

  </div>

  
</article>

      </div>
    </main>

    



<div class="container">
	<hr>
	<section class="float-left">
		&copy; 2017. SAHONG PAK all rights reserved.
	</section>
	<section class="float-right">
		<a href="http://blog.rebforpwn.com">
			<img src="/assets/img/rebforpwn.png" alt="RebForPwn" height="32" width="100">
		</a>

		<a href="http://">
		<img src="/assets/img/github.svg" alt="github" height="32" width="32">
		</a>

		<a href="mailto:k3y6reak@naver.com">
		<img src="/assets/img/mail.svg" alt="mail" height="32" width="32">
		</a>
	</section>
</div>

  </body>

</html>
