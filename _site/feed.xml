<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>k3y6reak</title>
    <description>RebForPwn
</description>
    <link>http://localhost:4000/</link>
    <atom:link href="http://localhost:4000/feed.xml" rel="self" type="application/rss+xml"/>
    <pubDate>Mon, 22 Jan 2018 16:26:21 +0900</pubDate>
    <lastBuildDate>Mon, 22 Jan 2018 16:26:21 +0900</lastBuildDate>
    <generator>Jekyll v3.4.3</generator>
    
      <item>
        <title>Easy Crack</title>
        <description>&lt;h2 id=&quot;문제&quot;&gt;문제&lt;/h2&gt;
&lt;p&gt;&lt;img src=&quot;/img/wargame/reversing_kr/easy_crack.png&quot; alt=&quot;crackme&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;풀이&quot;&gt;풀이&lt;/h2&gt;

&lt;p&gt;먼저 Easy Crack이 어떤 언어로 만들어 졌는지 확인하기 위해 Exeinfo를 이용해 확인합니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/wargame/reversing_kr/exe_info.png&quot; alt=&quot;exe_info&quot; /&gt;&lt;/p&gt;

&lt;p&gt;위 그림을 보면 C++로 만들어졌진 것을 알 수 있습니다.&lt;/p&gt;

&lt;p&gt;이 문제는 전형적인 &lt;code class=&quot;highlighter-rouge&quot;&gt;CrackMe&lt;/code&gt;로 올바른 &lt;code class=&quot;highlighter-rouge&quot;&gt;키 값&lt;/code&gt;을 입력을 해야 합니다.&lt;/p&gt;

&lt;p&gt;IDA를 사용하면 엄청 쉽게 해결할 수 있지만, 분석하는 방법을 익히기 위해서 하나씩 살펴보도록 하겠습니다.&lt;/p&gt;

&lt;h3 id=&quot;직접-실행하기&quot;&gt;직접 실행하기&lt;/h3&gt;

&lt;p&gt;리버싱 문제를 해결하기 위해서 항상 프로그램을 직접 실행하여 어떻게 동작하는지, 어떤 문자열이 나타나는지 확인해야 합니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/wargame/reversing_kr/incorrect.png&quot; alt=&quot;incorrect&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;123&lt;/code&gt;이라는 문자열을 넣고 확인 버튼을 누르면 &lt;code class=&quot;highlighter-rouge&quot;&gt;incorrect password&lt;/code&gt;라는 문자열이 나타납니다. 그렇다면 올바른 password를 입력하면 아마도 &lt;code class=&quot;highlighter-rouge&quot;&gt;correct&lt;/code&gt;가 나타날 것이라고 생각할 수 있습니다.&lt;/p&gt;

&lt;h3 id=&quot;언어-패킹-유무-확인하기&quot;&gt;언어, 패킹 유무 확인하기&lt;/h3&gt;

&lt;p&gt;앞서 미리 Exeinfo를 이용해 확인을 했지만 다시 확인하자면 C++로 만들어졌고, 패킹은 안돼 있는 것을 알 수 있습니다.&lt;/p&gt;

&lt;h3 id=&quot;디버깅&quot;&gt;디버깅&lt;/h3&gt;

&lt;p&gt;분석할 때 사용할 프로그램은 x86DBG 입니다. 과거 ollydbg를 많이 사용했으나 현재는 x86dbg를 많이 사용하고 있습니다.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;키 값&lt;/code&gt;을 찾는 문제에서는 반드시 올바른 값인지에 대한 여부를 꼭 확인합니다.&lt;/p&gt;

&lt;p&gt;여기서 잠시 코딩을 생각해본다면 어떤 특정 값이 맞는지에 대한 여부는 보통 &lt;code class=&quot;highlighter-rouge&quot;&gt;조건문&lt;/code&gt;을 이용해 검사할 수 있습니다. (물론 여러 방법을 이용해 확인 할 수 있습니다.)&lt;/p&gt;

&lt;p&gt;그렇다면 어셈블리어에서 조건문에 해당하는 부분을 찾아야 하는데, 대부분의 조건문을 나타내는 어셈블리어는 &lt;code class=&quot;highlighter-rouge&quot;&gt;CMP ~ JMP(비교 ~ 점프)&lt;/code&gt;구문으로 이루어져 있습니다.&lt;/p&gt;

&lt;h3 id=&quot;문자열-찾기&quot;&gt;문자열 찾기&lt;/h3&gt;

&lt;p&gt;조건문 부분을 찾기 위해서는 &lt;code class=&quot;highlighter-rouge&quot;&gt;문자열&lt;/code&gt;을 찾아야 합니다. 앞서 직접 실행하면서 &lt;code class=&quot;highlighter-rouge&quot;&gt;Incorrect Password&lt;/code&gt;라는 문자열을 찾았습니다. 그렇다면 &lt;code class=&quot;highlighter-rouge&quot;&gt;확인&lt;/code&gt;버튼을 누르고 해당 문자열이 나타났기 때문에 문자열이 있는 근처에서 조건문이 실행됐다고 생각할 수 있습니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/wargame/reversing_kr/string.png&quot; alt=&quot;string&quot; /&gt;&lt;/p&gt;

&lt;p&gt;x86DBG에서는 &lt;code class=&quot;highlighter-rouge&quot;&gt;오른쪽 마우스 - Search for - Current Region(또는 All Modules) - String references&lt;/code&gt;에서 문자열을 찾을 수 있습니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;Address  Disassembly                       String                                     
004010BD push easy_crackme.406078          &lt;span class=&quot;s2&quot;&gt;&quot;5y&quot;&lt;/span&gt;
004010D1 mov esi,easy_crackme.40606C       &lt;span class=&quot;s2&quot;&gt;&quot;R3versing&quot;&lt;/span&gt;
00401116 push easy_crackme.406058          &lt;span class=&quot;s2&quot;&gt;&quot;EasyCrackMe&quot;&lt;/span&gt;
0040111B push easy_crackme.406044          &lt;span class=&quot;s2&quot;&gt;&quot;Congratulation !!&quot;&lt;/span&gt;
00401137 push easy_crackme.406058          &lt;span class=&quot;s2&quot;&gt;&quot;EasyCrackMe&quot;&lt;/span&gt;
0040113C push easy_crackme.406030          &lt;span class=&quot;s2&quot;&gt;&quot;Incorrect Password&quot;&lt;/span&gt;
00401C04 push easy_crackme.4050D4          &lt;span class=&quot;s2&quot;&gt;&quot;__MSVCRT_HEAP_SELECT&quot;&lt;/span&gt;
00401C43 push easy_crackme.4050BC          &lt;span class=&quot;s2&quot;&gt;&quot;__GLOBAL_HEAP_SELECTED&quot;&lt;/span&gt;
00401FE2 push easy_crackme.4053C4          &lt;span class=&quot;s2&quot;&gt;&quot;&amp;lt;program name unknown&amp;gt;&quot;&lt;/span&gt;
00402024 push easy_crackme.4053C0          &lt;span class=&quot;s2&quot;&gt;&quot;...&quot;&lt;/span&gt;
00402038 push easy_crackme.4053A4          &lt;span class=&quot;s2&quot;&gt;&quot;Runtime Error!&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;Program: &quot;&lt;/span&gt;
00402056 push easy_crackme.4053A0          &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
00402061 push dword ptr ds:[esi+406134]    &amp;amp;&lt;span class=&quot;s2&quot;&gt;&quot;R6002&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\r\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;- floating point not loaded&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\r\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
0040207E push easy_crackme.405378          &lt;span class=&quot;s2&quot;&gt;&quot;Microsoft Visual C++ Runtime Library&quot;&lt;/span&gt;
00402092 lea esi,dword ptr ds:[esi+406134] &amp;amp;&lt;span class=&quot;s2&quot;&gt;&quot;R6002&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\r\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;- floating point not loaded&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\r\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
00403CE1 push easy_crackme.40540C          &lt;span class=&quot;s2&quot;&gt;&quot;user32.dll&quot;&lt;/span&gt;
00403CF8 push easy_crackme.405400          &lt;span class=&quot;s2&quot;&gt;&quot;MessageBoxA&quot;&lt;/span&gt;
00403D09 push easy_crackme.4053F0          &lt;span class=&quot;s2&quot;&gt;&quot;GetActiveWindow&quot;&lt;/span&gt;
00403D11 push easy_crackme.4053DC          &lt;span class=&quot;s2&quot;&gt;&quot;GetLastActivePopup&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;문자열 중 직접 실행해서 찾은 &lt;code class=&quot;highlighter-rouge&quot;&gt;Incorrect Password&lt;/code&gt;가 존재하는 것을 확인 할 수 있고 &lt;code class=&quot;highlighter-rouge&quot;&gt;Congratulation !!&lt;/code&gt;이라는 문자열도 존재하는 것을 알 수 있습니다.&lt;/p&gt;

&lt;p&gt;그렇다면 올바른 키 값을 입력하면 &lt;code class=&quot;highlighter-rouge&quot;&gt;Congratulation !!&lt;/code&gt;이라는 문자열이 나타날 것으로 추측할 수 있습니다.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Incorrect Password&lt;/code&gt; 부분을 클릭하면 해당 문자열이 존재하는 주소로 이동하게 됩니다.&lt;/p&gt;

&lt;h3 id=&quot;cmp--jmp-구문-찾기&quot;&gt;CMP ~ JMP 구문 찾기&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;/img/wargame/reversing_kr/cmp_jmp.png&quot; alt=&quot;cmp_jmp&quot; /&gt;&lt;/p&gt;

&lt;p&gt;문자열을 찾아 이동한 후 위, 아래를 쭉 살펴봅니다. 위 그림을 살펴보면 &lt;code class=&quot;highlighter-rouge&quot;&gt;4010B0&lt;/code&gt; 주소에서 &lt;code class=&quot;highlighter-rouge&quot;&gt;0x61&lt;/code&gt;과 비교를 한 후 &lt;code class=&quot;highlighter-rouge&quot;&gt;JNE&lt;/code&gt;가 실행되는 것을 볼 수 있습니다. 그림의 왼쪽 화살표를 확인하면 좀 더 쉽게 살펴볼 수 있습니다.&lt;/p&gt;

&lt;p&gt;화살표들을 살펴보면 &lt;code class=&quot;highlighter-rouge&quot;&gt;4010B5&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;4010CD&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;40110B&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;401112&lt;/code&gt; 에서 조건을 확인하며 값이 정확하지 않을 경우 모두 &lt;code class=&quot;highlighter-rouge&quot;&gt;Incorrect Password&lt;/code&gt; 부분으로 넘어가는 것을 알 수 있습니다.&lt;/p&gt;

&lt;p&gt;그렇다면 이 부분들의 값을 정확히 맞춰주면 될 것이라 생각할 수 있습니다. 따라서 해당 부분 모두 BreakPoint를 걸어두고 &lt;code class=&quot;highlighter-rouge&quot;&gt;k3y6reak&lt;/code&gt;를 입력하고 진행해 보겠습니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;004010B0 | 80 7C 24 05 61           | CMP BYTE PTR SS:[ESP + 5], 61                    | 61:&lt;span class=&quot;s1&quot;&gt;'a'&lt;/span&gt;
004010B5 | 75 7E                    | JNE easy_crackme.401135                          |

BYTE &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;ESP+5]&lt;span class=&quot;o&quot;&gt;=[&lt;/span&gt;0019F6ED]&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;33 &lt;span class=&quot;s1&quot;&gt;'3'&lt;/span&gt;
61 &lt;span class=&quot;s1&quot;&gt;'a'&lt;/span&gt;
.text:004010B0 easy_crackme.exe:&lt;span class=&quot;nv&quot;&gt;$10B0&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;#10B0&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;먼저 &lt;code class=&quot;highlighter-rouge&quot;&gt;4010B0&lt;/code&gt; 위치에서 문자 &lt;code class=&quot;highlighter-rouge&quot;&gt;a&lt;/code&gt;와 &lt;code class=&quot;highlighter-rouge&quot;&gt;3&lt;/code&gt;을 비교하고 있습니다. &lt;code class=&quot;highlighter-rouge&quot;&gt;k3y6reak&lt;/code&gt;를 입력했을 때 두 번째 값과 a를 비교하고 있다는 것을 알 수 있고 해당 값은 틀렸기 때문에 &lt;code class=&quot;highlighter-rouge&quot;&gt;Incorrect Password&lt;/code&gt;로 넘어갈 것입니다. 따라서 다시 실행하여 &lt;code class=&quot;highlighter-rouge&quot;&gt;kay6reak&lt;/code&gt;를 입력해 보겠습니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;004010B0 | 80 7C 24 05 61           | CMP BYTE PTR SS:[ESP + 5], 61                    | 61:&lt;span class=&quot;s1&quot;&gt;'a'&lt;/span&gt;
004010B5 | 75 7E                    | JNE easy_crackme.401135                          |
004010B7 | 6A 02                    | PUSH 2                                           |
004010B9 | 8D 4C 24 0A              | LEA ECX, DWORD PTR SS:[ESP + A]                  |
004010BD | 68 78 60 40 00           | PUSH easy_crackme.406078                         | 406078:&lt;span class=&quot;s2&quot;&gt;&quot;5y&quot;&lt;/span&gt;
004010C2 | 51                       | PUSH ECX                                         |
004010C3 | E8 88 00 00 00           | CALL easy_crackme.401150                         |
004010C8 | 83 C4 0C                 | ADD ESP, C                                       |
004010CB | 85 C0                    | TEST EAX, EAX                                    |
004010CD | 75 66                    | JNE easy_crackme.401135                          |

EAX : 00000001
ECX : 00000001
EDX : 00000000
EBX : 00000001
EDI : 0039053C
EBP : 0019FA18
ESI : 0039053C
ESP : 0019F980
EIP : 004010CD     easy_crackme.004010CD&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;4010B0&lt;/code&gt;위치는 원하는 방향대로 넘어갔지만 &lt;code class=&quot;highlighter-rouge&quot;&gt;4010CD&lt;/code&gt; 부분은 통과하지 못했습니다. &lt;code class=&quot;highlighter-rouge&quot;&gt;EAX&lt;/code&gt;의 값은 &lt;code class=&quot;highlighter-rouge&quot;&gt;1&lt;/code&gt;인데 &lt;code class=&quot;highlighter-rouge&quot;&gt;JNE&lt;/code&gt;에서 &lt;code class=&quot;highlighter-rouge&quot;&gt;Incorrect Password&lt;/code&gt;로 넘어가기 때문에 단순히 생각하면 &lt;code class=&quot;highlighter-rouge&quot;&gt;EAX&lt;/code&gt;의 값이 &lt;code class=&quot;highlighter-rouge&quot;&gt;0&lt;/code&gt;이 되면 넘어갈 것으로 추측할 수 있습니다.&lt;/p&gt;

&lt;p&gt;하지만 &lt;code class=&quot;highlighter-rouge&quot;&gt;4010B0&lt;/code&gt;부터 &lt;code class=&quot;highlighter-rouge&quot;&gt;4010CD&lt;/code&gt;의 어셈블리어를 살펴보면 어떤 부분도 &lt;code class=&quot;highlighter-rouge&quot;&gt;EAX&lt;/code&gt;를 이용한 연산은 눈에 보이지 않습니다. 여기서 한 가지 중요한 것은 &lt;code class=&quot;highlighter-rouge&quot;&gt;함수의 리턴 값은 EAX에 저장된다.&lt;/code&gt;라는 것을 알아야 합니다.&lt;/p&gt;

&lt;p&gt;어셈블리어에서 함수의 호출은 &lt;code class=&quot;highlighter-rouge&quot;&gt;CALL&lt;/code&gt; 명령을 통해서 해당 함수의 주소로 이동하게 됩니다. &lt;code class=&quot;highlighter-rouge&quot;&gt;4010B0&lt;/code&gt;부터 &lt;code class=&quot;highlighter-rouge&quot;&gt;4010CD&lt;/code&gt; 중에서 함수를 호출하는 부분은 &lt;code class=&quot;highlighter-rouge&quot;&gt;4010C3&lt;/code&gt;이 있는데 해당 부분에 BreakPoint를 걸고 들어가 보도록 하겠습니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;00401150 | 55                       | PUSH EBP                                         |
00401151 | 8B EC                    | MOV EBP, ESP                                     |
00401153 | 57                       | PUSH EDI                                         |
00401154 | 56                       | PUSH ESI                                         |
00401155 | 53                       | PUSH EBX                                         |
00401156 | 8B 4D 10                 | MOV ECX, DWORD PTR SS:[EBP + 10]                 |
00401159 | E3 26                    | JECXZ easy_crackme.401181                        |
0040115B | 8B D9                    | MOV EBX, ECX                                     | ecx:&lt;span class=&quot;s2&quot;&gt;&quot;y6reak&quot;&lt;/span&gt;
0040115D | 8B 7D 08                 | MOV EDI, DWORD PTR SS:[EBP + 8]                  |
00401160 | 8B F7                    | MOV ESI, EDI                                     |
00401162 | 33 C0                    | XOR EAX, EAX                                     |
00401164 | F2 AE                    | REPNE SCASB AL, BYTE PTR ES:[EDI]                |
00401166 | F7 D9                    | NEG ECX                                          | ecx:&lt;span class=&quot;s2&quot;&gt;&quot;y6reak&quot;&lt;/span&gt;
00401168 | 03 CB                    | ADD ECX, EBX                                     | ecx:&lt;span class=&quot;s2&quot;&gt;&quot;y6reak&quot;&lt;/span&gt;
0040116A | 8B FE                    | MOV EDI, ESI                                     |
0040116C | 8B 75 0C                 | MOV ESI, DWORD PTR SS:[EBP + C]                  |
0040116F | F3 A6                    | REPE CMPSB BYTE PTR DS:[ESI], BYTE PTR ES:[EDI]  |
00401171 | 8A 46 FF                 | MOV AL, BYTE PTR DS:[ESI - 1]                    |
00401174 | 33 C9                    | XOR ECX, ECX                                     | ecx:&lt;span class=&quot;s2&quot;&gt;&quot;y6reak&quot;&lt;/span&gt;
00401176 | 3A 47 FF                 | CMP AL, BYTE PTR DS:[EDI - 1]                    |
00401179 | 77 04                    | JA easy_crackme.40117F                           |
0040117B | 74 04                    | JE easy_crackme.401181                           |
0040117D | 49                       | DEC ECX                                          | ecx:&lt;span class=&quot;s2&quot;&gt;&quot;y6reak&quot;&lt;/span&gt;
0040117E | 49                       | DEC ECX                                          | ecx:&lt;span class=&quot;s2&quot;&gt;&quot;y6reak&quot;&lt;/span&gt;
0040117F | F7 D1                    | NOT ECX                                          | ecx:&lt;span class=&quot;s2&quot;&gt;&quot;y6reak&quot;&lt;/span&gt;
00401181 | 8B C1                    | MOV EAX, ECX                                     | ecx:&lt;span class=&quot;s2&quot;&gt;&quot;y6reak&quot;&lt;/span&gt;
00401183 | 5B                       | POP EBX                                          |
00401184 | 5E                       | POP ESI                                          |
00401185 | 5F                       | POP EDI                                          |
00401186 | C9                       | LEAVE                                            |
00401187 | C3                       | RET                                              |&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;401150&lt;/code&gt;의 함수 부분인데 이 부분에서 어떤 값을 검사하는지 알아야 합니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;00401176 | 3A 47 FF                 | CMP AL, BYTE PTR DS:[EDI - 1]                    | edi-1:&lt;span class=&quot;s2&quot;&gt;&quot;y6reak&quot;&lt;/span&gt;
00401179 | 77 04                    | JA easy_crackme.40117F                           |
0040117B | 74 04                    | JE easy_crackme.401181                           |

&lt;span class=&quot;nv&quot;&gt;al&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;35 &lt;span class=&quot;s1&quot;&gt;'5'&lt;/span&gt;
BYTE &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;EDI-1]&lt;span class=&quot;o&quot;&gt;=[&lt;/span&gt;0019F986]&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;79 &lt;span class=&quot;s1&quot;&gt;'y'&lt;/span&gt;
.text:00401176 easy_crackme.exe:&lt;span class=&quot;nv&quot;&gt;$1176&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;#1176&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;401176&lt;/code&gt; 에서 &lt;code class=&quot;highlighter-rouge&quot;&gt;5&lt;/code&gt;와 &lt;code class=&quot;highlighter-rouge&quot;&gt;y&lt;/code&gt;를 비교하고 있습니다. 입력했던 &lt;code class=&quot;highlighter-rouge&quot;&gt;kay6reak&lt;/code&gt;의 &lt;code class=&quot;highlighter-rouge&quot;&gt;y&lt;/code&gt;와 비교를 한다는 것이므로 &lt;code class=&quot;highlighter-rouge&quot;&gt;ka56reak&lt;/code&gt;가 돼야 한다는 것을 알 수 있습니다. 다시 실행하여 &lt;code class=&quot;highlighter-rouge&quot;&gt;ka56reak&lt;/code&gt;를 입력한 후 &lt;code class=&quot;highlighter-rouge&quot;&gt;EAX&lt;/code&gt;의 값을 살펴보도록 하겠습니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;004010B0 | 80 7C 24 05 61           | CMP BYTE PTR SS:[ESP + 5], 61                    | 61:&lt;span class=&quot;s1&quot;&gt;'a'&lt;/span&gt;
004010B5 | 75 7E                    | JNE easy_crackme.401135                          |
004010B7 | 6A 02                    | PUSH 2                                           |
004010B9 | 8D 4C 24 0A              | LEA ECX, DWORD PTR SS:[ESP + A]                  |
004010BD | 68 78 60 40 00           | PUSH easy_crackme.406078                         | 406078:&lt;span class=&quot;s2&quot;&gt;&quot;5y&quot;&lt;/span&gt;
004010C2 | 51                       | PUSH ECX                                         |
004010C3 | E8 88 00 00 00           | CALL easy_crackme.401150                         |
004010C8 | 83 C4 0C                 | ADD ESP, C                                       |
004010CB | 85 C0                    | TEST EAX, EAX                                    |
004010CD | 75 66                    | JNE easy_crackme.401135                          |

EAX : FFFFFFFF
ECX : FFFFFFFF
EDX : 00000000
EBX : 00000001
EDI : 002B05AC
EBP : 0019FA18
ESI : 002B05AC
ESP : 0019F980
EIP : 004010CB     easy_crackme.004010CB&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;EAX&lt;/code&gt;의 값이 &lt;code class=&quot;highlighter-rouge&quot;&gt;FFFFFFFF&lt;/code&gt;이 됐지만 마찬가지로 &lt;code class=&quot;highlighter-rouge&quot;&gt;JNE&lt;/code&gt;에서 &lt;code class=&quot;highlighter-rouge&quot;&gt;Incorrect Password&lt;/code&gt;로 넘어갑니다. 다시 실행하여 &lt;code class=&quot;highlighter-rouge&quot;&gt;ka56reak&lt;/code&gt;를 입력해서 함수로 들어가 다시 확인해 보겠습니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;al&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;79 &lt;span class=&quot;s1&quot;&gt;'y'&lt;/span&gt;
BYTE &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;EDI-1]&lt;span class=&quot;o&quot;&gt;=[&lt;/span&gt;0019F6EF]&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;36 &lt;span class=&quot;s1&quot;&gt;'6'&lt;/span&gt;
.text:00401176 easy_crackme.exe:&lt;span class=&quot;nv&quot;&gt;$1176&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;#1176&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;이번에는 &lt;code class=&quot;highlighter-rouge&quot;&gt;ka56reak&lt;/code&gt; 중 &lt;code class=&quot;highlighter-rouge&quot;&gt;6&lt;/code&gt;과 &lt;code class=&quot;highlighter-rouge&quot;&gt;y&lt;/code&gt;를 비교하고 있습니다. 그렇다면 &lt;code class=&quot;highlighter-rouge&quot;&gt;ka5yreak&lt;/code&gt;가 돼야 한다는 것을 알 수 있습니다.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ka5yreak&lt;/code&gt;를 입력한 후 실행하면 &lt;code class=&quot;highlighter-rouge&quot;&gt;004010CD&lt;/code&gt;의 &lt;code class=&quot;highlighter-rouge&quot;&gt;JNE&lt;/code&gt;가 실행이 안되는 것을 알 수 있습니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;004010CF | 53                       | PUSH EBX                                         |
004010D0 | 56                       | PUSH ESI                                         | esi:&lt;span class=&quot;s2&quot;&gt;&quot;R3versing&quot;&lt;/span&gt;
004010D1 | BE 6C 60 40 00           | MOV ESI, easy_crackme.40606C                     | esi:&lt;span class=&quot;s2&quot;&gt;&quot;R3versing&quot;&lt;/span&gt;, 40606C:&lt;span class=&quot;s2&quot;&gt;&quot;R3versing&quot;&lt;/span&gt;
004010D6 | 8D 44 24 10              | LEA EAX, DWORD PTR SS:[ESP + 10]                 |
004010DA | 8A 10                    | MOV DL, BYTE PTR DS:[EAX]                        | eax:&lt;span class=&quot;s2&quot;&gt;&quot;reak&quot;&lt;/span&gt;
004010DC | 8A 1E                    | MOV BL, BYTE PTR DS:[ESI]                        | esi:&lt;span class=&quot;s2&quot;&gt;&quot;R3versing&quot;&lt;/span&gt;
004010DE | 8A CA                    | MOV CL, DL                                       |
004010E0 | 3A D3                    | CMP DL, BL                                       |
004010E2 | 75 1E                    | JNE easy_crackme.401102                          |

&lt;span class=&quot;nv&quot;&gt;dl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;72 &lt;span class=&quot;s1&quot;&gt;'r'&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;bl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;52 &lt;span class=&quot;s1&quot;&gt;'R'&lt;/span&gt;
.text:004010E0 easy_crackme.exe:&lt;span class=&quot;nv&quot;&gt;$10E0&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;#10E0&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;4010E0&lt;/code&gt; 부분에서 &lt;code class=&quot;highlighter-rouge&quot;&gt;r&lt;/code&gt;와 &lt;code class=&quot;highlighter-rouge&quot;&gt;R&lt;/code&gt;을 비교하고 있습니다. 입력했던 값 &lt;code class=&quot;highlighter-rouge&quot;&gt;ka5yreak&lt;/code&gt; 중 &lt;code class=&quot;highlighter-rouge&quot;&gt;r&lt;/code&gt;과 비교를 한다는 것인데, 위 어셈블리어 코드를 살펴보면 &lt;code class=&quot;highlighter-rouge&quot;&gt;R3versing&lt;/code&gt;이라는 문자열이 존재하는 것을 알 수 있습니다.&lt;/p&gt;

&lt;p&gt;그렇다면 &lt;code class=&quot;highlighter-rouge&quot;&gt;reak&lt;/code&gt; 부분과 &lt;code class=&quot;highlighter-rouge&quot;&gt;R3versing&lt;/code&gt;을 비교한다고 추측할 수 있습니다. 재실행하여 &lt;code class=&quot;highlighter-rouge&quot;&gt;ka5yR3versing&lt;/code&gt;을 입력하고 진행해 보겠습니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;0040110D | 80 7C 24 04 45           | CMP BYTE PTR SS:[ESP + 4], 45                    | 45:&lt;span class=&quot;s1&quot;&gt;'E'&lt;/span&gt;
00401112 | 75 21                    | JNE easy_crackme.401135                          |

BYTE &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;ESP+4]&lt;span class=&quot;o&quot;&gt;=[&lt;/span&gt;0019F984]&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;6B &lt;span class=&quot;s1&quot;&gt;'k'&lt;/span&gt;
45 &lt;span class=&quot;s1&quot;&gt;'E'&lt;/span&gt;
.text:0040110D easy_crackme.exe:&lt;span class=&quot;nv&quot;&gt;$110D&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;#110D&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ka5yR3versing&lt;/code&gt;을 입력하고 진행했더니 &lt;code class=&quot;highlighter-rouge&quot;&gt;40110D&lt;/code&gt;까지 진행된 것을 알 수 있습니다. 이 부분에서는 &lt;code class=&quot;highlighter-rouge&quot;&gt;k&lt;/code&gt;와 &lt;code class=&quot;highlighter-rouge&quot;&gt;E&lt;/code&gt;를 비교하고 있기 때문에 &lt;code class=&quot;highlighter-rouge&quot;&gt;Ea5yR3versing&lt;/code&gt;을 입력해 보겠습니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/wargame/reversing_kr/congratz.png&quot; alt=&quot;Congratulation&quot; /&gt;&lt;/p&gt;

&lt;p&gt;입력한 결과가 모두 일치한 것을 알 수 있습니다.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Flag: Ea5yR3versing&lt;/code&gt;&lt;/p&gt;

</description>
        <pubDate>Mon, 22 Jan 2018 14:43:00 +0900</pubDate>
        <link>http://localhost:4000/wargame/2018/01/22/easy_crack/</link>
        <guid isPermaLink="true">http://localhost:4000/wargame/2018/01/22/easy_crack/</guid>
        
        <category>reversing-kr</category>
        
        
        <category>wargame</category>
        
      </item>
    
      <item>
        <title>WITHCON2017 crackme</title>
        <description>&lt;h3 id=&quot;문제&quot;&gt;문제&lt;/h3&gt;
&lt;p&gt;&lt;img src=&quot;/img/ctfs/withcon2017/crackme.png&quot; alt=&quot;crackme&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;풀이&quot;&gt;풀이&lt;/h3&gt;

&lt;p&gt;crackme 파일은 ELF 64bit 입니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;&lt;span class=&quot;gp&quot;&gt;root@ubuntu:/home/k3y6reak/Desktop# &lt;/span&gt;file crackme
crackme: ELF 64-bit LSB executable, x86-64, version 1 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;SYSV&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;, dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;GNU/Linux 2.6.32, BuildID[sha1]&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;d4153567d0a264a1fa799425563693cc1ad86149, stripped&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;crackme 파일을 실행하면 &lt;code class=&quot;highlighter-rouge&quot;&gt;PASSCODE&lt;/code&gt; 입력을 요구하고 이에 따라 &lt;code class=&quot;highlighter-rouge&quot;&gt;CONGRATZ&lt;/code&gt;와 &lt;code class=&quot;highlighter-rouge&quot;&gt;FAILED&lt;/code&gt;가 출력됩니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;&lt;span class=&quot;gp&quot;&gt;root@ubuntu:/home/k3y6reak/Desktop# &lt;/span&gt;chmod +x crackme
&lt;span class=&quot;gp&quot;&gt;root@ubuntu:/home/k3y6reak/Desktop# &lt;/span&gt;./crackme
PASSCODE : k3y6reak
FAILED&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;IDA Pro를 이용해 Decompile을 하면 main 함수에서 많은 연산을 하고 있다는 것을 알 수 있습니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/ctfs/withcon2017/pseudocode.png&quot; alt=&quot;crackme_pseudocode&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Main 함수를 분석하는 것은 많은 시간이 필요할 것 같아 Intel PIN의 &lt;code class=&quot;highlighter-rouge&quot;&gt;icount.so&lt;/code&gt;를 이용해 count을 확인했습니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;popen2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;string&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;strings&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789~!@#$&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;^&amp;amp;*()_+-=,./:;&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Input&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;input&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sh&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;./pin -t source/tools/SimpleExamples/obj-intel64/icount.so -- ./crackme &amp;lt; &quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Input&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;Execute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;command&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;fin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fout&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;popen2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;popen2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;command&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;result1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fin&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;readline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;result2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fin&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;readline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result2&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;WriteFile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;w&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;strings&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;key&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;''&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;strings&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&amp;gt; &quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;WriteFile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;Execute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;위에서 작성한 python 코드를 count.py로 저장 후 실행하면 입력 값에 따른 count 값이 출력된다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;k3y6reak@ubuntu: ~/pintools# python count.py
&lt;span class=&quot;gp&quot;&gt;&amp;gt; &lt;/span&gt;D
Count 152301

&lt;span class=&quot;gp&quot;&gt;&amp;gt; &lt;/span&gt;E
Count 152301

&lt;span class=&quot;gp&quot;&gt;&amp;gt; &lt;/span&gt;F
Count 152301

&lt;span class=&quot;gp&quot;&gt;&amp;gt; &lt;/span&gt;G
Count 152301

&lt;span class=&quot;gp&quot;&gt;&amp;gt; &lt;/span&gt;H
Count 152359

&lt;span class=&quot;gp&quot;&gt;&amp;gt; &lt;/span&gt;I
Count 152301

&lt;span class=&quot;gp&quot;&gt;&amp;gt; &lt;/span&gt;J
Count 152302

&lt;span class=&quot;gp&quot;&gt;&amp;gt; &lt;/span&gt;K
Count 152302

&lt;span class=&quot;gp&quot;&gt;&amp;gt; &lt;/span&gt;L
Count 152302&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;위의 실행 결과를 살펴보면 다른 문자들은 152301과 비슷한 값이 출력되는 반면 &lt;code class=&quot;highlighter-rouge&quot;&gt;'H'&lt;/code&gt;는 &lt;code class=&quot;highlighter-rouge&quot;&gt;152359&lt;/code&gt;로 큰 차이로 출력됐다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;strings&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;key&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;''&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;strings&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&amp;gt; &quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;WriteFile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;Execute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;key = ''&lt;/code&gt; 부분에 H를 추가하여 다음 값을 찾는다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;k3y6reak@ubuntu: ~/pintools# python count.py
&lt;span class=&quot;gp&quot;&gt;&amp;gt; &lt;/span&gt;H3
Count 152360

&lt;span class=&quot;gp&quot;&gt;&amp;gt; &lt;/span&gt;H4
Count 152636

&lt;span class=&quot;gp&quot;&gt;&amp;gt; &lt;/span&gt;H5
Count 152359&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;k3y6reak@ubuntu: ~/pintools# python count.py
&lt;span class=&quot;gp&quot;&gt;&amp;gt; &lt;/span&gt;H4O
Count 152636

&lt;span class=&quot;gp&quot;&gt;&amp;gt; &lt;/span&gt;H4P
Count 152694

&lt;span class=&quot;gp&quot;&gt;&amp;gt; &lt;/span&gt;H4Q
Count 152635&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;k3y6reak@ubuntu: ~/pintools# python count.py
&lt;span class=&quot;gp&quot;&gt;&amp;gt; &lt;/span&gt;H4PO
Count 152693

&lt;span class=&quot;gp&quot;&gt;&amp;gt; &lt;/span&gt;H4PP
Count 153022

&lt;span class=&quot;gp&quot;&gt;&amp;gt; &lt;/span&gt;H4PPQ
Count 152693&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;k3y6reak@ubuntu: ~/pintools# python count.py
&lt;span class=&quot;gp&quot;&gt;&amp;gt; &lt;/span&gt;H4PPx
Count 153023

&lt;span class=&quot;gp&quot;&gt;&amp;gt; &lt;/span&gt;H4PPy
Count 153081

&lt;span class=&quot;gp&quot;&gt;&amp;gt; &lt;/span&gt;H4PPz
Count 153022&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;위 실행 결과를 살펴보면 &lt;code class=&quot;highlighter-rouge&quot;&gt;'H4'&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;'H4P'&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;'H4PP'&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;'H4PPy'&lt;/code&gt;가 큰 편차로 출력되는 것을 볼 수 있다.&lt;/p&gt;

&lt;p&gt;이렇게 편차가 큰 문자를 찾아 key에 추가하여 실행하면 &lt;code class=&quot;highlighter-rouge&quot;&gt;H4PPyW1THC0nCTF!&lt;/code&gt; 일 때 &lt;code class=&quot;highlighter-rouge&quot;&gt;CONGRATZ&lt;/code&gt;가 출력되는 것을 볼 수 있다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;k3y6reak@ubuntu: ~/pintools# python count.py
&lt;span class=&quot;gp&quot;&gt;&amp;gt; &lt;/span&gt;H4PPyW1THC0nCTF~
PASSCODE : FAILED

Count 154799
&lt;span class=&quot;gp&quot;&gt;&amp;gt; &lt;/span&gt;H4PPyW1THC0nCTF!
PASSCODE : CONGRATZ

Count 154018
&lt;span class=&quot;gp&quot;&gt;&amp;gt; &lt;/span&gt;H4PPyW1THC0nCTF@
PASSCODE : FAILED&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;&lt;span class=&quot;gp&quot;&gt;root@ubuntu:/home/k3y6reak/Desktop# &lt;/span&gt;./crackme
PASSCODE : H4PPyW1THC0nCTF!
CONGRATZ&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;flag: H4PPyW1THC0nCTF!&lt;/code&gt;&lt;/p&gt;
</description>
        <pubDate>Wed, 08 Nov 2017 13:15:00 +0900</pubDate>
        <link>http://localhost:4000/ctfs/2017/11/08/withcon2017_crackme/</link>
        <guid isPermaLink="true">http://localhost:4000/ctfs/2017/11/08/withcon2017_crackme/</guid>
        
        
        <category>ctfs</category>
        
      </item>
    
      <item>
        <title>Proxy</title>
        <description>&lt;h3 id=&quot;proxy&quot;&gt;Proxy&lt;/h3&gt;

&lt;p&gt;안드로이드OS 는 네트워크를 주로 사용하는 장비에 사용되므로 분석을 할 필요가 있습니다. 웹 또한 분석할 때 Proxy를 이용해 파라미터 값을 변조하여 점검을 합니다. 마찬가지로 안드로이드에서도 Proxy 설정을 통해 점검할 수 있습니다.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Settings - Wi-Fi - WiredSSID(Long Click) - Modify network - Show advanced options(check) - Proxy settings(Manual)&lt;/code&gt; 로 이동합니다.&lt;/p&gt;

&lt;p&gt;하단에 &lt;code class=&quot;highlighter-rouge&quot;&gt;Proxy hostname&lt;/code&gt;과 &lt;code class=&quot;highlighter-rouge&quot;&gt;Proxy port&lt;/code&gt;가 나타나는데 각각 Burp Suite를 사용하는 OS의 IP와 Port를 작성해 줍니다.&lt;/p&gt;

&lt;p&gt;기본적으로 Burp Suite를 사용하시는 분이라면 &lt;code class=&quot;highlighter-rouge&quot;&gt;Proxy - Options - Proxy Listeners - Edit(All interfaces)&lt;/code&gt;로 되어있는지 확인해야 합니다.&lt;/p&gt;

&lt;p&gt;여기서 중요한 것이 하나 더 있는데 &lt;code class=&quot;highlighter-rouge&quot;&gt;Security warning&lt;/code&gt;이 계속해서 나타나면 아래와 같이 설정을 해야 합니다.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Browser - http://burp 접속 - CA Certificate - cacert.der 다운로드&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/android/proxy/CA_Certificate.png&quot; alt=&quot;ca_certificate&quot; /&gt;
&lt;img src=&quot;/img/android/proxy/cacert.png&quot; alt=&quot;cacert&quot; /&gt;&lt;/p&gt;

&lt;p&gt;이제 &lt;code class=&quot;highlighter-rouge&quot;&gt;adb shell&lt;/code&gt;을 이용해 cacert.der 을 cacert.crt로 변경합니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;k3y6reak:Desktop k3y6reak&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;adb shell
root@android:/ &lt;span class=&quot;c&quot;&gt;# cd /mnt/sdcard/Download/&lt;/span&gt;
root@android:/mnt/sdcard/Download &lt;span class=&quot;c&quot;&gt;# ls&lt;/span&gt;
cacert.der
root@android:/mnt/sdcard/Download &lt;span class=&quot;c&quot;&gt;# mv cacert.der cacert.crt&lt;/span&gt;
root@android:/mnt/sdcard/Download &lt;span class=&quot;c&quot;&gt;# ls&lt;/span&gt;
cacert.crt&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Settings - Security - Install from SD card - OK&lt;/code&gt;를 선택해 설치를 완료합니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/android/proxy/burpsuite.png&quot; alt=&quot;burpsuite&quot; /&gt;&lt;/p&gt;

&lt;p&gt;정상적으로 burpsuite가 실행되는 것을 알 수 있습니다.&lt;/p&gt;
</description>
        <pubDate>Mon, 06 Nov 2017 18:44:00 +0900</pubDate>
        <link>http://localhost:4000/technique/2017/11/06/Proxy/</link>
        <guid isPermaLink="true">http://localhost:4000/technique/2017/11/06/Proxy/</guid>
        
        <category>android</category>
        
        
        <category>technique</category>
        
      </item>
    
      <item>
        <title>ADB</title>
        <description>&lt;h3 id=&quot;adb&quot;&gt;ADB&lt;/h3&gt;

&lt;p&gt;ADB는 Android Debug Bridge의 약자로 안드로이드 OS에 Shell로 붙어 작업할 수 있도록 도와줍니다.&lt;/p&gt;

&lt;p&gt;앞서 설치했던 Genymotion에서 &lt;code class=&quot;highlighter-rouge&quot;&gt;Android 4.1.1&lt;/code&gt;을 실행합니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/android/adb/android_ip.png&quot; alt=&quot;Android_ip&quot; /&gt;&lt;/p&gt;

&lt;p&gt;실행하면 상단의 오른쪽에 해당 안드로이드의 IP 주소가 나타나게 됩니다.&lt;/p&gt;

&lt;h4 id=&quot;adb-devices&quot;&gt;adb devices&lt;/h4&gt;

&lt;p&gt;터미널에서 &lt;code class=&quot;highlighter-rouge&quot;&gt;adb devices&lt;/code&gt;를 입력합니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;k3y6reak:~ k3y6reak&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;adb devices
List of devices attached
192.168.56.101:5555	device&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;adb devices는 현재 실행되고 있는 안드로이드 기기의 목록을 출력해 줍니다. 여러개가 실행되고 있는 경우 IP가 여러개 출력됩니다.&lt;/p&gt;

&lt;h4 id=&quot;adb-shell&quot;&gt;adb shell&lt;/h4&gt;
&lt;p&gt;여기서 &lt;code class=&quot;highlighter-rouge&quot;&gt;adb shell&lt;/code&gt;을 입력하면 해당 기기의 shell이 실행됩니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;k3y6reak:~ k3y6reak&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;adb shell
root@android:/ &lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;k3y6reak에서 root로 변한 것을 볼 수 있습니다. &lt;code class=&quot;highlighter-rouge&quot;&gt;shell이 실행되면 root로 실행됩니다.&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;여러개의 안드로이드가 실행이 되고 있는 경우라면 &lt;code class=&quot;highlighter-rouge&quot;&gt;adb -s [IP] shell&lt;/code&gt;을 입력하면 됩니다.&lt;/p&gt;

&lt;h4 id=&quot;adb-push&quot;&gt;adb push&lt;/h4&gt;

&lt;p&gt;로컬에서 안드로이드 기기로 파일을 전송하고자 하는 경우 &lt;code class=&quot;highlighter-rouge&quot;&gt;adb push&lt;/code&gt;를 사용합니다&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;k3y6reak:~ k3y6reak&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vim test.txt
k3y6reak:~ k3y6reak&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;cat test.txt
k3y6reak &lt;span class=&quot;nb&quot;&gt;test
&lt;/span&gt;k3y6reak:~ k3y6reak&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;adb push test.txt /mnt/sdcard
test.txt: 1 file pushed. 0.0 MB/s &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;14 bytes &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;0.002s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
k3y6reak:~ k3y6reak&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;adb shell ls /mnt/sdcard
Alarms
Android
DCIM
Download
KakaoTalk
Movies
Music
Notifications
Pictures
Podcasts
Ringtones
test.txt
k3y6reak:~ k3y6reak&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h4 id=&quot;adb-pull&quot;&gt;adb pull&lt;/h4&gt;

&lt;p&gt;반대로 안드로이드 기기에서 로컬로 가져오고 싶은 경우 &lt;code class=&quot;highlighter-rouge&quot;&gt;adb pull&lt;/code&gt;을 사용합니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;k3y6reak:~ k3y6reak&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;adb shell
root@android:/ &lt;span class=&quot;c&quot;&gt;# cd /mnt/sdcard&lt;/span&gt;
root@android:/mnt/sdcard &lt;span class=&quot;c&quot;&gt;# ls&lt;/span&gt;
Alarms
Android
DCIM
Download
KakaoTalk
Movies
Music
Notifications
Pictures
Podcasts
Ringtones
test.txt
root@android:/mnt/sdcard &lt;span class=&quot;c&quot;&gt;# mv test.txt test2.txt&lt;/span&gt;
root@android:/mnt/sdcard &lt;span class=&quot;c&quot;&gt;# exit&lt;/span&gt;
k3y6reak:~ k3y6reak&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;adb pull /mnt/sdcard/test2.txt test2.txt
/mnt/sdcard/test2.txt: 1 file pulled. 0.0 MB/s &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;14 bytes &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;0.001s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
k3y6reak:~ k3y6reak&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;cat test2.txt
k3y6reak &lt;span class=&quot;nb&quot;&gt;test&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h4 id=&quot;adb-install&quot;&gt;adb install&lt;/h4&gt;

&lt;p&gt;apk 파일을 설치하고 하는 경우 &lt;code class=&quot;highlighter-rouge&quot;&gt;adb install&lt;/code&gt;을 사용합니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;k3y6reak:Desktop k3y6reak&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;adb install SoundMeter.apk
SoundMeter.apk: 1 file pushed. 17.5 MB/s &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;845724 bytes &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;0.046s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
	pkg: /data/local/tmp/SoundMeter.apk
Success
rm failed &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; -f, No such file or directory&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;해당 안드로이드 기기에서 확인하면 설치가 완료된 것을 볼 수 있습니다.&lt;/p&gt;

&lt;h4 id=&quot;adb-uninstall&quot;&gt;adb uninstall&lt;/h4&gt;

&lt;p&gt;설치 된 apk 파일을 삭제하고자 하는 경우 &lt;code class=&quot;highlighter-rouge&quot;&gt;adb uninstall&lt;/code&gt;을 사용합니다.
이때 삭제하고자 하는 패키지 이름을 넣어주어야 합니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;root@android:/data/data &lt;span class=&quot;c&quot;&gt;# ls -al | grep &quot;sound&quot;&lt;/span&gt;
drwxr-x--x u0_a38   u0_a38            2017-10-30 11:18 com.android.soundrecorder
drwxr-x--x u0_a49   u0_a49            2017-11-06 07:51 me.daei.soundmeter
k3y6reak:Desktop k3y6reak&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;adb uninstall me.daei.soundmeter
Success&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;마찬가지로 안드로이드 기기에서 확인하면 해당 apk가 삭제된 것을 볼 수 있습니다.&lt;/p&gt;

&lt;h4 id=&quot;adb-logcat&quot;&gt;adb logcat&lt;/h4&gt;

&lt;p&gt;logcat은 안드로이드가 어떤 작업을 하는지 log을 출력해 줍니다.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;adb logcat&lt;/code&gt;을 하면 모든 행위에 대해 log를 출력해주며 pid로 필터링하면 해당 pid에 대해서만 출력합니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;root@android:/ &lt;span class=&quot;c&quot;&gt;# ps&lt;/span&gt;
USER     PID   PPID  VSIZE  RSS     WCHAN    PC         NAME
u0_a49    1348  165   509072 29960 ffffffff b75eb507 S me.daei.soundmeter&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;k3y6reak:Desktop k3y6reak&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;adb logcat | grep -i 1348
I/ActivityManager&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;  326&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: Start proc me.daei.soundmeter &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;activity me.daei.soundmeter/.MainActivity: &lt;span class=&quot;nv&quot;&gt;pid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1348 &lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;10049 &lt;span class=&quot;nv&quot;&gt;gids&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;={&lt;/span&gt;1015, 3003, 1028&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
W/dalvikvm&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; 1348&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: VFY: unable to find class referenced &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;signature &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Landroid/view/SearchEvent;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
I/dalvikvm&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; 1348&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: Could not find method android.view.Window&lt;span class=&quot;nv&quot;&gt;$Callback&lt;/span&gt;.onSearchRequested, referenced from method android.support.v7.view.n.onSearchRequested
W/dalvikvm&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; 1348&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: VFY: unable to resolve interface method 6404: Landroid/view/Window&lt;span class=&quot;nv&quot;&gt;$Callback&lt;/span&gt;;.onSearchRequested &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Landroid/view/SearchEvent;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;Z
D/dalvikvm&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; 1348&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: VFY: replacing opcode 0x72 at 0x0002
I/dalvikvm&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; 1348&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: Could not find method android.view.Window&lt;span class=&quot;nv&quot;&gt;$Callback&lt;/span&gt;.onWindowStartingActionMode, referenced from method android.support.v7.view.n.onWindowStartingActionMode
W/dalvikvm&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; 1348&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: VFY: unable to resolve interface method 6408: Landroid/view/Window&lt;span class=&quot;nv&quot;&gt;$Callback&lt;/span&gt;;.onWindowStartingActionMode &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Landroid/view/ActionMode&lt;span class=&quot;nv&quot;&gt;$Callback&lt;/span&gt;;I&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;Landroid/view/ActionMode;
D/dalvikvm&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; 1348&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: VFY: replacing opcode 0x72 at 0x0002
I/dalvikvm&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; 1348&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: Could not find method android.view.ViewGroup.onRtlPropertiesChanged, referenced from method android.support.v7.widget.Toolbar.onRtlPropertiesChanged
W/dalvikvm&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; 1348&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: VFY: unable to resolve virtual method 6345: Landroid/view/ViewGroup;.onRtlPropertiesChanged &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;I&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;V
D/dalvikvm&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; 1348&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: VFY: replacing opcode 0x6f at 0x0007
I/dalvikvm&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; 1348&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: Could not find method android.content.res.Resources.getDrawable, referenced from method android.support.v7.widget.cn.getDrawable

&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;생략...&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

</description>
        <pubDate>Mon, 06 Nov 2017 16:38:00 +0900</pubDate>
        <link>http://localhost:4000/technique/2017/11/06/ADB/</link>
        <guid isPermaLink="true">http://localhost:4000/technique/2017/11/06/ADB/</guid>
        
        <category>android</category>
        
        
        <category>technique</category>
        
      </item>
    
      <item>
        <title>Dex</title>
        <description>&lt;h3 id=&quot;dex&quot;&gt;Dex&lt;/h3&gt;

&lt;p&gt;Dex는 Android에서 사용되는 파일로 Windows의 PE 파일과 같은 존재입니다. Dex는 Dalvik Executable을 줄여놓은 것으로 Dalvik Virtual Machine에서 동작합니다.&lt;/p&gt;

&lt;p&gt;Dex의 Signature는 &lt;code class=&quot;highlighter-rouge&quot;&gt;64 65 78 0a 30 33 35 00(dex\n035)&lt;/code&gt; 로 시작합니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;k3y6reak:SoundMeter k3y6reak&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ls
AndroidManifest.xml	classes.dex		resources.arsc
META-INF		res
k3y6reak:SoundMeter k3y6reak&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;hexdump -C classes.dex | more
00000000  64 65 78 0a 30 33 35 00  e2 50 cf a8 1b 24 b9 ce  |dex.035..P...&lt;span class=&quot;nv&quot;&gt;$.&lt;/span&gt;.|&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;unzip&lt;/code&gt;으로 추출한 classes.dex 파일을 분석해야 하는데 이때 사용하는 툴이 dex2jar가 있습니다.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://sourceforge.net/projects/dex2jar/&quot;&gt;dex2jar&lt;/a&gt;에서 해당 파일을 다운로드 받습니다.&lt;/p&gt;

&lt;p&gt;압축을 해제한 후 Ubuntu에서 사용하기 때문에 &lt;code class=&quot;highlighter-rouge&quot;&gt;d2j-dex2jar.sh&lt;/code&gt;를 이용해 &lt;code class=&quot;highlighter-rouge&quot;&gt;jar&lt;/code&gt; 파일을 추출합니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;&lt;span class=&quot;gp&quot;&gt;root@ubuntu:~/dex2jar# &lt;/span&gt;ls
d2j-baksmali.bat   d2j-dex-recompute-checksum.bat  d2j-jar2jasmin.bat  d2j-std-apk.bat
d2j-baksmali.sh    d2j-dex-recompute-checksum.sh   d2j-jar2jasmin.sh   d2j-std-apk.sh
d2j-dex2jar.bat    d2j_invoke.bat                  d2j-jasmin2jar.bat  lib
d2j-dex2jar.sh     d2j_invoke.sh                   d2j-jasmin2jar.sh   SoundMeter.apk
d2j-dex2smali.bat  d2j-jar2dex.bat                 d2j-smali.bat
d2j-dex2smali.sh   d2j-jar2dex.sh                  d2j-smali.sh
&lt;span class=&quot;gp&quot;&gt;root@ubuntu:~/dex2jar# &lt;/span&gt;./d2j-dex2jar.sh SoundMeter.apk
dex2jar SoundMeter.apk -&amp;gt; ./SoundMeter-dex2jar.jar
&lt;span class=&quot;gp&quot;&gt;root@ubuntu:~/dex2jar# &lt;/span&gt;ls
d2j-baksmali.bat   d2j-dex-recompute-checksum.bat  d2j-jar2jasmin.bat  d2j-std-apk.bat
d2j-baksmali.sh    d2j-dex-recompute-checksum.sh   d2j-jar2jasmin.sh   d2j-std-apk.sh
d2j-dex2jar.bat    d2j_invoke.bat                  d2j-jasmin2jar.bat  lib
d2j-dex2jar.sh     d2j_invoke.sh                   d2j-jasmin2jar.sh   SoundMeter.apk
d2j-dex2smali.bat  d2j-jar2dex.bat                 d2j-smali.bat       SoundMeter-dex2jar.jar
d2j-dex2smali.sh   d2j-jar2dex.sh                  d2j-smali.sh&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;SoundMeter-dex2jar.jar&lt;/code&gt;파일이 추출된 것을 볼 수 있습니다. 이제 jar 파일을 다시 &lt;code class=&quot;highlighter-rouge&quot;&gt;Java Decompiler&lt;/code&gt;를 이용해 자바코드로 변환합니다.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://jd.benow.ca/&quot;&gt;JD-GUI&lt;/a&gt;에서 운영체제에 맞는 파일을 받아 실행합니다.
jar 파일을 받은경우 &lt;code class=&quot;highlighter-rouge&quot;&gt;java -jar jd-gui-1.4.0.jar&lt;/code&gt; 로 실행하면 됩니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/android/dex/execute_jdgui.png&quot; alt=&quot;jd_gui&quot; /&gt;&lt;/p&gt;

&lt;p&gt;실행 후 해당 apk를 드래그 앤 드롭으로 넣어주면 자동으로 분석을 해줍니다.&lt;/p&gt;

&lt;p&gt;또 다른 방법으로는 &lt;code class=&quot;highlighter-rouge&quot;&gt;010 Editor&lt;/code&gt;를 사용하는 방법입니다. &lt;a href=&quot;http://www.sweetscape.com/010editor/&quot;&gt;010Editor&lt;/a&gt;에서 다운로드 받을 수 있습니다. 010 Editor는 &lt;code class=&quot;highlighter-rouge&quot;&gt;Template&lt;/code&gt;을 이용해 파일의 구조를 분석할 수 있습니다.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/strazzere/010Editor-stuff/tree/master/Templates&quot;&gt;Templates_Github&lt;/a&gt;에서 여러 종류의 템플릿을 받을 수 있으며 여기서 사용할 파일은 &lt;code class=&quot;highlighter-rouge&quot;&gt;DEXTemplate.bt&lt;/code&gt;이므로 이 파일을 받아주면 됩니다.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;classes.dex&lt;/code&gt;파일을 010 Editor에 올리고 다운로드 받은 Dex template을 실행하면 됩니다.
상단의 메뉴에서 Templates - Open Template - DexTemplate.bt - Run Template를 선택합니다.&lt;/p&gt;

&lt;p&gt;Github에서 받은 파일이 에러 간다면 &lt;a href=&quot;https://www.sweetscape.com/010editor/templates/&quot;&gt;Templates_sweetscape&lt;/a&gt;에서 받아서 실행해보세요.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/android/dex/editor.png&quot; alt=&quot;editor&quot; /&gt;&lt;/p&gt;

</description>
        <pubDate>Fri, 03 Nov 2017 17:12:00 +0900</pubDate>
        <link>http://localhost:4000/technique/2017/11/03/Dex/</link>
        <guid isPermaLink="true">http://localhost:4000/technique/2017/11/03/Dex/</guid>
        
        <category>android</category>
        
        
        <category>technique</category>
        
      </item>
    
      <item>
        <title>Install Java</title>
        <description>&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h3 id=&quot;ubuntu에서-java-설치하기&quot;&gt;Ubuntu에서 Java 설치하기&lt;/h3&gt;

&lt;p&gt;자바를 설치하는 여러 블로그를 살펴보면 각각 다른 방법들로 설치를 많이 합니다.
여러 방법들을 시도해보고 적성합니다.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://www.oracle.com/technetwork/java/javase/downloads/index.html&quot;&gt;Oracle&lt;/a&gt;에 접속하면 최신버전의 Java SE를 받을 수 있습니다.&lt;/p&gt;

&lt;p&gt;하지만 개발된 자바 프로그램들이 버전에 맞지 않아 실행이 안되는 경우도 발생합니다. Android를 분석하는데 Jadx 툴을 사용하려면 &lt;code class=&quot;highlighter-rouge&quot;&gt;Java SE 7&lt;/code&gt; 버전을 사용해야 합니다.&lt;/p&gt;

&lt;p&gt;위 사이트에 접속 후 맨 밑의 &lt;code class=&quot;highlighter-rouge&quot;&gt;Java Archive&lt;/code&gt; 항목의 Download를 눌러 해당 OS에 맞는 파일을 다운로드 합니다.&lt;/p&gt;

&lt;p&gt;Ubuntu에서 설치하기 때문에 &lt;code class=&quot;highlighter-rouge&quot;&gt;Linux x64 (jdk-7u80-linux-x64.tar.gz)&lt;/code&gt;를 다운받습니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;&lt;span class=&quot;gp&quot;&gt;root@ubuntu:/home/k3y6reak/Desktop# &lt;/span&gt;mv jdk-7u80-linux-x64.tar.gz /var/cache/oracle-jdk7-installer/
&lt;span class=&quot;gp&quot;&gt;root@ubuntu:/home/k3y6reak/Desktop# &lt;/span&gt;apt-get install python-software-properties
&lt;span class=&quot;gp&quot;&gt;root@ubuntu:/home/k3y6reak/Desktop# &lt;/span&gt;add-apt-repository ppa:webupd8team/java
&lt;span class=&quot;gp&quot;&gt;root@ubuntu:/home/k3y6reak/Desktop# &lt;/span&gt;apt-get update&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;여기서 JDK 버전에 따라서 &lt;code class=&quot;highlighter-rouge&quot;&gt;java&lt;/code&gt;뒤에 숫자를 다르게 합니다. 7버전을 받았으므로 java7이 됩니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;&lt;span class=&quot;gp&quot;&gt;root@ubuntu:/home/k3y6reak/Desktop# &lt;/span&gt;apt-get install oracle-java7-installer&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;그 다음으로 Java를 사용할 수 있도록 환경변수를 설정해 주어야 합니다.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;vim /etc/bash.bashrc/&lt;/code&gt; 를 이용하여 bash.bashrc의 하단에 &lt;code class=&quot;highlighter-rouge&quot;&gt;export JAVA_HOME=/usr/lib/jvm/java-7-oracle&lt;/code&gt;를 작성합니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;&lt;span class=&quot;gp&quot;&gt;root@ubuntu:/home/k3y6reak/Desktop# &lt;/span&gt;vim /etc/bash.bashrc

&lt;span class=&quot;c&quot;&gt;# if the command-not-found package is installed, use it                                                       &lt;/span&gt;
 54 &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt; -x /usr/lib/command-not-found -o -x /usr/share/command-not-found/command-not-found &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;; &lt;span class=&quot;k&quot;&gt;then               
 &lt;/span&gt;55     &lt;span class=&quot;k&quot;&gt;function &lt;/span&gt;command_not_found_handle &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;                                                                        56     ┆   ┆   &lt;span class=&quot;c&quot;&gt;# check because c-n-f could've been removed in the meantime                                       &lt;/span&gt;
 57     ┆   ┆   ┆   &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt; -x /usr/lib/command-not-found &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;; &lt;span class=&quot;k&quot;&gt;then                                                    
 &lt;/span&gt;58         ┆  /usr/lib/command-not-found -- &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$1&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;                                                                 
 59     ┆   ┆   ┆   ┆  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$?&lt;/span&gt;                                                                                  
 60     ┆   ┆   ┆   &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt; -x /usr/share/command-not-found/command-not-found &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;; &lt;span class=&quot;k&quot;&gt;then                              
 &lt;/span&gt;61         ┆  /usr/share/command-not-found/command-not-found -- &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$1&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;                                             
 62     ┆   ┆   ┆   ┆  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$?&lt;/span&gt;                                                                                   63         &lt;span class=&quot;k&quot;&gt;else                                                                                                  
 &lt;/span&gt;64         ┆  &lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;%s: command not found&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$1&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &amp;gt;&amp;amp;2                                                          
 65         ┆  &lt;span class=&quot;k&quot;&gt;return &lt;/span&gt;127                                                                                         
 66         &lt;span class=&quot;k&quot;&gt;fi                                                                                                    
 &lt;/span&gt;67     &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;                                                                                                         
 68 &lt;span class=&quot;k&quot;&gt;fi                                                                                                            
 &lt;/span&gt;69                                                                                                               
 70 &lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;JAVA_HOME&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/usr/lib/jvm/java-7-oracle/  &lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;그리고 &lt;code class=&quot;highlighter-rouge&quot;&gt;source /etc/bash.bashrc&lt;/code&gt;를 입력해 줍니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;&lt;span class=&quot;gp&quot;&gt;root@ubuntu:/home/k3y6reak/Desktop# &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;source&lt;/span&gt; /etc/bash.bashrc&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;정상적으로 Java가 설치가 되었는지 확인하기 위해서 &lt;code class=&quot;highlighter-rouge&quot;&gt;java -version&lt;/code&gt;을 입력합니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;&lt;span class=&quot;gp&quot;&gt;root@ubuntu:/home/k3y6reak/Desktop# &lt;/span&gt;java -version
java version &lt;span class=&quot;s2&quot;&gt;&quot;1.7.0_80&quot;&lt;/span&gt;
Java&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;TM&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; SE Runtime Environment &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;build 1.7.0_80-b15&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Java HotSpot&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;TM&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 64-Bit Server VM &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;build 24.80-b11, mixed mode&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;정상적으로 설치가 완료 됐습니다.&lt;/p&gt;
</description>
        <pubDate>Wed, 01 Nov 2017 19:43:00 +0900</pubDate>
        <link>http://localhost:4000/misc/2017/11/01/Java_install/</link>
        <guid isPermaLink="true">http://localhost:4000/misc/2017/11/01/Java_install/</guid>
        
        
        <category>misc</category>
        
      </item>
    
      <item>
        <title>Extract APK</title>
        <description>&lt;h3 id=&quot;apk-추출하기&quot;&gt;APK 추출하기&lt;/h3&gt;

&lt;p&gt;APK를 분석하기 위해서는 APK 파일의 구조와 어떤 방식으로 동작하는지에 대해서 알아야 합니다. 먼저 APK 내에는 어떤 파일들이 존재하는지 알아보도록 합시다.&lt;/p&gt;

&lt;h4 id=&quot;unzip&quot;&gt;Unzip&lt;/h4&gt;

&lt;p&gt;먼저 Chrome.apk를 받아 &lt;code class=&quot;highlighter-rouge&quot;&gt;Hex Editor&lt;/code&gt;를 이용해 열어봅니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-hex&quot; data-lang=&quot;hex&quot;&gt;Offset(d)00 01 02 03 04 05 06 07 08 09 10 11 12 13 14 15
00000000 50 4B 03 04 0A 00 00 08 00 00 00 00 21 3A 64 68 PK..........!:dh&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Hex 값을 살펴본 결과 &lt;code class=&quot;highlighter-rouge&quot;&gt;PK&lt;/code&gt;로 시작하는 것을 알 수 있습니다. PK로 시작하면 압축해제를 통해서 APK 안의 내용을 추출할 수 있습니다.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;unzip [apk 이름] -d [디렉토리 이름]&lt;/code&gt;을 이용해 해제할 디렉토리에 chrome.apk를 해제합니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;&lt;span class=&quot;gp&quot;&gt;root@ubuntu:/home/k3y6reak/Desktop# &lt;/span&gt;unzip chrome.apk -d Unzip_chrome/
Archive:  chrome.apk
 extracting: Unzip_chrome/assets/chrome_100_percent.pak  
 extracting: Unzip_chrome/assets/icudtl.dat  
 extracting: Unzip_chrome/assets/natives_blob.bin  
 extracting: Unzip_chrome/assets/resources.pak  
 extracting: Unzip_chrome/assets/snapshot_blob_32.bin  
 extracting: Unzip_chrome/assets/webapk_dex_version.txt  
 extracting: Unzip_chrome/lib/armeabi-v7a/crazy.libchrome.so  
 extracting: Unzip_chrome/lib/armeabi-v7a/libchrome.1847.114.so  
 extracting: Unzip_chrome/lib/armeabi-v7a/libchrome.1916.122.so  
 extracting: Unzip_chrome/lib/armeabi-v7a/libchrome.1916.138.so  
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;중략...&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
  inflating: Unzip_chrome/res/xml/usb_device_preferences.xml  
  inflating: Unzip_chrome/res/xml/website_preferences.xml  
  inflating: Unzip_chrome/META-INF/CERT.SF  
  inflating: Unzip_chrome/META-INF/CERT.RSA  
  inflating: Unzip_chrome/META-INF/MANIFEST.MF  
&lt;span class=&quot;gp&quot;&gt;root@ubuntu:/home/k3y6reak/Desktop# &lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;해당 디렉토리에 접근하여 어떤 파일이 존재하는지 살펴보면 아래와 같습니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;&lt;span class=&quot;gp&quot;&gt;root@ubuntu:/home/k3y6reak/Desktop/Unzip_chrome# &lt;/span&gt;ls -al
total 10368
drwxr-xr-x  6 root     root        4096 Oct 31 20:05 .
drwxr-xr-x  4 k3y6reak k3y6reak    4096 Oct 31 20:05 ..
-rw-r--r--  1 root     root       95976 Jan  1  2009 AndroidManifest.xml
drwxr-xr-x  2 root     root        4096 Oct 31 20:05 assets
-rw-r--r--  1 root     root     6282576 Jan  1  2009 classes.dex
drwxr-xr-x  3 root     root        4096 Oct 31 20:05 lib
drwxr-xr-x  2 root     root        4096 Oct 31 20:05 META-INF
drwxr-xr-x 70 root     root        4096 Oct 31 20:05 res
-rw-r--r--  1 root     root     4206860 Jan  1  2009 resources.arsc&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h4 id=&quot;apktool&quot;&gt;Apktool&lt;/h4&gt;

&lt;p&gt;이번에는 &lt;code class=&quot;highlighter-rouge&quot;&gt;apktool&lt;/code&gt;을 이용해서 추출해 보도록 하겠습니다. apktool은 자바가 필요하며 사전에 설치가 돼있어야 합니다.
&lt;a href=&quot;https://k3y6reak.github.io/misc/2017/11/01/Java_install.html&quot;&gt;자바 설치&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;먼저 apktool을 설치해 보겠습니다. &lt;a href=&quot;https://ibotpeaches.github.io/Apktool/install&quot;&gt;여기&lt;/a&gt;에 접속하면 각 운영체제별 설치방법이 나와있습니다. Ubuntu를 기준으로 Linux 설치방법을 따르면 됩니다.&lt;/p&gt;

&lt;p&gt;여기서 주의할 점은 Ubuntu 내에서 apt-get 을 이용해 미리 설치하신 분은 낮은 버전으로 실행되기 때문에 &lt;code class=&quot;highlighter-rouge&quot;&gt;apt-get purge apktool&lt;/code&gt;을 한 뒤 설치를 해주면 됩니다.&lt;/p&gt;

&lt;p&gt;wrapper script 파일을 apktool로 저장합니다. apktool_2.3.0.jar을 apktool.jar로 저장합니다.
이 두 파일을 &lt;code class=&quot;highlighter-rouge&quot;&gt;/usr/bin&lt;/code&gt;에 저장한 뒤 &lt;code class=&quot;highlighter-rouge&quot;&gt;chmod +x apktool apktool.jar&lt;/code&gt;을 해줍니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;&lt;span class=&quot;gp&quot;&gt;root@ubuntu:/home/k3y6reak/Desktop# &lt;/span&gt;mv wrapperscript.txt apktool
&lt;span class=&quot;gp&quot;&gt;root@ubuntu:/home/k3y6reak/Desktop# &lt;/span&gt;mv apktool_2.3.0.jar apktool.jar
&lt;span class=&quot;gp&quot;&gt;root@ubuntu:/home/k3y6reak/Desktop# &lt;/span&gt;chmod +x apktool apktool.jar
&lt;span class=&quot;gp&quot;&gt;root@ubuntu:/home/k3y6reak/Desktop# &lt;/span&gt;mv apktool apktool.jar /usr/bin
&lt;span class=&quot;gp&quot;&gt;root@ubuntu:/home/k3y6reak/Desktop# &lt;/span&gt;apktool
Apktool v2.3.0 - a tool &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;reengineering Android apk files
with smali v2.2.1 and baksmali v2.2.1
Copyright 2014 Ryszard Wiśniewski &amp;lt;brut.alll@gmail.com&amp;gt;
Updated by Connor Tumbleson &amp;lt;connor.tumbleson@gmail.com&amp;gt;

usage: apktool
 -advance,--advanced   prints advance information.
 -version,--version    prints the version &lt;span class=&quot;k&quot;&gt;then &lt;/span&gt;exits
usage: apktool &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;|install-framework &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;options] &amp;lt;framework.apk&amp;gt;
 -p,--frame-path &amp;lt;dir&amp;gt;   Stores framework files into &amp;lt;dir&amp;gt;.
 -t,--tag &amp;lt;tag&amp;gt;          Tag frameworks using &amp;lt;tag&amp;gt;.
usage: apktool d[ecode] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;options] &amp;lt;file_apk&amp;gt;
 -f,--force              Force delete destination directory.
 -o,--output &amp;lt;dir&amp;gt;       The name of folder that gets written. Default is apk.out
 -p,--frame-path &amp;lt;dir&amp;gt;   Uses framework files located &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &amp;lt;dir&amp;gt;.
 -r,--no-res             Do not decode resources.
 -s,--no-src             Do not decode sources.
 -t,--frame-tag &amp;lt;tag&amp;gt;    Uses framework files tagged by &amp;lt;tag&amp;gt;.
usage: apktool b[uild] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;options] &amp;lt;app_path&amp;gt;
 -f,--force-all          Skip changes detection and build all files.
 -o,--output &amp;lt;dir&amp;gt;       The name of apk that gets written. Default is dist/name.apk
 -p,--frame-path &amp;lt;dir&amp;gt;   Uses framework files located &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &amp;lt;dir&amp;gt;.

For additional info, see: http://ibotpeaches.github.io/Apktool/ 
For smali/baksmali info, see: https://github.com/JesusFreke/smali&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;이제 apktool을 사용할 수 있으므로 이를 이용해 chrome.apk를 Decompile을 해보겠습니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;&lt;span class=&quot;gp&quot;&gt;root@ubuntu:/home/k3y6reak/Desktop# &lt;/span&gt;apktool d chrome.apk
I: Using Apktool 2.3.0 on chrome.apk
I: Loading resource table...
I: Decoding AndroidManifest.xml with resources...
S: WARNING: Could not write to &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;/root/.local/share/apktool/framework&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;, using /tmp instead...
S: Please be aware this is a volatile directory and frameworks could go missing, please utilize --frame-path &lt;span class=&quot;k&quot;&gt;if &lt;/span&gt;the default storage directory is unavailable
I: Loading resource table from file: /tmp/1.apk
I: Regular manifest package...
I: Decoding file-resources...
I: Decoding values &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;/&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; XMLs...
I: Baksmaling classes.dex...
I: Copying assets and libs...
I: Copying unknown files...
I: Copying original files...
&lt;span class=&quot;gp&quot;&gt;root@ubuntu:/home/k3y6reak/Desktop# &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;chrome
&lt;span class=&quot;gp&quot;&gt;root@ubuntu:/home/k3y6reak/Desktop/chrome# &lt;/span&gt;ls
AndroidManifest.xml  apktool.yml  assets  lib  original  res  smali&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;apktool 버전이 낮은 경우 main함수에서 null point exception이 발생할 수 있습니다.&lt;/code&gt;&lt;/p&gt;

&lt;h4 id=&quot;jadx&quot;&gt;jadx&lt;/h4&gt;

&lt;p&gt;또 다른 방법으로는 jadx를 이용하는 방법이 있습니다. 마찬가지로 Java가 필요하기 때문에 자바를 설치해야 합니다. 여기서 주의할 점은 8버전을 설치하면 jadx가 실행되지 않을 수 있습니다. &lt;code class=&quot;highlighter-rouge&quot;&gt;7버전으로 설치해야 합니다.&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;git clone https://github.com/skylot/jadx.git&lt;/code&gt;을 통해 해당 파일을 다운로드 받습니다.
다운받은 jadx 디렉토리에 접근하여 &lt;code class=&quot;highlighter-rouge&quot;&gt;./gradlew dist&lt;/code&gt;를 입력하여 컴파일을 합니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;&lt;span class=&quot;gp&quot;&gt;root@ubuntu:~# &lt;/span&gt;git clone https://github.com/skylot/jadx.git
Cloning into &lt;span class=&quot;s1&quot;&gt;'jadx'&lt;/span&gt;...
remote: Counting objects: 11711, &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;.
remote: Total 11711 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;delta 0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;, reused 0 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;delta 0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;, pack-reused 11710
Receiving objects: 100% &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;11711/11711&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;, 5.31 MiB | 1.43 MiB/s, &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;.
Resolving deltas: 100% &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;6143/6143&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;, &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;.
Checking connectivity... &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;.
&lt;span class=&quot;gp&quot;&gt;root@ubuntu:~# &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;jadx
&lt;span class=&quot;gp&quot;&gt;root@ubuntu:~/jadx# &lt;/span&gt;./gradlew dist
:jadx-core:compileJava
warning: &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;options] bootstrap class path not &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;conjunction with -source 1.6
/root/jadx/jadx-core/src/main/java/jadx/core/xmlgen/ParserConstants.java:156: warning: &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;serial] serializable class &amp;lt;anonymous jadx.core.xmlgen.ParserConstants&lt;span class=&quot;nv&quot;&gt;$1&lt;/span&gt;&amp;gt; has no definition of serialVersionUID
        protected static final Map&amp;lt;Integer, String&amp;gt; PLURALS_MAP &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; new HashMap&amp;lt;Integer, String&amp;gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                                                                                                 ^
/root/jadx/jadx-core/src/main/java/jadx/core/dex/instructions/args/LiteralArg.java:68: warning: &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;deprecation] literalToString&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;long,ArgType&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;TypeGen has been deprecated
                        String value &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; TypeGen.literalToString&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;literal, getType&lt;span class=&quot;o&quot;&gt;())&lt;/span&gt;;
                                              ^
3 warnings
:jadx-core:compileGroovy UP-TO-DATE
:jadx-core:processResources
:jadx-core:classes
:jadx-core:jar
:jadx-cli:compileJava
warning: &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;options] bootstrap class path not &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;conjunction with -source 1.6
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;중략...&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
:jadx-gui:installDist
:copyArtifacts
:pack
:dist

BUILD SUCCESSFUL

Total &lt;span class=&quot;nb&quot;&gt;time&lt;/span&gt;: 7.471 secs

This build could be faster, please consider using the Gradle Daemon: https://docs.gradle.org/2.14.1/userguide/gradle_daemon.html
root@ubuntu:~/jadx#&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;컴파일을 모두 마치면 &lt;code class=&quot;highlighter-rouge&quot;&gt;build&lt;/code&gt;라는 디렉토리가 생성되는데 &lt;code class=&quot;highlighter-rouge&quot;&gt;build/jadx/bin/&lt;/code&gt;에 jadx 실행파일이 생성된 것을 볼 수 있습니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;&lt;span class=&quot;gp&quot;&gt;root@ubuntu:~/jadx# &lt;/span&gt;ls
build  build.gradle  gradle  gradlew  gradlew.bat  jadx-cli  jadx-core  jadx-gui  jadx-samples  jadx-test-app  LICENSE  NOTICE  README.md  settings.gradle  version
&lt;span class=&quot;gp&quot;&gt;root@ubuntu:~/jadx# &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;build/
&lt;span class=&quot;gp&quot;&gt;root@ubuntu:~/jadx/build# &lt;/span&gt;ls
jadx  jadx-0.6.1.zip
&lt;span class=&quot;gp&quot;&gt;root@ubuntu:~/jadx/build# &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;jadx
&lt;span class=&quot;gp&quot;&gt;root@ubuntu:~/jadx/build/jadx# &lt;/span&gt;ls
bin  lib  LICENSE  NOTICE  README.md
&lt;span class=&quot;gp&quot;&gt;root@ubuntu:~/jadx/build/jadx# &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;bin
&lt;span class=&quot;gp&quot;&gt;root@ubuntu:~/jadx/build/jadx/bin# &lt;/span&gt;ls
jadx  jadx.bat  jadx-gui  jadx-gui.bat&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;jadx [apk 이름]&lt;/code&gt; 또는 &lt;code class=&quot;highlighter-rouge&quot;&gt;jadx-gui&lt;/code&gt;로 실행 후 apk 파일을 넣어주면 됩니다.&lt;/p&gt;

&lt;p&gt;이 외에 몇가지 부분은 나중에 추가하도록 하겠습니다.&lt;/p&gt;
</description>
        <pubDate>Tue, 31 Oct 2017 19:55:00 +0900</pubDate>
        <link>http://localhost:4000/technique/2017/10/31/Extract_apk/</link>
        <guid isPermaLink="true">http://localhost:4000/technique/2017/10/31/Extract_apk/</guid>
        
        <category>android</category>
        
        
        <category>technique</category>
        
      </item>
    
      <item>
        <title>Install Genymotion</title>
        <description>&lt;h3 id=&quot;genymotion-설치&quot;&gt;GenyMotion 설치&lt;/h3&gt;

&lt;p&gt;안드로이드는 apk 파일로 실행되기 때문에 이를 실행할 수 있는 애뮬레이터가 필요합니다. 보통 사용하는 애뮬레이터는 Nox, Momo 등이 있지만 주로 사용할 것은 GenyMotion 입니다. &lt;a href=&quot;https://genymotion.com&quot;&gt;Genymotion&lt;/a&gt;에 접속해서 가입 후 다운로드를 받습니다.&lt;/p&gt;

&lt;p&gt;Windows의 경우 Virtual Box를 포함한 파일을 받아 설치하고 MacOS는 같이 설치가 됩니다.&lt;/p&gt;

&lt;p&gt;GenyMotion은 안드로이드의 버전과 디바이스를 선택할 수 있는데, &lt;code class=&quot;highlighter-rouge&quot;&gt;Android 4.1.1&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;Nexus S&lt;/code&gt;를 선택하여 설치해 줍니다. 설치를 완료하면 아래와 같이 apk를 실행할 수 있는 안드로이드 4.1.1이 실행됩니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/android/install_genymotion/execute_android.png&quot; alt=&quot;execute_android&quot; /&gt;&lt;/p&gt;

&lt;p&gt;GenyMotion에 바로 APK 파일을 넣어서 설치를 할 수 있습니다. 하지만 안되는 경우도 있는데 이 경우에는 &lt;a href=&quot;https://github.com/k3y6reak/Android/tree/master/Genymotion&quot;&gt;여기&lt;/a&gt;에서 다운받아 해당 애뮬레이터에 넣어준 뒤 APK를 설치하면 됩니다.&lt;/p&gt;
</description>
        <pubDate>Mon, 30 Oct 2017 17:38:00 +0900</pubDate>
        <link>http://localhost:4000/technique/2017/10/30/Genymotion_install/</link>
        <guid isPermaLink="true">http://localhost:4000/technique/2017/10/30/Genymotion_install/</guid>
        
        <category>android</category>
        
        
        <category>technique</category>
        
      </item>
    
      <item>
        <title>Recon and Scan</title>
        <description>&lt;p&gt;PowerShell을 이용해 모의해킹을 진행하는 방법에 대해서 알아보겠습니다.&lt;/p&gt;

&lt;p&gt;임의의 한 사이트에 대해 점검하고자 할 때 해당 서버가 정상적으로 작동하는지, 어떤 포트가 열려있는지에 대해서 알아보겠습니다. &lt;code class=&quot;highlighter-rouge&quot;&gt;허락받지 않은 곳에서 테스트를 할 경우에는 본인에게 책임이 있습니다.&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;점검하기 위해서 여러가지 PowerShell Script를 사용할 수 있습니다.&lt;/p&gt;

&lt;h4 id=&quot;nishang&quot;&gt;Nishang&lt;/h4&gt;
&lt;p&gt;&lt;a href=&quot;http://github.com/samratashok/nishang&quot;&gt;여기&lt;/a&gt;에서 PowerShell Script를 받을 수 있습니다.&lt;/p&gt;

&lt;p&gt;해당 스크립트를 다운받고 &lt;code class=&quot;highlighter-rouge&quot;&gt;Import-Module&lt;/code&gt;명령어를 이용해 nishang.psm1 을 불러옵니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&lt;span class=&quot;se&quot;&gt;\P&lt;/span&gt;owerShell&amp;gt; &lt;span class=&quot;nb&quot;&gt;ls

    &lt;/span&gt;디렉터리: C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&lt;span class=&quot;se&quot;&gt;\P&lt;/span&gt;owerShell

Mode                LastWriteTime         Length Name
----                -------------         ------ ----
d-----   2017. 9. 21.   오후 5:57                nishang-master
d-----   2017. 9. 21.   오후 5:57                Posh-SecMod-master
d-----   2017. 9. 21.   오후 5:57                PowerSploit-master
d-----   2017. 9. 21.   오후 5:57                PowerTools-master
-a----   2017. 9. 20.   오후 8:46        1762079 nishang-master.zip
-a----   2017. 9. 20.   오후 8:49        1542881 Posh-SecMod-master.zip
-a----   2017. 9. 20.   오후 8:47        1898185 PowerSploit-master.zip
-a----   2017. 9. 20.   오후 8:48       10422636 PowerTools-master.zip

&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&lt;span class=&quot;se&quot;&gt;\P&lt;/span&gt;owerShell&amp;gt; Import-Module .&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;ishang-master&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;ishang.psm1
경고: &lt;span class=&quot;s1&quot;&gt;'nishang'&lt;/span&gt; 모듈에서 가져온 일부 명령 이름에 검색 가능성을 낮출 수 있는 승인되지 않은 동사가 포함되어 있습니다.
승인되지 않은 동사가 포함된 명령을 찾으려면 Verbose 매개 변수와 함께 Import-Module 명령을 다시 실행하십시오. 승인된
동사 목록을 보려면 Get-Verb를 입력하십시오.
경고: 가져온 일부 명령 이름에 다음과 같은 제한 문자가 하나 이상 들어 있습니다. &lt;span class=&quot;c1&quot;&gt;# , ( ) [ ] &amp;amp; - / \ $ ^ ; : &quot; ' &amp;lt; | ? @ ` * % + = ~&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;위에서 본 결과처럼 nishang.psm1이 제대로 실행되지 않은 것을 볼 수 있습니다.&lt;/p&gt;

&lt;p&gt;이러한 경우 사용하고자하는 스크립트를 &lt;code class=&quot;highlighter-rouge&quot;&gt;Dot Sourcing&lt;/code&gt; 방법으로 사용할 수 있습니다.
Dot Sourcing에 대한 설명은 &lt;a href=&quot;https://k3y6reak.github.io/technique/powershell/2017/08/08/Functios.html&quot;&gt;여기&lt;/a&gt;를 참고해 주세요.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&lt;span class=&quot;se&quot;&gt;\P&lt;/span&gt;owerShell&amp;gt; . .&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;ishang-master&lt;span class=&quot;se&quot;&gt;\S&lt;/span&gt;can&lt;span class=&quot;se&quot;&gt;\I&lt;/span&gt;nvoke-PortScan.ps1
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&lt;span class=&quot;se&quot;&gt;\P&lt;/span&gt;owerShell&amp;gt; Invoke-PortScan -StartAddress XXX.XXX.XXX.XXX -EndAddress XXX.XXX.XXX.XXX -ResolveHost

IPAddress       HostName            Ports
---------       --------            -----
XXX.XXX.XXX.XXX abcde.abcedf.ab.ab&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;StartAddress&lt;/code&gt;에 시작할 IP주소를 넣어주고 &lt;code class=&quot;highlighter-rouge&quot;&gt;EndAddress&lt;/code&gt;에 끝날 IP주소를 넣어주면 됩니다. 그러면 시작 IP부터 끝 IP까지 진행하면서 서버가 작동하는 IP 주소를 출력해 줍니다.&lt;/p&gt;

&lt;p&gt;또한 열려있는 포트를 찾고자 한다면 -ResolveHost 옵션 대신 &lt;code class=&quot;highlighter-rouge&quot;&gt;ScanPort&lt;/code&gt;옵션을 사용하면 됩니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&lt;span class=&quot;se&quot;&gt;\P&lt;/span&gt;owerShell&amp;gt; Invoke-PortScan -StartAddress XXX.XXX.XXX.XXX -EndAddress XXX.XXX.XXX.XXX -ScanPort

IPAddress       HostName Ports
---------       -------- -----
XXX.XXX.XXX.XXX          &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;80, 443&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h4 id=&quot;powersploit&quot;&gt;PowerSploit&lt;/h4&gt;
&lt;p&gt;이번에는 다른 스크립트를 사용해 보겠습니다. &lt;a href=&quot;https://github.com/mattifestation/PowerSploit&quot;&gt;여기&lt;/a&gt;에서 PowerShell Script를 받을 수 있습니다.&lt;/p&gt;

&lt;p&gt;DotSourcing 방식으로 &lt;code class=&quot;highlighter-rouge&quot;&gt;Get-HttpStatus&lt;/code&gt; 스크립트를 가져옵니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&lt;span class=&quot;se&quot;&gt;\P&lt;/span&gt;owerShell&amp;gt; . .&lt;span class=&quot;se&quot;&gt;\P&lt;/span&gt;owerSploit-master&lt;span class=&quot;se&quot;&gt;\R&lt;/span&gt;econ&lt;span class=&quot;se&quot;&gt;\G&lt;/span&gt;et-HttpStatus.ps1
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&lt;span class=&quot;se&quot;&gt;\P&lt;/span&gt;owerShell&amp;gt; Get-HttpStatus -Target XXX.XXX.XXX.XXX -Path .&lt;span class=&quot;se&quot;&gt;\P&lt;/span&gt;owerSploit-master&lt;span class=&quot;se&quot;&gt;\R&lt;/span&gt;econ&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ictionaries&lt;span class=&quot;se&quot;&gt;\g&lt;/span&gt;eneric.txt -Port 80 | &lt;span class=&quot;nb&quot;&gt;Where-Object&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_&lt;/span&gt;.Status -match &lt;span class=&quot;s2&quot;&gt;&quot;ok&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;테스트 하고자 하는 서버에서 일치하는 결과값이 없기 때문에 출력이 안되지만 결과가 존재한다면 취약점으로 작용할 수 있습니다.&lt;/p&gt;

&lt;p&gt;이 외에도 PowerTools, Posh-SecMod 등 여러가지 스크립트들이 있습니다.&lt;/p&gt;
</description>
        <pubDate>Thu, 21 Sep 2017 21:00:00 +0900</pubDate>
        <link>http://localhost:4000/technique/2017/09/21/Recon_and_Scan/</link>
        <guid isPermaLink="true">http://localhost:4000/technique/2017/09/21/Recon_and_Scan/</guid>
        
        <category>powershell</category>
        
        
        <category>technique</category>
        
      </item>
    
      <item>
        <title>Registry</title>
        <description>&lt;p&gt;PowerShell에서 레지스트리에 접근하고자 하는 경우 &lt;code class=&quot;highlighter-rouge&quot;&gt;Get-Item&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;Get-ChildItem&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;Get-ItemProperty&lt;/code&gt;를 사용할 수 있습니다.&lt;/p&gt;

&lt;h4 id=&quot;get-item&quot;&gt;Get-Item&lt;/h4&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nb&quot;&gt;Get-Item&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'HKLM:\Software\Microsoft\Windows NT\CurrentVersion'&lt;/span&gt;


    Hive: HKEY_LOCAL_MACHINE&lt;span class=&quot;se&quot;&gt;\S&lt;/span&gt;oftware&lt;span class=&quot;se&quot;&gt;\M&lt;/span&gt;icrosoft&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;indows NT


Name                           &lt;span class=&quot;nb&quot;&gt;Property&lt;/span&gt;
----                           --------
CurrentVersion                 SystemRoot                : C:&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;INDOWS
                               BuildBranch               : rs2_release
                               BuildGUID                 : ffffffff-ffff-ffff-ffff-ffffffffffff
                               BuildLab                  : 15063.rs2_release.170317-1834
                               BuildLabEx                : 15063.0.amd64fre.rs2_release.170317-1834
                               CompositionEditionID      : Education
                               CurrentBuild              : 15063
                               CurrentBuildNumber        : 15063
                               CurrentMajorVersionNumber : 10
                               CurrentMinorVersionNumber : 0
                               CurrentType               : Multiprocessor Free
                               CurrentVersion            : 6.3
                               EditionID                 : Education
                               EditionSubstring          :
                               InstallationType          : Client
                               InstallDate               : 1502094253
                               ProductName               : Windows 10 Education
                               ReleaseId                 : 1703
                               SoftwareType              : System
                               UBR                       : 540
                               PathName                  : C:&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;INDOWS
                               ProductId                 : 
                               DigitalProductId          : 
                               DigitalProductId4         : 
                               RegisteredOrganization    :
                               RegisteredOwner           : k3y6reak
                               InstallTime               : 131465678534059230&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h4 id=&quot;get-itemproperty&quot;&gt;Get-ItemProperty&lt;/h4&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nb&quot;&gt;Get-ItemProperty&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion'&lt;/span&gt;


SystemRoot                : C:&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;INDOWS
BuildBranch               : rs2_release
BuildGUID                 : ffffffff-ffff-ffff-ffff-ffffffffffff
BuildLab                  : 15063.rs2_release.170317-1834
BuildLabEx                : 15063.0.amd64fre.rs2_release.170317-1834
CompositionEditionID      : Education
CurrentBuild              : 15063
CurrentBuildNumber        : 15063
CurrentMajorVersionNumber : 10
CurrentMinorVersionNumber : 0
CurrentType               : Multiprocessor Free
CurrentVersion            : 6.3
EditionID                 : Education
EditionSubstring          :
InstallationType          : Client
InstallDate               : 1502094253
ProductName               : Windows 10 Education
ReleaseId                 : 1703
SoftwareType              : System
UBR                       : 540
PathName                  : C:&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;INDOWS
ProductId                 : 
DigitalProductId          : 
DigitalProductId4         : 
RegisteredOrganization    :
RegisteredOwner           : k3y6reak
InstallTime               : 131465678534059230
PSPath                    : Microsoft.PowerShell.Core&lt;span class=&quot;se&quot;&gt;\R&lt;/span&gt;egistry::HKEY_LOCAL_MACHINE&lt;span class=&quot;se&quot;&gt;\S&lt;/span&gt;OFTWARE&lt;span class=&quot;se&quot;&gt;\M&lt;/span&gt;icrosoft&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;indows NT&lt;span class=&quot;se&quot;&gt;\C&lt;/span&gt;urrentVersion
PSParentPath              : Microsoft.PowerShell.Core&lt;span class=&quot;se&quot;&gt;\R&lt;/span&gt;egistry::HKEY_LOCAL_MACHINE&lt;span class=&quot;se&quot;&gt;\S&lt;/span&gt;OFTWARE&lt;span class=&quot;se&quot;&gt;\M&lt;/span&gt;icrosoft&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;indows NT
PSChildName               : CurrentVersion
PSDrive                   : HKLM
PSProvider                : Microsoft.PowerShell.Core&lt;span class=&quot;se&quot;&gt;\R&lt;/span&gt;egistry&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h4 id=&quot;get-childitem&quot;&gt;Get-ChildItem&lt;/h4&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nb&quot;&gt;Get-ChildItem&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'HKLM:\software\microsoft\windows nt\CurrentVersion'&lt;/span&gt; -Recurse | more
&lt;span class=&quot;nb&quot;&gt;Get-ChildItem&lt;/span&gt; : 요청한 레지스트리에 액세스할 수 없습니다.
위치 줄:1 문자:1
+ &lt;span class=&quot;nb&quot;&gt;Get-ChildItem&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'HKLM:\software\microsoft\windows nt\CurrentVersion'&lt;/span&gt; -R ...
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : PermissionDenied: &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;HKEY_LOCAL_MACH...lags&lt;span class=&quot;se&quot;&gt;\C&lt;/span&gt;IT&lt;span class=&quot;se&quot;&gt;\S&lt;/span&gt;ystem:String&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;Get-ChildItem&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;, SecurityException
    + FullyQualifiedErrorId : System.Security.SecurityException,Microsoft.PowerShell.Commands.GetChildItemCommand


...&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;중략&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;


    Hive: HKEY_LOCAL_MACHINE&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;oftware&lt;span class=&quot;se&quot;&gt;\m&lt;/span&gt;icrosoft&lt;span class=&quot;se&quot;&gt;\w&lt;/span&gt;indows nt&lt;span class=&quot;se&quot;&gt;\C&lt;/span&gt;urrentVersion


Name                           &lt;span class=&quot;nb&quot;&gt;Property&lt;/span&gt;
----                           --------
Accessibility


    Hive: HKEY_LOCAL_MACHINE&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;oftware&lt;span class=&quot;se&quot;&gt;\m&lt;/span&gt;icrosoft&lt;span class=&quot;se&quot;&gt;\w&lt;/span&gt;indows nt&lt;span class=&quot;se&quot;&gt;\C&lt;/span&gt;urrentVersion&lt;span class=&quot;se&quot;&gt;\A&lt;/span&gt;ccessibility


Name                           &lt;span class=&quot;nb&quot;&gt;Property&lt;/span&gt;
----                           --------
ATs


    Hive: HKEY_LOCAL_MACHINE&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;oftware&lt;span class=&quot;se&quot;&gt;\m&lt;/span&gt;icrosoft&lt;span class=&quot;se&quot;&gt;\w&lt;/span&gt;indows nt&lt;span class=&quot;se&quot;&gt;\C&lt;/span&gt;urrentVersion&lt;span class=&quot;se&quot;&gt;\A&lt;/span&gt;ccessibility&lt;span class=&quot;se&quot;&gt;\A&lt;/span&gt;Ts


Name                           &lt;span class=&quot;nb&quot;&gt;Property&lt;/span&gt;
----                           --------
animations                     Description   :
                               Profile       : &amp;lt;HCIModel&amp;gt;&amp;lt;Accommodation &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;mild cognitive&quot;&lt;/span&gt; /&amp;gt;&amp;lt;Accommodation &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;severe cognitive&quot;&lt;/span&gt; /&amp;gt;&amp;lt;Accommodation &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;severe vision&quot;&lt;/span&gt; /&amp;gt;&amp;lt;Accommodation &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;mild vision&quot;&lt;/span&gt;
                               /&amp;gt;&amp;lt;/HCIModel&amp;gt;
                               SimpleProfile : SystemSetting
                               StartExe      : 13
...&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;생략&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;추가적으로 &lt;code class=&quot;highlighter-rouge&quot;&gt;Set-Location&lt;/code&gt;을 이용하여 레지스트리에 직접 접근할 수 있습니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nb&quot;&gt;Set-Location &lt;/span&gt;Registry::
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;Microsoft.PowerShell.Core&lt;span class=&quot;se&quot;&gt;\R&lt;/span&gt;egistry::&amp;gt; &lt;span class=&quot;nb&quot;&gt;ls


    &lt;/span&gt;Hive:


Name                           &lt;span class=&quot;nb&quot;&gt;Property&lt;/span&gt;
----                           --------
HKEY_LOCAL_MACHINE
HKEY_CURRENT_USER
HKEY_CLASSES_ROOT
HKEY_CURRENT_CONFIG
HKEY_USERS
HKEY_PERFORMANCE_DATA          Global : &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;80, 0, 69, 0...&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
                               Costly : &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;80, 0, 69, 0...&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;이번에는 레지스트리를 수정하고 생성하는 방법을 알아 봅시다.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;New-Item&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;New-ItemProperty&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;Rename-Item&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;Rename-ItemProperty&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;Set-ItemProperty&lt;/code&gt;가 있습니다.&lt;/p&gt;

&lt;h4 id=&quot;new-item&quot;&gt;New-Item&lt;/h4&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nb&quot;&gt;Get-PSProvider

&lt;/span&gt;Name                 Capabilities                                                                     Drives
----                 ------------                                                                     ------
Registry             ShouldProcess, Transactions                                                      &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;HKLM, HKCU&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
Alias                ShouldProcess                                                                    &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;Alias&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
Environment          ShouldProcess                                                                    &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;Env&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
FileSystem           &lt;span class=&quot;k&quot;&gt;Filter&lt;/span&gt;, ShouldProcess, Credentials                                               &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;C, D, E, Y...&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;Function             &lt;/span&gt;ShouldProcess                                                                    &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;Function&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
Variable             ShouldProcess                                                                    &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;Variable&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nb&quot;&gt;New-Item&lt;/span&gt; -Path HKCU:&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak


    Hive: HKEY_CURRENT_USER


Name                           &lt;span class=&quot;nb&quot;&gt;Property&lt;/span&gt;
----                           --------
k3y6reak&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;위와 같이 스크립트를 실행하면 아래 그림 처럼 레지스트리를 등록할 수 있습니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/powershell/registry/registry.png&quot; alt=&quot;powershell_create_registry&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;new-itemproperty&quot;&gt;New-ItemProperty&lt;/h4&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nb&quot;&gt;New-ItemProperty&lt;/span&gt; -Path HKCU:&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;-Name Reg1 -PropertyType &lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt; -Value 2


Reg1         : 2
PSPath       : Microsoft.PowerShell.Core&lt;span class=&quot;se&quot;&gt;\R&lt;/span&gt;egistry::HKEY_CURRENT_USER&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
PSParentPath : Microsoft.PowerShell.Core&lt;span class=&quot;se&quot;&gt;\R&lt;/span&gt;egistry::HKEY_CURRENT_USER
PSChildName  : k3y6reak
PSDrive      : HKCU
PSProvider   : Microsoft.PowerShell.Core&lt;span class=&quot;se&quot;&gt;\R&lt;/span&gt;egistry&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;위와 같이 해당 위치에 값 또한 설정할 수 있습니다.&lt;/p&gt;

&lt;h4 id=&quot;rename-item&quot;&gt;Rename-Item&lt;/h4&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nb&quot;&gt;Rename-Item &lt;/span&gt;HKCU:&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak -newname k3y6reak2&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;특정 레지스트리의 이름을 변경할 수 있습니다.&lt;/p&gt;

&lt;h4 id=&quot;rename-itemproperty&quot;&gt;Rename-ItemProperty&lt;/h4&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nb&quot;&gt;Rename-ItemProperty &lt;/span&gt;HKCU:&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak2 -Name Reg1 -NewName Reg2&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;마찬가지로 특정 레지스트리의 값 또한 변경할 수 있습니다.&lt;/p&gt;

&lt;h4 id=&quot;set-itemproperty&quot;&gt;Set-ItemProperty&lt;/h4&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nb&quot;&gt;Set-ItemProperty&lt;/span&gt; -Path HKCU:&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak2 -Name Reg2 -Value 4855&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

</description>
        <pubDate>Fri, 08 Sep 2017 14:56:00 +0900</pubDate>
        <link>http://localhost:4000/technique/2017/09/08/Registry/</link>
        <guid isPermaLink="true">http://localhost:4000/technique/2017/09/08/Registry/</guid>
        
        <category>powershell</category>
        
        
        <category>technique</category>
        
      </item>
    
      <item>
        <title>COM</title>
        <description>&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;COM&lt;/code&gt;은 Component Object Model로 &lt;a href=&quot;https://ko.wikipedia.org/wiki/%EC%BB%B4%ED%8F%AC%EB%84%8C%ED%8A%B8_%EC%98%A4%EB%B8%8C%EC%A0%9D%ED%8A%B8_%EB%AA%A8%EB%8D%B8&quot;&gt;위키백과&lt;/a&gt;를 참조하길 바란다.&lt;/p&gt;

&lt;p&gt;PowerShell에서 &lt;code class=&quot;highlighter-rouge&quot;&gt;ComObject&lt;/code&gt;를 이용해 Registry에 접근할 수 있다.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Get-ChildItem REGISTRY::HKEY_CLASSES_ROOT\CLSID -include PROGID -recurse | ForEach {$_.GetValue(&quot;&quot;)}&lt;/code&gt;를 실행해 보자.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ps&quot; data-lang=&quot;ps&quot;&gt;PS C:\WINDOWS\system32&amp;gt; Get-ChildItem REGISTRY::HKEY_CLASSES_ROOT\CLSID -include PROGID -recurse | ForEach {$_.GetValue(&quot;&quot;)}
file
StaticMetafile
StaticDib
clsid
objref
ADODB.Command.6.0
ADODB.Parameter.6.0
ADODB.Connection.6.0
ADODB.Recordset.6.0
...(생략)&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;많은 결과가 출력되는데 이 중 &lt;code class=&quot;highlighter-rouge&quot;&gt;wscript&lt;/code&gt;만 출력해 보자. &lt;code class=&quot;highlighter-rouge&quot;&gt;| Where-Object {$_ -match &quot;wscript&quot;}&lt;/code&gt;를 붙여주면 된다. wscript는 윈도우에서 사용하는 스크립트다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ps&quot; data-lang=&quot;ps&quot;&gt;PS C:\WINDOWS\system32&amp;gt; Get-ChildItem REGISTRY::HKEY_CLASSES_ROOT\CLSID -include PROGID -recurse | ForEach {$_.GetValue(&quot;&quot;)} | Where-Object {$_ -match &quot;wscript&quot;}
WScript.Network.1
WScript.Shell.1
WScript.Shell.1
WScript.Network.1&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;여기서 WScript.Shell.1을 사용해보자.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;$wscript = New-Object -ComObject Wscript.Shell.1&lt;/code&gt;을 입력한 후 &lt;code class=&quot;highlighter-rouge&quot;&gt;$wscript | Get-Member&lt;/code&gt;을 입력해 보자.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ps&quot; data-lang=&quot;ps&quot;&gt;PS C:\WINDOWS\system32&amp;gt; $wscript = New-Object -ComObject Wscript.Shell.1
PS C:\WINDOWS\system32&amp;gt; $wscript | Get-Member


   TypeName: System.__ComObject#{41904400-be18-11d3-a28b-00104bd35090}

Name                     MemberType            Definition
----                     ----------            ----------
AppActivate              Method                bool AppActivate (Variant, Variant)
CreateShortcut           Method                IDispatch CreateShortcut (string)
Exec                     Method                IWshExec Exec (string)
ExpandEnvironmentStrings Method                string ExpandEnvironmentStrings (string)
LogEvent                 Method                bool LogEvent (Variant, string, string)
Popup                    Method                int Popup (string, Variant, Variant, Variant)
RegDelete                Method                void RegDelete (string)
RegRead                  Method                Variant RegRead (string)
RegWrite                 Method                void RegWrite (string, Variant, Variant)
Run                      Method                int Run (string, Variant, Variant)
SendKeys                 Method                void SendKeys (string, Variant)
Environment              ParameterizedProperty IWshEnvironment Environment (Variant) {get}
CurrentDirectory         Property              string CurrentDirectory () {get} {set}
SpecialFolders           Property              IWshCollection SpecialFolders () {get}&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;사용할 수 있는 Method들이 출력된 것을 볼 수 있다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ps&quot; data-lang=&quot;ps&quot;&gt;PS C:\WINDOWS\system32&amp;gt; $wscript.CurrentDirectory
C:\WINDOWS\system32
PS C:\WINDOWS\system32&amp;gt; $wscript.Exec(&quot;notepad.exe&quot;)


Status    : 0
StdIn     : System.__ComObject
StdOut    : System.__ComObject
StdErr    : System.__ComObject
ProcessID : 8056
ExitCode  : 0&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;이렇게 사용할 수 있다.&lt;/p&gt;

</description>
        <pubDate>Wed, 06 Sep 2017 19:14:00 +0900</pubDate>
        <link>http://localhost:4000/technique/2017/09/06/COM/</link>
        <guid isPermaLink="true">http://localhost:4000/technique/2017/09/06/COM/</guid>
        
        <category>powershell</category>
        
        
        <category>technique</category>
        
      </item>
    
      <item>
        <title>WMI</title>
        <description>&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;WMI&lt;/code&gt;는 Windows Management Instrumentation으로 &lt;code class=&quot;highlighter-rouge&quot;&gt;윈도우 관리 도구&lt;/code&gt;다. 이를 PowerShell에서 사용할 수 있는데 &lt;code class=&quot;highlighter-rouge&quot;&gt;Get-WmiObject&lt;/code&gt;명령을 이용한다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;INDOWS&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;ystem32&amp;gt; &lt;span class=&quot;nb&quot;&gt;Get-WmiObject&lt;/span&gt; -Namespace &lt;span class=&quot;s2&quot;&gt;&quot;root&quot;&lt;/span&gt; -Class &lt;span class=&quot;s2&quot;&gt;&quot;__Namespace&quot;&lt;/span&gt;


__GENUS          : 2
__CLASS          : __NAMESPACE
__SUPERCLASS     : __SystemClass
__DYNASTY        : __SystemClass
__RELPATH        : __NAMESPACE.Name&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;subscription&quot;&lt;/span&gt;
__PROPERTY_COUNT : 1
__DERIVATION     : &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;__SystemClass&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
__SERVER         : K3Y6REAK9778
__NAMESPACE      : ROOT
__PATH           : &lt;span class=&quot;se&quot;&gt;\\&lt;/span&gt;K3Y6REAK9778&lt;span class=&quot;se&quot;&gt;\R&lt;/span&gt;OOT:__NAMESPACE.Name&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;subscription&quot;&lt;/span&gt;
Name             : subscription
PSComputerName   : K3Y6REAK9778

__GENUS          : 2
__CLASS          : __NAMESPACE
__SUPERCLASS     : __SystemClass
__DYNASTY        : __SystemClass
__RELPATH        : __NAMESPACE.Name&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;DEFAULT&quot;&lt;/span&gt;
__PROPERTY_COUNT : 1
__DERIVATION     : &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;__SystemClass&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
__SERVER         : K3Y6REAK9778
__NAMESPACE      : ROOT
__PATH           : &lt;span class=&quot;se&quot;&gt;\\&lt;/span&gt;K3Y6REAK9778&lt;span class=&quot;se&quot;&gt;\R&lt;/span&gt;OOT:__NAMESPACE.Name&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;DEFAULT&quot;&lt;/span&gt;
Name             : DEFAULT
PSComputerName   : K3Y6REAK9778&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;여기서 이름에 대한 내용만 가져오고 싶은 경우 &lt;code class=&quot;highlighter-rouge&quot;&gt;| Select-Object Name&lt;/code&gt;를 붙여주면 된다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;INDOWS&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;ystem32&amp;gt; &lt;span class=&quot;nb&quot;&gt;Get-WmiObject&lt;/span&gt; -Namespace &lt;span class=&quot;s2&quot;&gt;&quot;root&quot;&lt;/span&gt; -Class &lt;span class=&quot;s2&quot;&gt;&quot;__Namespace&quot;&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;Select-Object &lt;/span&gt;Name

Name
----
subscription
DEFAULT
CIMV2
msdtc
&lt;span class=&quot;nb&quot;&gt;Cli
&lt;/span&gt;SECURITY
SecurityCenter2
RSOP
PEH
StandardCimv2
WMI
directory
Policy
Interop
Hardware
ServiceModel
SecurityCenter
Microsoft
aspnet
Appv&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Wmi-Object 중에서 CIMV2에 대한 내용을 살펴보자.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Get-WmiObject -NameSpace &quot;root/cimv2&quot; -List&lt;/code&gt;를 입력하면 아래와 같은 수많은 항목을 볼 수 있다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;INDOWS&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;ystem32&amp;gt; &lt;span class=&quot;nb&quot;&gt;Get-WmiObject&lt;/span&gt; -NameSpace &lt;span class=&quot;s2&quot;&gt;&quot;root/cimv2&quot;&lt;/span&gt; -List


   NameSpace: ROOT&lt;span class=&quot;se&quot;&gt;\C&lt;/span&gt;IMV2

Name                                Methods              Properties
----                                -------              ----------
__SystemClass                       &lt;span class=&quot;o&quot;&gt;{}&lt;/span&gt;                   &lt;span class=&quot;o&quot;&gt;{}&lt;/span&gt;
__thisNAMESPACE                     &lt;span class=&quot;o&quot;&gt;{}&lt;/span&gt;                   &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;SECURITY_DESCRIPTOR&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
__Provider                          &lt;span class=&quot;o&quot;&gt;{}&lt;/span&gt;                   &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;Name&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
__Win32Provider                     &lt;span class=&quot;o&quot;&gt;{}&lt;/span&gt;                   &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;ClientLoadableCLSID, CLSID, Concurrency, DefaultMachineName...&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
__ProviderRegistration              &lt;span class=&quot;o&quot;&gt;{}&lt;/span&gt;                   &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;provider&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
__EventProviderRegistration         &lt;span class=&quot;o&quot;&gt;{}&lt;/span&gt;                   &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;EventQueryList, provider&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
__ObjectProviderRegistration        &lt;span class=&quot;o&quot;&gt;{}&lt;/span&gt;                   &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;InteractionType, provider, QuerySupportLevels, SupportsBatching...&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
__ClassProviderRegistration         &lt;span class=&quot;o&quot;&gt;{}&lt;/span&gt;                   &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;CacheRefreshInterval, InteractionType, PerUserSchema, provider...&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
__InstanceProviderRegistration      &lt;span class=&quot;o&quot;&gt;{}&lt;/span&gt;                   &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;InteractionType, provider, QuerySupportLevels, SupportsBatching...&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

...&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;생략&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;여기서 Win32에 대한 항목을 보고 싶다면 &lt;code class=&quot;highlighter-rouge&quot;&gt;| Where-Object {$_.Name -match &quot;Win32}&lt;/code&gt;를 붙여주면 된다. 마찬가지로 많은 항목이 출력된다. 이 중 Win32_Process을 사용해 보자.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Get-WmiObject -Class Win32_Process&lt;/code&gt;를 실행하면 이 또한 많은 항목이 출력된다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;__GENUS                    : 2
__CLASS                    : Win32_Process
__SUPERCLASS               : CIM_Process
__DYNASTY                  : CIM_ManagedSystemElement
__RELPATH                  : Win32_Process.Handle&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;604&quot;&lt;/span&gt;
__PROPERTY_COUNT           : 45
__DERIVATION               : &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;CIM_Process, CIM_LogicalElement, CIM_ManagedSystemElement&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
__SERVER                   : K3Y6REAK9778
__NAMESPACE                : root&lt;span class=&quot;se&quot;&gt;\c&lt;/span&gt;imv2
__PATH                     : &lt;span class=&quot;se&quot;&gt;\\&lt;/span&gt;K3Y6REAK9778&lt;span class=&quot;se&quot;&gt;\r&lt;/span&gt;oot&lt;span class=&quot;se&quot;&gt;\c&lt;/span&gt;imv2:Win32_Process.Handle&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;604&quot;&lt;/span&gt;
Caption                    : wininit.exe
CommandLine                :
CreationClassName          : Win32_Process
CreationDate               : 20170813174441.546153+540
CSCreationClassName        : Win32_ComputerSystem
CSName                     : K3Y6REAK9778
Description                : wininit.exe
ExecutablePath             :
ExecutionState             :
Handle                     : 604
HandleCount                : 152
InstallDate                :
KernelModeTime             : 12343750
MaximumWorkingSetSize      :
MinimumWorkingSetSize      :
Name                       : wininit.exe
OSCreationClassName        : Win32_OperatingSystem
OSName                     : Microsoft Windows 10 Education|C:&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;INDOWS|&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;evice&lt;span class=&quot;se&quot;&gt;\H&lt;/span&gt;arddisk0&lt;span class=&quot;se&quot;&gt;\P&lt;/span&gt;artition4
OtherOperationCount        : 17201
OtherTransferCount         : 4702606
PageFaults                 : 6127
PageFileUsage              : 1704
ParentProcessId            : 500
PeakPageFileUsage          : 2200
PeakVirtualSize            : 2199082618880
PeakWorkingSetSize         : 7188
Priority                   : 13
PrivatePageCount           : 1744896
ProcessId                  : 604
QuotaNonPagedPoolUsage     : 12
QuotaPagedPoolUsage        : 120
QuotaPeakNonPagedPoolUsage : 15
QuotaPeakPagedPoolUsage    : 122
ReadOperationCount         : 22
ReadTransferCount          : 56320
SessionId                  : 0
Status                     :
TerminationDate            :
ThreadCount                : 1
UserModeTime               : 0
VirtualSize                : 2199078547456
WindowsVersion             : 10.0.15063
WorkingSetSize             : 4096
WriteOperationCount        : 0
WriteTransferCount         : 0
PSComputerName             : K3Y6REAK9778
ProcessName                : wininit.exe
Handles                    : 152
VM                         : 2199078547456
WS                         : 4096
Path                       :&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;이름만 출력하고 싶다면 &lt;code class=&quot;highlighter-rouge&quot;&gt;| select Name&lt;/code&gt;을 붙여주면 된다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;INDOWS&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;ystem32&amp;gt; &lt;span class=&quot;nb&quot;&gt;Get-WmiObject&lt;/span&gt; -Class Win32_Process | &lt;span class=&quot;nb&quot;&gt;Select &lt;/span&gt;Name

Name
----
System Idle &lt;span class=&quot;k&quot;&gt;Process
&lt;/span&gt;System
smss.exe
csrss.exe
wininit.exe
services.exe
lsass.exe
svchost.exe
svchost.exe
fontdrvhost.exe
svchost.exe
svchost.exe
svchost.exe
svchost.exe
WUDFHost.exe
...&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;생략&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;이 명령어을 이용해서 Win7의 정보를 가져올 수 있다.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Get-WmiObject -Class Win32_Process -ComputerName [Win7 컴퓨터이름] -Credential [Win7 계정] | select Name&lt;/code&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;INDOWS&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;ystem32&amp;gt; &lt;span class=&quot;nb&quot;&gt;Get-WmiObject&lt;/span&gt; -Class Win32_Process -ComputerName WIN-J9KO348JQVU -Credential k3y6reak | &lt;span class=&quot;nb&quot;&gt;select &lt;/span&gt;Name

Name
----
System Idle &lt;span class=&quot;k&quot;&gt;Process
&lt;/span&gt;System
smss.exe
csrss.exe
wininit.exe
csrss.exe
winlogon.exe
services.exe
lsass.exe
lsm.exe
svchost.exe
vmacthlp.exe
svchost.exe
svchost.exe
svchost.exe
svchost.exe
audiodg.exe
svchost.exe
svchost.exe
spoolsv.exe
svchost.exe
VGAuthService.exe
vmtoolsd.exe
svchost.exe
dllhost.exe
dllhost.exe
WmiPrvSE.exe
msdtc.exe
taskhost.exe
dwm.exe
explorer.exe
vmtoolsd.exe
VSSVC.exe
SearchIndexer.exe
wmpnetwk.exe
svchost.exe
SearchProtocolHost.exe
SearchFilterHost.exe
WmiPrvSE.exe
WmiApSrv.exe
powershell.exe
conhost.exe
sppsvc.exe
svchost.exe&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;여러 프로세스 중 특정 한 프로세스만 출력하고 싶은 경우 여러가지 방법이 있다.&lt;/p&gt;

&lt;h4 id=&quot;-eq&quot;&gt;-eq&lt;/h4&gt;

&lt;p&gt;eq는 equal로 같은 문자열이 있는 것을 찾는다. 
&lt;code class=&quot;highlighter-rouge&quot;&gt;Get-WmiObject -Class Win32_Process | Where-Object {$_.Name -eq &quot;powershell.exe&quot;}&lt;/code&gt;를 이용해 powershell.exe를 찾게된다.&lt;/p&gt;

&lt;h4 id=&quot;-filter&quot;&gt;-Filter&lt;/h4&gt;

&lt;p&gt;필터 또한 찾고자 하는 문자열을 찾아주는 기능을 한다.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Get-WmiObject -Class Win32_Process -Filter {Name = &quot;powershell.exe&quot;}&lt;/code&gt;&lt;/p&gt;

&lt;h4 id=&quot;-query&quot;&gt;-Query&lt;/h4&gt;

&lt;p&gt;쿼리는 쿼리문을 이용하여 찾는 방법을 말한다.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Get-WmiObject -Query {Select * from Win32_Process where name = &quot;powershell.exe&quot;}&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;eq, filter, query&lt;/code&gt; 모두 동일한 결과를 출력한다.&lt;/p&gt;

&lt;p&gt;WMI을 이용해서 프로세스를 실행시킬 수 있다. 먼저 Win32_Process에서 사용할 수 있는 Method를 살펴보자.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Get-WmiObject -Class Win32_Process -List&lt;/code&gt;를 입력한다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;INDOWS&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;ystem32&amp;gt; &lt;span class=&quot;nb&quot;&gt;Get-WmiObject&lt;/span&gt; -Class Win32_Process -List


   NameSpace: ROOT&lt;span class=&quot;se&quot;&gt;\c&lt;/span&gt;imv2

Name                                Methods              Properties
----                                -------              ----------
Win32_Process                       &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;Create, Terminat... &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;Caption, CommandLine, CreationClassName, CreationDate...&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Methods 항목에 Create, Termiat… 를 볼 수 있는데 사용할 수 있는 Method를 모두 보자.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Get-WmiObject -Class Win32_Process -List | Select-Object -ExpandProterty Methods&lt;/code&gt;를 입력해 보자.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;INDOWS&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;ystem32&amp;gt; &lt;span class=&quot;nb&quot;&gt;Get-WmiObject&lt;/span&gt; -Class Win32_Process -List | &lt;span class=&quot;nb&quot;&gt;Select-Object&lt;/span&gt; -ExpandProperty Methods


Name          : Create
InParameters  : System.Management.ManagementBaseObject
OutParameters : System.Management.ManagementBaseObject
Origin        : Win32_Process
Qualifiers    : &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;Constructor, Implemented, MappingStrings, Privileges...&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

Name          : Terminate
InParameters  : System.Management.ManagementBaseObject
OutParameters : System.Management.ManagementBaseObject
Origin        : Win32_Process
Qualifiers    : &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;Destructor, Implemented, MappingStrings, Privileges...&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

Name          : GetOwner
InParameters  :
OutParameters : System.Management.ManagementBaseObject
Origin        : Win32_Process
Qualifiers    : &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;Implemented, MappingStrings, ValueMap&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

Name          : GetOwnerSid
InParameters  :
OutParameters : System.Management.ManagementBaseObject
Origin        : Win32_Process
Qualifiers    : &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;Implemented, MappingStrings, ValueMap&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

Name          : SetPriority
InParameters  : System.Management.ManagementBaseObject
OutParameters : System.Management.ManagementBaseObject
Origin        : Win32_Process
Qualifiers    : &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;Implemented, MappingStrings, ValueMap&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

Name          : AttachDebugger
InParameters  :
OutParameters : System.Management.ManagementBaseObject
Origin        : Win32_Process
Qualifiers    : &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;Implemented, ValueMap&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

Name          : GetAvailableVirtualSize
InParameters  :
OutParameters : System.Management.ManagementBaseObject
Origin        : Win32_Process
Qualifiers    : &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;Implemented, ValueMap&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;위 출력결과를 보면 &lt;code class=&quot;highlighter-rouge&quot;&gt;Create, Terminate, GetOwner, GetOwnerSid, SetPriority, AttachDebugger, GetAvailableVirtualSize&lt;/code&gt;를 사용할 수 있다.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Invoke-WmiMethod&lt;/code&gt; 명령어를 통해서 notepad.exe를 실행해보자.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Invoke-WmiMethod -Class Win32_Process -Name Create -ArgumentList &quot;notepad.exe&quot;&lt;/code&gt;를 입력해 보자.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;INDOWS&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;ystem32&amp;gt; Invoke-WmiMethod -Class Win32_Process -Name Create -ArgumentList &lt;span class=&quot;s2&quot;&gt;&quot;notepad.exe&quot;&lt;/span&gt;


__GENUS          : 2
__CLASS          : __PARAMETERS
__SUPERCLASS     :
__DYNASTY        : __PARAMETERS
__RELPATH        :
__PROPERTY_COUNT : 2
__DERIVATION     : &lt;span class=&quot;o&quot;&gt;{}&lt;/span&gt;
__SERVER         :
__NAMESPACE      :
__PATH           :
ProcessId        : 2940
ReturnValue      : 0
PSComputerName   :&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Invoke-WmiMethod&lt;/code&gt; 또한 Win7에 notepad.exe를 실행할 수 있다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;INDOWS&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;ystem32&amp;gt; Invoke-WmiMethod -Class Win32_Process -Name Create -ArgumentList &lt;span class=&quot;s2&quot;&gt;&quot;notepad.exe&quot;&lt;/span&gt; -ComputerName WIN-J9KO348JQVU -Credential k3y6reak


__GENUS          : 2
__CLASS          : __PARAMETERS
__SUPERCLASS     :
__DYNASTY        : __PARAMETERS
__RELPATH        :
__PROPERTY_COUNT : 2
__DERIVATION     : &lt;span class=&quot;o&quot;&gt;{}&lt;/span&gt;
__SERVER         :
__NAMESPACE      :
__PATH           :
ProcessId        : 2420
ReturnValue      : 0
PSComputerName   :&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;실행 결과를 보면 실행이 된 것을 볼 수 있는데 실제 Win7에서 확인해보면 실행되지 않는다.&lt;/p&gt;

&lt;p&gt;실행시킬 수 있는 방법에 대해서 알아봐야겠다.&lt;/p&gt;

</description>
        <pubDate>Mon, 04 Sep 2017 20:01:00 +0900</pubDate>
        <link>http://localhost:4000/technique/2017/09/04/WMI/</link>
        <guid isPermaLink="true">http://localhost:4000/technique/2017/09/04/WMI/</guid>
        
        <category>powershell</category>
        
        
        <category>technique</category>
        
      </item>
    
      <item>
        <title>Jobs</title>
        <description>&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;job&lt;/code&gt;은 PowerShell에서 사용되는 것으로 &lt;code class=&quot;highlighter-rouge&quot;&gt;Background&lt;/code&gt;로 실행하는 것을 말합니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&amp;gt; Help &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;job&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;

Remove-Job                        Cmdlet    Microsoft.PowerShell.Core Deletes a Windows PowerShell background job.
&lt;span class=&quot;nb&quot;&gt;Start&lt;/span&gt;-Job                         Cmdlet    Microsoft.PowerShell.Core Starts a Windows PowerShell background job.
Stop-Job                          Cmdlet    Microsoft.PowerShell.Core Stops a Windows PowerShell background job.
Wait-Job                          Cmdlet    Microsoft.PowerShell.Core Suppresses the &lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;prompt &lt;span class=&quot;k&quot;&gt;until &lt;/span&gt;one or all of the Windows PowerShell background &lt;span class=&quot;nb&quot;&gt;jobs &lt;/span&gt;running &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;the session are completed.
Resume-Job                        Cmdlet    Microsoft.PowerShell.Core Restarts a suspended job.
Suspend-Job                       Cmdlet    Microsoft.PowerShell.Core Temporarily stops &lt;span class=&quot;k&quot;&gt;workflow &lt;/span&gt;jobs.
Add-JobTrigger                    Cmdlet    PSScheduledJob            Adds job triggers to scheduled jobs.
Disable-JobTrigger                Cmdlet    PSScheduledJob            Disables the job triggers of scheduled jobs.
Disable-ScheduledJob              Cmdlet    PSScheduledJob            Disables a scheduled job.
Enable-JobTrigger                 Cmdlet    PSScheduledJob            Enables the job triggers of scheduled jobs.
Enable-ScheduledJob               Cmdlet    PSScheduledJob            Enables a scheduled job.
Get-JobTrigger                    Cmdlet    PSScheduledJob            Gets the job triggers of scheduled jobs.
Get-ScheduledJob                  Cmdlet    PSScheduledJob            Gets scheduled &lt;span class=&quot;nb&quot;&gt;jobs &lt;/span&gt;on the &lt;span class=&quot;nb&quot;&gt;local &lt;/span&gt;computer.
Get-ScheduledJobOption            Cmdlet    PSScheduledJob            Gets the job options of scheduled jobs.
New-JobTrigger                    Cmdlet    PSScheduledJob            Creates a job trigger &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;a scheduled job.
New-ScheduledJobOption            Cmdlet    PSScheduledJob            Creates an &lt;span class=&quot;kt&quot;&gt;object &lt;/span&gt;that contains advanced options &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;a scheduled job.
Register-ScheduledJob             Cmdlet    PSScheduledJob            Creates a scheduled job.
Remove-JobTrigger                 Cmdlet    PSScheduledJob            Delete job triggers &lt;span class=&quot;k&quot;&gt;from &lt;/span&gt;scheduled jobs.
&lt;span class=&quot;nb&quot;&gt;Set&lt;/span&gt;-JobTrigger                    Cmdlet    PSScheduledJob            Changes the job trigger of a scheduled job.
&lt;span class=&quot;nb&quot;&gt;Set&lt;/span&gt;-ScheduledJob                  Cmdlet    PSScheduledJob            Changes scheduled jobs.
&lt;span class=&quot;nb&quot;&gt;Set&lt;/span&gt;-ScheduledJobOption            Cmdlet    PSScheduledJob            Changes the job options of a scheduled job.
Unregister-ScheduledJob           Cmdlet    PSScheduledJob            Deletes scheduled &lt;span class=&quot;nb&quot;&gt;jobs &lt;/span&gt;on the &lt;span class=&quot;nb&quot;&gt;local &lt;/span&gt;computer.
Resume-PrintJob                   &lt;span class=&quot;k&quot;&gt;Function  &lt;/span&gt;PrintManagement           ...
Suspend-PrintJob                  &lt;span class=&quot;k&quot;&gt;Function  &lt;/span&gt;PrintManagement           ...
Restart-PrintJob                  &lt;span class=&quot;k&quot;&gt;Function  &lt;/span&gt;PrintManagement           ...
Get-PrintJob                      &lt;span class=&quot;k&quot;&gt;Function  &lt;/span&gt;PrintManagement           ...
Remove-PrintJob                   &lt;span class=&quot;k&quot;&gt;Function  &lt;/span&gt;PrintManagement           ...
Stop-StorageJob                   &lt;span class=&quot;k&quot;&gt;Function  &lt;/span&gt;Storage                   ...
Get-StorageJob                    &lt;span class=&quot;k&quot;&gt;Function  &lt;/span&gt;Storage                   ...
about_Jobs                        HelpFile                            Provides information about how Windows PowerShell background &lt;span class=&quot;nb&quot;&gt;jobs &lt;/span&gt;run a
about_Job_Details                 HelpFile                            Provides details about background &lt;span class=&quot;nb&quot;&gt;jobs &lt;/span&gt;on &lt;span class=&quot;nb&quot;&gt;local &lt;/span&gt;and remote computers.
about_Remote_Jobs                 HelpFile                            Describes how to run background &lt;span class=&quot;nb&quot;&gt;jobs &lt;/span&gt;on remote computers.
about_Scheduled_Jobs              HelpFile                            Describes scheduled &lt;span class=&quot;nb&quot;&gt;jobs &lt;/span&gt;and explains how to use and manage
about_Scheduled_Jobs_Advanced     HelpFile                            Explains advanced scheduled job topics, including the file structure
about_Scheduled_Jobs_Basics       HelpFile                            Explains how to create and manage scheduled jobs.
about_Scheduled_Jobs_Troublesh... HelpFile                            Explains how to resolve problems with scheduled &lt;span class=&quot;nb&quot;&gt;jobs
&lt;/span&gt;about_Scheduled_Jobs              HelpFile                            Describes scheduled &lt;span class=&quot;nb&quot;&gt;jobs &lt;/span&gt;and explains how to use and manage
about_Scheduled_Jobs_Advanced     HelpFile                            Explains advanced scheduled job topics, including the file structure
about_Scheduled_Jobs_Basics       HelpFile                            Explains how to create and manage scheduled jobs.
about_Scheduled_Jobs_Troublesh... HelpFile                            Explains how to resolve problems with scheduled &lt;span class=&quot;nb&quot;&gt;jobs&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Job&lt;/code&gt;에 관한 내용을 찾아보면 &lt;code class=&quot;highlighter-rouge&quot;&gt;Start-Job&lt;/code&gt; 명령어가 있는데 이 명령어를 통해서 실행할 수 있습니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;INDOWS&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;ystem32&amp;gt; &lt;span class=&quot;nb&quot;&gt;Start&lt;/span&gt;-Job -ScriptBlock &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;whoami&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

Id     Name            PSJobTypeName   State         HasMoreData     Location             Command
--     ----            -------------   -----         -----------     --------             -------
1      Job1            BackgroundJob   Running       True            localhost            whoami&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Background&lt;/code&gt; 상태로 &lt;code class=&quot;highlighter-rouge&quot;&gt;whoami&lt;/code&gt;명령이 실행된 것을 볼 수 있습니다. 해당 명령의 실행결과를 출력하고자 할 때는 &lt;code class=&quot;highlighter-rouge&quot;&gt;Receive-Job&lt;/code&gt;을 이용하면 됩니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;INDOWS&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;ystem32&amp;gt; Get-Job -Id 1 | Receive-Job
k3y6reak9778&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;이번에는 &lt;code class=&quot;highlighter-rouge&quot;&gt;Windows7&lt;/code&gt;에서 Job을 실행시킨 후 해당 결과를 출력해 보도록 하겠습니다.
&lt;code class=&quot;highlighter-rouge&quot;&gt;$se&lt;/code&gt;라는 변수를 이용하고 &lt;code class=&quot;highlighter-rouge&quot;&gt;PSSession&lt;/code&gt;을 이용해야 합니다.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;$se = New-PSSession -ComputerName [Windows7 컴퓨터 이름] -Credential [Windows7 계정]&lt;/code&gt;을 입력합니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;INDOWS&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;ystem32&amp;gt; &lt;span class=&quot;nv&quot;&gt;$se&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; New-PSSession -ComputerName WIN-J9KO348JQVU -Credential k3y6reak
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;INDOWS&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;ystem32&amp;gt; Invoke-Command -ScriptBlock &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;Start&lt;/span&gt;-Job -ScriptBlock &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ps&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;}}&lt;/span&gt; -Session &lt;span class=&quot;nv&quot;&gt;$se&lt;/span&gt;

Id     Name            PSJobTypeName   State         HasMoreData     Location             Command                   PSComputerName
--     ----            -------------   -----         -----------     --------             -------                   --------------
1      Job1                            Running       True            localhost            &lt;span class=&quot;nb&quot;&gt;ps                        &lt;/span&gt;WIN-J9KO348JQVU&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;그리고 &lt;code class=&quot;highlighter-rouge&quot;&gt;Invoke-Command -ScriptBlock { Get-Job | Receive-Job } -Session $se&lt;/code&gt;를 입력하면 Windows7에서 실행되는 프로세스의 목록을 가져올 수 있습니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;INDOWS&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;ystem32&amp;gt; Invoke-Command -ScriptBlock &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; Get-Job | Receive-Job &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; -Session &lt;span class=&quot;nv&quot;&gt;$se&lt;/span&gt;

Handles  NPM&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;K&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;    PM&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;K&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;      WS&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;K&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;     CPU&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;     Id  &lt;span class=&quot;nb&quot;&gt;SI &lt;/span&gt;ProcessName                                                                 PSComputerName
-------  ------    -----      -----     ------     --  -- -----------                                                                 --------------
     30       2      660       2256      0.000   3488     conhost                                                                     WIN-J9KO348JQVU
    538       6     1264       4224      6.552    332     csrss                                                                       WIN-J9KO348JQVU
    204       7     9900       7844     22.558    396     csrss                                                                       WIN-J9KO348JQVU
    188       8     2928       8648     11.560   1908     dllhost                                                                     WIN-J9KO348JQVU
    116       6    36584      35968  8,268.271   2208     dwm                                                                         WIN-J9KO348JQVU
    807      28    32868      59380     62.166   2240     explorer                                                                    WIN-J9KO348JQVU
      0       0        0         24                 0     Idle                                                                        WIN-J9KO348JQVU
    622      10     2988       8188      5.257    500     lsass                                                                       WIN-J9KO348JQVU
    139       4     1216       3020      0.281    508     lsm                                                                         WIN-J9KO348JQVU
    143       9     2440       6252      0.265   2016     msdtc                                                                       WIN-J9KO348JQVU
    253      11    22232      32532      1.856   2748     powershell                                                                  WIN-J9KO348JQVU
    602      16    22056      25588      6.614   2536     SearchIndexer                                                               WIN-J9KO348JQVU
    208       7     3804       6736      9.656    492     services                                                                    WIN-J9KO348JQVU
     29       1      220        736      0.343    256     smss                                                                        WIN-J9KO348JQVU
    323      12     5056      11128      0.499   1256     spoolsv                                                                     WIN-J9KO348JQVU
    150       4     4228       8000     11.060   3240     sppsvc                                                                      WIN-J9KO348JQVU
    353       7     2688       7004      2.371    600     svchost                                                                     WIN-J9KO348JQVU
    265       9     2684       6100      1.654    700     svchost                                                                     WIN-J9KO348JQVU
    528      14    14144      14924      9.656    748     svchost                                                                     WIN-J9KO348JQVU
    343       9     2932       8364      2.293    848     svchost                                                                     WIN-J9KO348JQVU
    972      26    13888      25536     47.284    892     svchost                                                                     WIN-J9KO348JQVU
    814      19     7412      14292     16.505   1036     svchost                                                                     WIN-J9KO348JQVU
    454      18     9064      12392     23.369   1160     svchost                                                                     WIN-J9KO348JQVU
    304      25     8100       9572      2.418   1292     svchost                                                                     WIN-J9KO348JQVU
     97       7     1196       4272      0.187   1808     svchost                                                                     WIN-J9KO348JQVU
    285      13     4120       8752      7.301   2752     svchost                                                                     WIN-J9KO348JQVU
    348      35   145304      38772     20.967   3276     svchost                                                                     WIN-J9KO348JQVU
    525       0       44       1000                 4     System                                                                      WIN-J9KO348JQVU
    200      10     6784       7512      0.686   2152     taskhost                                                                    WIN-J9KO348JQVU
     85       5     4960       8936      0.250   1440     VGAuthService                                                               WIN-J9KO348JQVU
     53       3      816       3232      0.078    660     vmacthlp                                                                    WIN-J9KO348JQVU
    288      12     9316      16732    837.429   1492     vmtoolsd                                                                    WIN-J9KO348JQVU
    175       9     6904      15524    220.117   2340     vmtoolsd                                                                    WIN-J9KO348JQVU
     78       5      984       3764      0.359    384     wininit                                                                     WIN-J9KO348JQVU
    115       4     1656       5116      0.671    432     winlogon                                                                    WIN-J9KO348JQVU
    202       7     7184      11924     24.383    376     WmiPrvSE                                                                    WIN-J9KO348JQVU
    238       8     3636       4360     14.134   2624     wmpnetwk                                                                    WIN-J9KO348JQVU
    266      12    21748      31724      0.530   1144     wsmprovhost                                                                 WIN-J9KO348JQVU&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
</description>
        <pubDate>Fri, 01 Sep 2017 10:34:00 +0900</pubDate>
        <link>http://localhost:4000/technique/2017/09/01/jobs/</link>
        <guid isPermaLink="true">http://localhost:4000/technique/2017/09/01/jobs/</guid>
        
        <category>powershell</category>
        
        
        <category>technique</category>
        
      </item>
    
      <item>
        <title>Remote</title>
        <description>&lt;p&gt;PowerShell을 이용해서 다른 컴퓨터의 정보를 가져올 수 있습니다. &lt;code class=&quot;highlighter-rouge&quot;&gt;Get-Help *remote*&lt;/code&gt;를 입력합니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;INDOWS&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;ystem32&amp;gt; &lt;span class=&quot;nb&quot;&gt;Get-Help&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;remote&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;

Name                              Category  Module                    Synopsis
----                              --------  ------                    --------
Enable-VMRemoteFXPhysicalVideo... Cmdlet    Hyper-V                   Enable-VMRemoteFXPhysicalVideoAdapter...
Add-VMRemoteFx3dVideoAdapter      Cmdlet    Hyper-V                   Add-VMRemoteFx3dVideoAdapter...
Remove-VMRemoteFx3dVideoAdapter   Cmdlet    Hyper-V                   Remove-VMRemoteFx3dVideoAdapter...
&lt;span class=&quot;nb&quot;&gt;Set&lt;/span&gt;-VMRemoteFx3dVideoAdapter      Cmdlet    Hyper-V                   &lt;span class=&quot;nb&quot;&gt;Set&lt;/span&gt;-VMRemoteFx3dVideoAdapter...
Get-VMRemoteFXPhysicalVideoAda... Cmdlet    Hyper-V                   Get-VMRemoteFXPhysicalVideoAdapter...
Disable-VMRemoteFXPhysicalVide... Cmdlet    Hyper-V                   Disable-VMRemoteFXPhysicalVideoAdapter...
Get-VMRemoteFx3dVideoAdapter      Cmdlet    Hyper-V                   Get-VMRemoteFx3dVideoAdapter...
about_Remote                      HelpFile                            Describes how to run remote commands &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;Windows PowerShell.
about_Remote_Disconnected_Sess... HelpFile                            Explains how to disconnect &lt;span class=&quot;k&quot;&gt;from &lt;/span&gt;and reconnect to a PSSession
about_Remote_FAQ                  HelpFile                            Contains questions and answers about running remote commands
about_Remote_Jobs                 HelpFile                            Describes how to run background &lt;span class=&quot;nb&quot;&gt;jobs &lt;/span&gt;on remote computers.
about_Remote_Output               HelpFile                            Describes how to interpret and format the output of remote commands.
about_Remote_Requirements         HelpFile                            Describes the system requirements and configuration requirements &lt;span class=&quot;k&quot;&gt;for
&lt;/span&gt;about_Remote_Troubleshooting      HelpFile                            Describes how to troubleshoot remote operations &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;Windows PowerShell.
about_Remote_Variables            HelpFile                            Explains how to use &lt;span class=&quot;nb&quot;&gt;local &lt;/span&gt;and remote variables &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;remote&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;cmdlet에서 인자 값으로 &lt;code class=&quot;highlighter-rouge&quot;&gt;computername&lt;/code&gt;을 사용하는 명령어를 찾아봅시다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;INDOWS&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;ystem32&amp;gt; &lt;span class=&quot;nb&quot;&gt;Get-Command&lt;/span&gt; -CommandType cmdlet -ParameterName Computername

CommandType     Name                                               Version    Source
-----------     ----                                               -------    ------
Cmdlet          Add-Computer                                       3.1.0.0    Microsoft.PowerShell.Management
Cmdlet          &lt;span class=&quot;nb&quot;&gt;Clear&lt;/span&gt;-EventLog                                     3.1.0.0    Microsoft.PowerShell.Management
Cmdlet          Connect-PSSession                                  3.0.0.0    Microsoft.PowerShell.Core
Cmdlet          Connect-WSMan                                      3.0.0.0    Microsoft.WSMan.Management
Cmdlet          Disconnect-WSMan                                   3.0.0.0    Microsoft.WSMan.Management
Cmdlet          Enter-PSSession                                    3.0.0.0    Microsoft.PowerShell.Core
Cmdlet          &lt;span class=&quot;nb&quot;&gt;Get-EventLog                                       &lt;/span&gt;3.1.0.0    Microsoft.PowerShell.Management
Cmdlet          Get-HotFix                                         3.1.0.0    Microsoft.PowerShell.Management
Cmdlet          &lt;span class=&quot;nb&quot;&gt;Get-Process                                        &lt;/span&gt;3.1.0.0    Microsoft.PowerShell.Management
Cmdlet          Get-PSSession                                      3.0.0.0    Microsoft.PowerShell.Core
Cmdlet          &lt;span class=&quot;nb&quot;&gt;Get-Service                                        &lt;/span&gt;3.1.0.0    Microsoft.PowerShell.Management
Cmdlet          &lt;span class=&quot;nb&quot;&gt;Get-WmiObject                                      &lt;/span&gt;3.1.0.0    Microsoft.PowerShell.Management
Cmdlet          Get-WSManInstance                                  3.0.0.0    Microsoft.WSMan.Management
Cmdlet          Invoke-Command                                     3.0.0.0    Microsoft.PowerShell.Core
Cmdlet          Invoke-WmiMethod                                   3.1.0.0    Microsoft.PowerShell.Management
Cmdlet          Invoke-WSManAction                                 3.0.0.0    Microsoft.WSMan.Management
Cmdlet          Limit-EventLog                                     3.1.0.0    Microsoft.PowerShell.Management
Cmdlet          New-EventLog                                       3.1.0.0    Microsoft.PowerShell.Management
Cmdlet          New-PSSession                                      3.0.0.0    Microsoft.PowerShell.Core
Cmdlet          New-WSManInstance                                  3.0.0.0    Microsoft.WSMan.Management
Cmdlet          Receive-Job                                        3.0.0.0    Microsoft.PowerShell.Core
Cmdlet          Receive-PSSession                                  3.0.0.0    Microsoft.PowerShell.Core
Cmdlet          Register-WmiEvent                                  3.1.0.0    Microsoft.PowerShell.Management
Cmdlet          Remove-Computer                                    3.1.0.0    Microsoft.PowerShell.Management
Cmdlet          Remove-EventLog                                    3.1.0.0    Microsoft.PowerShell.Management
Cmdlet          Remove-PSSession                                   3.0.0.0    Microsoft.PowerShell.Core
Cmdlet          Remove-WmiObject                                   3.1.0.0    Microsoft.PowerShell.Management
Cmdlet          Remove-WSManInstance                               3.0.0.0    Microsoft.WSMan.Management
Cmdlet          Rename-Computer                                    3.1.0.0    Microsoft.PowerShell.Management
Cmdlet          Restart-Computer                                   3.1.0.0    Microsoft.PowerShell.Management
Cmdlet          Send-MailMessage                                   3.1.0.0    Microsoft.PowerShell.Utility
Cmdlet          &lt;span class=&quot;nb&quot;&gt;Set-Service                                        &lt;/span&gt;3.1.0.0    Microsoft.PowerShell.Management
Cmdlet          &lt;span class=&quot;nb&quot;&gt;Set&lt;/span&gt;-WmiInstance                                    3.1.0.0    Microsoft.PowerShell.Management
Cmdlet          &lt;span class=&quot;nb&quot;&gt;Set&lt;/span&gt;-WSManInstance                                  3.0.0.0    Microsoft.WSMan.Management
Cmdlet          Show-EventLog                                      3.1.0.0    Microsoft.PowerShell.Management
Cmdlet          Stop-Computer                                      3.1.0.0    Microsoft.PowerShell.Management
Cmdlet          Test-Connection                                    3.1.0.0    Microsoft.PowerShell.Management
Cmdlet          Test-WSMan                                         3.0.0.0    Microsoft.WSMan.Management
Cmdlet          &lt;span class=&quot;nb&quot;&gt;Write&lt;/span&gt;-EventLog                                     3.1.0.0    Microsoft.PowerShell.Management&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;여기서 현재 컴퓨터의 HotFix 내용을 알고 싶다면 &lt;code class=&quot;highlighter-rouge&quot;&gt;Get-HotFix&lt;/code&gt;를 입력하면 결과가 나타납니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;INDOWS&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;ystem32&amp;gt; Get-HotFix

Source        Description      HotFixID      InstalledBy          InstalledOn
------        -----------      --------      -----------          -----------
K3Y6REAK9778  Update           KB4022405     NT AUTHORITY&lt;span class=&quot;se&quot;&gt;\S&lt;/span&gt;YSTEM  2017. 8. 7. 오전 12:00:00
K3Y6REAK9778  Security Update  KB4034662     NT AUTHORITY&lt;span class=&quot;se&quot;&gt;\S&lt;/span&gt;YSTEM  2017. 8. 9. 오전 12:00:00
K3Y6REAK9778  Security Update  KB4034674     NT AUTHORITY&lt;span class=&quot;se&quot;&gt;\S&lt;/span&gt;YSTEM  2017. 8. 13. 오전 12:0...&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;windows 7&lt;/code&gt;에서 &lt;code class=&quot;highlighter-rouge&quot;&gt;windows 10&lt;/code&gt;의 HotFix 내용을 가져와 출력하는 방법을 알아보겠습니다.&lt;/p&gt;

&lt;p&gt;먼저 &lt;code class=&quot;highlighter-rouge&quot;&gt;windows 10&lt;/code&gt;에서 &lt;code class=&quot;highlighter-rouge&quot;&gt;Get-HotFix&lt;/code&gt;를 하면 아래와 같이 출력됩니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; Windows 10 &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
Source        Description      HotFixID      InstalledBy          InstalledOn
------        -----------      --------      -----------          -----------
K3Y6REAK9778  Update           KB4022405     NT AUTHORITY&lt;span class=&quot;se&quot;&gt;\S&lt;/span&gt;YSTEM  2017. 8. 7. 오전 12:00:00
K3Y6REAK9778  Security Update  KB4034662     NT AUTHORITY&lt;span class=&quot;se&quot;&gt;\S&lt;/span&gt;YSTEM  2017. 8. 9. 오전 12:00:00
K3Y6REAK9778  Security Update  KB4034674     NT AUTHORITY&lt;span class=&quot;se&quot;&gt;\S&lt;/span&gt;YSTEM  2017. 8. 13. 오전 12:0...&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;그리고 다른 컴퓨터에서 원격으로 가져오는 것이기 때문에 &lt;code class=&quot;highlighter-rouge&quot;&gt;관리자 권한&lt;/code&gt;에서 &lt;code class=&quot;highlighter-rouge&quot;&gt;Set-Item WSMAN:\localhost\client\trustedhosts -Value *&lt;/code&gt;를 입력한 뒤 명령을 실행합니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;INDOWS&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;ystem32&amp;gt; &lt;span class=&quot;nb&quot;&gt;Set-Item &lt;/span&gt;WSMAN:&lt;span class=&quot;se&quot;&gt;\l&lt;/span&gt;ocalhost&lt;span class=&quot;se&quot;&gt;\c&lt;/span&gt;lient&lt;span class=&quot;se&quot;&gt;\t&lt;/span&gt;rustedhosts -Value &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;

WinRM 보안 구성
이 명령에서 WinRM 클라이언트에 대한 TrustedHosts 목록을 수정합니다. TrustedHosts 목록에 있는 컴퓨터가 인증되지 않을 수 있으며 클라이언트에서 자격 증명 정보를 이러한 컴퓨터에 보낼 수도 있습니다. 이 목록을
수정하시겠습니까?
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Y] 예&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Y&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;N] 아니요&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;N&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;S] 일시 중단&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;S&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;?] 도움말 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;기본값은 &lt;span class=&quot;s2&quot;&gt;&quot;Y&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: Y&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;windows 7&lt;/code&gt;에서 &lt;code class=&quot;highlighter-rouge&quot;&gt;Get-HotFix -Computername [Windows 10 Computer 이름] -Credential [Windows 10 계정]&lt;/code&gt;를 입력해 줍니다. 그러면 &lt;code class=&quot;highlighter-rouge&quot;&gt;자격 증명 요청&lt;/code&gt;이 나오면 해당 명령어를 실행하는 계정의 비밀번호를 입력합니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; Windows 7 &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; Get-HotFix -Computername &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Windows 10 Computer 이름] -Credential &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Windows 10 계정]

Source        Description      HotFixID      InstalledBy          InstalledOn
------        -----------      --------      -----------          -----------
K3Y6REAK9778  Update           KB4022405     NT AUTHORITY&lt;span class=&quot;se&quot;&gt;\S&lt;/span&gt;YSTEM  2017-08-07 오전 12:00:00
K3Y6REAK9778  Security Update  KB4034662     NT AUTHORITY&lt;span class=&quot;se&quot;&gt;\S&lt;/span&gt;YSTEM  2017-08-09 오전 12:00:00
K3Y6REAK9778  Security Update  KB4034674     NT AUTHORITY&lt;span class=&quot;se&quot;&gt;\S&lt;/span&gt;YSTEM  2017-08-13 오전 12:00:00&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;반대로 &lt;code class=&quot;highlighter-rouge&quot;&gt;Windows 10&lt;/code&gt;에서 &lt;code class=&quot;highlighter-rouge&quot;&gt;Windows 7&lt;/code&gt;의 실행되고 있는 프로세스 목록을 가져오도록 하겠습니다.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Invoke-Command -ScriptBlock {Get-Process} -ComputerName [Windows 7 Computer 이름] -Credential [Windows 7 계정]&lt;/code&gt;를 입력합니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; Windows 10 &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;INDOWS&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;ystem32&amp;gt; Invoke-Command -ScriptBlock &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$env&lt;/span&gt;:computername&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; -ComputerName WIN-J9KO348JQVU -Credential k3y6reak
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;WIN-J9KO348JQVU] 다음 오류 때문에 원격 서버 WIN-J9KO348JQVU에 연결하지 못했습니다. 클라이언트가 요청에 지정된 대상에 연결할 수 없습니다. 대상에서 서비스가 실행되고 요청을 수락하고 있는지 확인하십시오. 대상에서
 실행 중인 WS-Management 서비스에 대한 로그 및 설명서를 참조하십시오. 대부분의 경우 IIS 또는 WinRM입니다. 대상이 WinRM 서비스인 경우 대상에서 &lt;span class=&quot;s2&quot;&gt;&quot;winrm quickconfig&quot;&lt;/span&gt; 명령을 사용하여 WinRM 서비스를 분석하고 구성하십
시오. 자세한 내용은 about_Remote_Troubleshooting 도움말 항목을 참조하십시오.
    + CategoryInfo          : OpenError: &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;WIN-J9KO348JQVU:String&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt;, PSRemotingTransportException
    + FullyQualifiedErrorId : CannotConnect,PSSessionStateBroken&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;위와 같은 에러 메시지가 출력된다면 Windows 7에서 &lt;code class=&quot;highlighter-rouge&quot;&gt;관리자 권한&lt;/code&gt;으로 PowerShell을 실행시킨 후 &lt;code class=&quot;highlighter-rouge&quot;&gt;Enable-PSRemoting -force&lt;/code&gt;를 입력합니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; Windows 7 &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;indows&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;ystem32&amp;gt; Enable-PSRemoting -force
이 컴퓨터에서 요청을 수신하도록 WinRM이 이미 설정되었습니다.
원격 관리를 위한 WinRM이 업데이트되었습니다.
이 컴퓨터에서 모든 IP 주소로 WS-Man 요청을 수락하려면 HTTP://&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;에서 WinRM 수신기를 만드십시오.
WinRM 방화벽 예외를 사용합니다.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;그 후 다시 &lt;code class=&quot;highlighter-rouge&quot;&gt;Invoke-Command -ScriptBlock {Get-Process} -ComputerName WIN-J9KO348JQVU -Credential k3y6reak&lt;/code&gt;를 입력합니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; Windows 10 &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;INDOWS&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;ystem32&amp;gt; Invoke-Command -ScriptBlock &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;Get-Process&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; -ComputerName &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Windows 7 Computer 이름] -Credential &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Windows 7 계정]

Handles  NPM&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;K&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;    PM&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;K&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;      WS&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;K&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;     CPU&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;     Id  &lt;span class=&quot;nb&quot;&gt;SI &lt;/span&gt;ProcessName                                                                  PSComputerName
-------  ------    -----      -----     ------     --  -- -----------                                                                  --------------
    126       5    14996      13952              2504     audiodg                                                                      WIN-J9KO348JQVU
     89       5     4328      10484      0.530   1572     conhost                                                                      WIN-J9KO348JQVU
     89       5     4292      10356      0.047   3980     conhost                                                                      WIN-J9KO348JQVU
    579       6     1288       3012      1.076    360     csrss                                                                        WIN-J9KO348JQVU
    257       8     9716       7684     11.934   3336     csrss                                                                        WIN-J9KO348JQVU
     83       4      912       3624      0.031   1916     dllhost                                                                      WIN-J9KO348JQVU
    188       8     3076       9080      0.031   3128     dllhost                                                                      WIN-J9KO348JQVU
    116       6    42392      49896      1.404   3608     dwm                                                                          WIN-J9KO348JQVU
    840      27    30936      61676     13.416   3620     explorer                                                                     WIN-J9KO348JQVU
      0       0        0         24                 0     Idle                                                                         WIN-J9KO348JQVU
    881      10     2952       6820      3.697    508     lsass                                                                        WIN-J9KO348JQVU
    144       4     1264       2112      0.000    516     lsm                                                                          WIN-J9KO348JQVU
    146       9     2400       3392      1.170   2188     msdtc                                                                        WIN-J9KO348JQVU
    688      50    33608      43892      0.780    492     powershell                                                                   WIN-J9KO348JQVU
    600      15    27680      46684      0.905    856     powershell                                                                   WIN-J9KO348JQVU
    764      18    22384      23768      4.711   1864     SearchIndexer                                                                WIN-J9KO348JQVU
    212       7     3792       6352      2.558    500     services                                                                     WIN-J9KO348JQVU
     29       1      220        528      0.156    280     smss                                                                         WIN-J9KO348JQVU
    325      12     5036       5032      0.936   1408     spoolsv                                                                      WIN-J9KO348JQVU
    152       4     6100       7480      2.933   3152     sppsvc                                                                       WIN-J9KO348JQVU
    100       7     1192       4244      0.062    352     svchost                                                                      WIN-J9KO348JQVU
    371       7     3252       6096     14.539    652     svchost                                                                      WIN-J9KO348JQVU
    298       9     2968       5904      0.733    744     svchost                                                                      WIN-J9KO348JQVU
    536      14    14200      12192      1.872    796     svchost                                                                      WIN-J9KO348JQVU
    364      10     3232       5308      7.457    916     svchost                                                                      WIN-J9KO348JQVU
   1206      31    21624      32616     45.318    960     svchost                                                                      WIN-J9KO348JQVU
    820      21     6752      12672      1.248   1104     svchost                                                                      WIN-J9KO348JQVU
    658      75    57968      33608      4.524   1176     svchost                                                                      WIN-J9KO348JQVU
    333      25     9308       8308      0.920   1468     svchost                                                                      WIN-J9KO348JQVU
    280      13     3908       7924      0.312   3064     svchost                                                                      WIN-J9KO348JQVU
    368      35   149724      58524    181.273   3188     svchost                                                                      WIN-J9KO348JQVU
    541       0       48       1076                 4     System                                                                       WIN-J9KO348JQVU
    214      10     6772       6664      1.201   3560     taskhost                                                                     WIN-J9KO348JQVU
     85       5     4960       2788      0.234   1752     VGAuthService                                                                WIN-J9KO348JQVU
     54       3      824       1952      0.031    712     vmacthlp                                                                     WIN-J9KO348JQVU
    286      12     8268       8920     29.578   1812     vmtoolsd                                                                     WIN-J9KO348JQVU
    210      10     8064      12108     20.389   3724     vmtoolsd                                                                     WIN-J9KO348JQVU
     76       5      988       1832      0.452    412     wininit                                                                      WIN-J9KO348JQVU
    117       5     1724       3628      0.452   3360     winlogon                                                                     WIN-J9KO348JQVU
    203       7     7328      10260      4.930    860     WmiPrvSE                                                                     WIN-J9KO348JQVU
    207       7     2628       3580      0.265   3424     wmpnetwk                                                                     WIN-J9KO348JQVU
    218      11    23216      32516      4.992   2392     wsmprovhost                                                                  WIN-J9KO348JQVU&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;이렇게 다른 컴퓨터의 정보를 가져올 수 있습니다. 또한 SSH 처럼 사용할 수 있는데, &lt;code class=&quot;highlighter-rouge&quot;&gt;PSSession&lt;/code&gt;을 사용합니다.&lt;/p&gt;

&lt;p&gt;먼저 새로운 PSSession을 만들어야 합니다. &lt;code class=&quot;highlighter-rouge&quot;&gt;New-PSSession&lt;/code&gt;명령어를 사용합니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;INDOWS&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;ystem32&amp;gt; New-PSSession -ComputerName WIN-J9KO348JQVU -Credential k3y6reak

 Id Name            ComputerName    ComputerType    State         ConfigurationName     Availability
 -- ----            ------------    ------------    -----         -----------------     ------------
  1 WinRM1          WIN-J9KO348JQVU RemoteMachine   Opened        Microsoft.PowerShell     Available&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;위와 같이 연결이 된 후에 &lt;code class=&quot;highlighter-rouge&quot;&gt;Enter-PSSession&lt;/code&gt;을 이용하여 접속합니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;INDOWS&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;ystem32&amp;gt; Enter-PSSession -id 1
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;WIN-J9KO348JQVU]: &lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ocuments&amp;gt; &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;WIN-J9KO348JQVU]: &lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\&amp;gt;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;ls


    &lt;/span&gt;디렉터리: C:&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;


Mode                LastWriteTime     Length Name
----                -------------     ------ ----
d----        2009-07-14  오전 11:37            PerfLogs

d-r--        2017-08-25   오후 1:30            Program Files

d-r--        2017-08-30   오후 8:16            Users

d----        2017-08-25   오후 1:31            Windows

-a---        2009-06-11   오전 6:42         24 autoexec.bat

-a---        2009-06-11   오전 6:42         10 config.sys&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Enter-PSSession&lt;/code&gt;에서 &lt;code class=&quot;highlighter-rouge&quot;&gt;-id&lt;/code&gt; 옵션 값은 &lt;code class=&quot;highlighter-rouge&quot;&gt;New-PSSession&lt;/code&gt;을 통해서 만들어진 &lt;code class=&quot;highlighter-rouge&quot;&gt;Id&lt;/code&gt;값입니다.&lt;/p&gt;

</description>
        <pubDate>Thu, 31 Aug 2017 17:32:00 +0900</pubDate>
        <link>http://localhost:4000/technique/2017/08/31/remote/</link>
        <guid isPermaLink="true">http://localhost:4000/technique/2017/08/31/remote/</guid>
        
        <category>powershell</category>
        
        
        <category>technique</category>
        
      </item>
    
      <item>
        <title>Modules</title>
        <description>&lt;p&gt;PowerShell에서 Module에 관한 명령어를 알아보기 위해서 &lt;code class=&quot;highlighter-rouge&quot;&gt;Get-Help *module*&lt;/code&gt;을 입력합니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nb&quot;&gt;Get-Help&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;module&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;

Name                              Category  Module                    Synopsis
----                              --------  ------                    --------
ImportSystemModules               &lt;span class=&quot;k&quot;&gt;Function&lt;/span&gt;                            ...
Export-ModuleMember               Cmdlet    Microsoft.PowerShell.Core Specifies the module members that are exported.
Get-Module                        Cmdlet    Microsoft.PowerShell.Core Gets the modules that have been imported or that can be imported into the current session.
Import-Module                     Cmdlet    Microsoft.PowerShell.Core Adds modules to the current session.
New-Module                        Cmdlet    Microsoft.PowerShell.Core Creates a new dynamic module that exists only &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;memory.
New-ModuleManifest                Cmdlet    Microsoft.PowerShell.Core Creates a new module manifest.
Remove-Module                     Cmdlet    Microsoft.PowerShell.Core Removes modules &lt;span class=&quot;k&quot;&gt;from &lt;/span&gt;the current session.
Test-ModuleManifest               Cmdlet    Microsoft.PowerShell.Core Verifies that a module manifest file accurately describes the contents of a module.
InModuleScope                     &lt;span class=&quot;k&quot;&gt;Function  &lt;/span&gt;Pester                    ...
Uninstall-Module                  &lt;span class=&quot;k&quot;&gt;Function  &lt;/span&gt;PowerShellGet             ...
Install-Module                    &lt;span class=&quot;k&quot;&gt;Function  &lt;/span&gt;PowerShellGet             ...
Publish-Module                    &lt;span class=&quot;k&quot;&gt;Function  &lt;/span&gt;PowerShellGet             ...
Update-ModuleManifest             &lt;span class=&quot;k&quot;&gt;Function  &lt;/span&gt;PowerShellGet             ...
Save-Module                       &lt;span class=&quot;k&quot;&gt;Function  &lt;/span&gt;PowerShellGet             ...
Update-Module                     &lt;span class=&quot;k&quot;&gt;Function  &lt;/span&gt;PowerShellGet             ...
Get-InstalledModule               &lt;span class=&quot;k&quot;&gt;Function  &lt;/span&gt;PowerShellGet             ...
Find-Module                       &lt;span class=&quot;k&quot;&gt;Function  &lt;/span&gt;PowerShellGet             ...
about_Modules                     HelpFile                            Explains how to install, import, and use Windows PowerShell modules.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;주로 사용하게 될 명령어는 &lt;code class=&quot;highlighter-rouge&quot;&gt;Import-module&lt;/code&gt;과 &lt;code class=&quot;highlighter-rouge&quot;&gt;Remove-module&lt;/code&gt; 입니다. 모듈을 사용하고자 할 때는 Import-module을 사용하고 모듈을 해제 하고자할 때는 Remove-module을 사용합니다.&lt;/p&gt;

&lt;p&gt;PowerShell에서 모듈을 사용하기 위해서 &lt;code class=&quot;highlighter-rouge&quot;&gt;$env:PSModulePath&lt;/code&gt;를 입력합니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nv&quot;&gt;$env&lt;/span&gt;:PSModulePath
C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ocuments&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;indowsPowerShell&lt;span class=&quot;se&quot;&gt;\M&lt;/span&gt;odules;C:&lt;span class=&quot;se&quot;&gt;\P&lt;/span&gt;rogram Files&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;indowsPowerShell&lt;span class=&quot;se&quot;&gt;\M&lt;/span&gt;odules;C:&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;INDOWS&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;ystem32&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;indowsPowerShell&lt;span class=&quot;se&quot;&gt;\v&lt;/span&gt;1.0&lt;span class=&quot;se&quot;&gt;\M&lt;/span&gt;odules&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;위 결과를 보면 모듈에 대한 경로가 나타나게 된다. 여기서 &lt;code class=&quot;highlighter-rouge&quot;&gt;C:\Users\k3y6reak\Documents\WindowsPowerShell\Modules&lt;/code&gt;로 이동하면 WindowsPowerShell 폴더가 없다는 에러 메시지가 나타난다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ocuments&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;indowsPowerShell&lt;span class=&quot;se&quot;&gt;\M&lt;/span&gt;odules
&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; : &lt;span class=&quot;s1&quot;&gt;'C:\Users\k3y6reak\Documents\WindowsPowerShell\Modules'&lt;/span&gt; 경로는 존재하지 않으므로 찾을 수 없습니다.
위치 줄:1 문자:1
+ &lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ocuments&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;indowsPowerShell&lt;span class=&quot;se&quot;&gt;\M&lt;/span&gt;odules
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6re...erShell&lt;span class=&quot;se&quot;&gt;\M&lt;/span&gt;odules:String&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;Set-Location&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;, ItemNotFoundException
    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.SetLocationCommand

&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ocuments&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ocuments&amp;gt; mkdir WindowsPowerShell


    디렉터리: C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ocuments


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
d-----   2017. 8. 24.  오전 11:23                WindowsPowerShell


&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ocuments&amp;gt; &lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;WindowsPowerShell
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ocuments&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;indowsPowerShell&amp;gt; mkdir Modules


    디렉터리: C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ocuments&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;indowsPowerShell


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
d-----   2017. 8. 24.  오전 11:24                Modules&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;위와 같이 해당 디렉토리를 생성하고 &lt;code class=&quot;highlighter-rouge&quot;&gt;Modules 디렉토리&lt;/code&gt;에서 모듈을 저장하면 된다.&lt;/p&gt;

&lt;p&gt;그렇다면 PowerShell에서 사용하는 모듈을 한번 만들어 보겠습니다.&lt;/p&gt;

&lt;p&gt;PowerShell script는 &lt;code class=&quot;highlighter-rouge&quot;&gt;.ps1&lt;/code&gt; 확장자를 갖고있고, PowerShell module은 &lt;code class=&quot;highlighter-rouge&quot;&gt;.psm1&lt;/code&gt; 확장자를 갖고 있습니다.&lt;/p&gt;

&lt;p&gt;아래 &lt;code class=&quot;highlighter-rouge&quot;&gt;DelFile.psm1&lt;/code&gt; 코드를 작성합니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;k&quot;&gt;function &lt;/span&gt;DelFile
&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;CmdletBinding&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;SupportsShouldProcess&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$true&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;)]&lt;/span&gt; 
    &lt;span class=&quot;k&quot;&gt;param&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;([&lt;/span&gt;Parameter&lt;span class=&quot;o&quot;&gt;()]&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$FilePath&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;nb&quot;&gt;Write-Verbose&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Delete &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$FilePath&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$PSCmdlet&lt;/span&gt;.ShouldProcess&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$FilePath&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;, &lt;span class=&quot;s2&quot;&gt;&quot;Deleting File permanently&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;Remove-Item&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$FilePath&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ocuments&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;indowsPowerShell&lt;span class=&quot;se&quot;&gt;\M&lt;/span&gt;odules&amp;gt; &lt;span class=&quot;nb&quot;&gt;cp &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;elFile.psm1 .
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ocuments&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;indowsPowerShell&lt;span class=&quot;se&quot;&gt;\M&lt;/span&gt;odules&amp;gt; &lt;span class=&quot;nb&quot;&gt;ls


    &lt;/span&gt;디렉터리: C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ocuments&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;indowsPowerShell&lt;span class=&quot;se&quot;&gt;\M&lt;/span&gt;odules


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
-a----   2017. 8. 24.   오후 1:34            284 DelFile.psm1&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Modules 디렉토리에 DelFile.psm1을 복사합니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ocuments&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;indowsPowerShell&lt;span class=&quot;se&quot;&gt;\M&lt;/span&gt;odules&amp;gt; Import-Module .&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;elFile.psm1
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ocuments&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;indowsPowerShell&lt;span class=&quot;se&quot;&gt;\M&lt;/span&gt;odules&amp;gt; &lt;span class=&quot;nb&quot;&gt;Get-Command&lt;/span&gt; -Module DelFile

CommandType     Name                                               Version    Source
-----------     ----                                               -------    ------
&lt;span class=&quot;k&quot;&gt;Function        &lt;/span&gt;DelFile                                            0.0        DelFile


&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ocuments&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;indowsPowerShell&lt;span class=&quot;se&quot;&gt;\M&lt;/span&gt;odules&amp;gt; Get-Module

ModuleType Version    Name                                ExportedCommands
---------- -------    ----                                ----------------
Script     0.0        DelFile                             DelFile
Manifest   3.1.0.0    Microsoft.PowerShell.Management     &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;Add-Computer, &lt;span class=&quot;nb&quot;&gt;Add-Content&lt;/span&gt;, Checkpoint-Computer, &lt;span class=&quot;nb&quot;&gt;Clear&lt;/span&gt;-Content...&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
Manifest   3.1.0.0    Microsoft.PowerShell.Utility        &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;Add-Member&lt;/span&gt;, Add-Type, &lt;span class=&quot;nb&quot;&gt;Clear-Variable&lt;/span&gt;, &lt;span class=&quot;nb&quot;&gt;Compare&lt;/span&gt;-Object...&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
Script     1.2        PSReadline                          &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;Get-PSReadlineKeyHandler, Get-PSReadlineOption, Remove-PSReadlineKeyHandler, &lt;span class=&quot;nb&quot;&gt;Set&lt;/span&gt;-PSReadlineKeyHandler...&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Import-Module&lt;/code&gt;을 이용하여 모듈을 추가할 수 있고 &lt;code class=&quot;highlighter-rouge&quot;&gt;Get-Module&lt;/code&gt;을 이용하여 사용되는 모듈을 확인할 수 있습니다.&lt;/p&gt;

&lt;p&gt;해당 디렉토리에 &lt;code class=&quot;highlighter-rouge&quot;&gt;test.txt&lt;/code&gt;파일을 생성한 후 추가한 DelFile 모듈을 사용해 보겠습니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ocuments&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;indowsPowerShell&lt;span class=&quot;se&quot;&gt;\M&lt;/span&gt;odules&amp;gt; &lt;span class=&quot;nb&quot;&gt;ls


    &lt;/span&gt;디렉터리: C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ocuments&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;indowsPowerShell&lt;span class=&quot;se&quot;&gt;\M&lt;/span&gt;odules


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
-a----   2017. 8. 24.   오후 1:34            284 DelFile.psm1
-a----   2017. 8. 24.   오후 1:45              0 test.txt


&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ocuments&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;indowsPowerShell&lt;span class=&quot;se&quot;&gt;\M&lt;/span&gt;odules&amp;gt; DelFile C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ocuments&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;indowsPowerShell&lt;span class=&quot;se&quot;&gt;\M&lt;/span&gt;odules&lt;span class=&quot;se&quot;&gt;\t&lt;/span&gt;est.txt
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ocuments&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;indowsPowerShell&lt;span class=&quot;se&quot;&gt;\M&lt;/span&gt;odules&amp;gt; &lt;span class=&quot;nb&quot;&gt;ls


    &lt;/span&gt;디렉터리: C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ocuments&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;indowsPowerShell&lt;span class=&quot;se&quot;&gt;\M&lt;/span&gt;odules


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
-a----   2017. 8. 24.   오후 1:34            284 DelFile.psm1


&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ocuments&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;indowsPowerShell&lt;span class=&quot;se&quot;&gt;\M&lt;/span&gt;odules&amp;gt; Remove-Module DelFile
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ocuments&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;indowsPowerShell&lt;span class=&quot;se&quot;&gt;\M&lt;/span&gt;odules&amp;gt; Get-Module

ModuleType Version    Name                                ExportedCommands
---------- -------    ----                                ----------------
Manifest   3.1.0.0    Microsoft.PowerShell.Management     &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;Add-Computer, &lt;span class=&quot;nb&quot;&gt;Add-Content&lt;/span&gt;, Checkpoint-Computer, &lt;span class=&quot;nb&quot;&gt;Clear&lt;/span&gt;-Content...&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
Manifest   3.1.0.0    Microsoft.PowerShell.Utility        &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;Add-Member&lt;/span&gt;, Add-Type, &lt;span class=&quot;nb&quot;&gt;Clear-Variable&lt;/span&gt;, &lt;span class=&quot;nb&quot;&gt;Compare&lt;/span&gt;-Object...&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
Script     1.2        PSReadline                          &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;Get-PSReadlineKeyHandler, Get-PSReadlineOption, Remove-PSReadlineKeyHandler, &lt;span class=&quot;nb&quot;&gt;Set&lt;/span&gt;-PSReadlineKeyHandler...&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;DelFile 파일경로&lt;/code&gt;를 이용하여 test.txt가 삭제된 것을 확인할 수 있으며, 해당 모듈을 사용하지 않을 때는 &lt;code class=&quot;highlighter-rouge&quot;&gt;Remove-Module 모듈명&lt;/code&gt;을 이용해 제거할 수 있습니다.&lt;/p&gt;

</description>
        <pubDate>Tue, 22 Aug 2017 20:23:00 +0900</pubDate>
        <link>http://localhost:4000/technique/2017/08/22/modules/</link>
        <guid isPermaLink="true">http://localhost:4000/technique/2017/08/22/modules/</guid>
        
        <category>powershell</category>
        
        
        <category>technique</category>
        
      </item>
    
      <item>
        <title>Functions</title>
        <description>&lt;p&gt;PowerShell에서 함수를 사용하는 방법에 대해서 알아보겠습니다.&lt;/p&gt;

&lt;p&gt;먼저 스크립트를 작성할 때 &lt;code class=&quot;highlighter-rouge&quot;&gt;PowerShell ISE&lt;/code&gt;를 이용하여 작성하는 방법이 있고, 앞서 Execution Policy에서 설명한 것 처럼 &lt;code class=&quot;highlighter-rouge&quot;&gt;에디터&lt;/code&gt;를 이용하는 방법이 있습니다.&lt;/p&gt;

&lt;p&gt;PowerShell ISE에서 스크립트를 작성할 때 아래 그림의 &lt;code class=&quot;highlighter-rouge&quot;&gt;스크립트&lt;/code&gt;를 누른 후 스크립트를 작성할 수 있습니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/powershell/functions/powershell_ise.png&quot; alt=&quot;powershell_ise&quot; /&gt;&lt;/p&gt;

&lt;p&gt;마찬가지로 &lt;code class=&quot;highlighter-rouge&quot;&gt;관리자 권한&lt;/code&gt;에서 &lt;code class=&quot;highlighter-rouge&quot;&gt;Set-Execution Byass&lt;/code&gt;를 실행해야 스크립트를 실행할 수 있습니다.&lt;/p&gt;

&lt;p&gt;스크립트를 작성하는 방법에 대해서 알았으니 함수에 대해서 알아보겠습니다.&lt;/p&gt;

&lt;p&gt;PowerShell에서 함수를 작성하는 방법은 &lt;code class=&quot;highlighter-rouge&quot;&gt;function Name () {}&lt;/code&gt; 꼴로 작성합니다.&lt;/p&gt;

&lt;h4 id=&quot;dot-sourcing&quot;&gt;Dot Sourcing&lt;/h4&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;k&quot;&gt;function &lt;/span&gt;add&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
  1+3
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;위와 같이 코드를 작성한 후 ISE에서 실행을 하면 아래와 같이 에러가 발생합니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&amp;gt; .&lt;span class=&quot;se&quot;&gt;\a&lt;/span&gt;dd.ps1

&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&amp;gt; add
add : &lt;span class=&quot;s1&quot;&gt;'add'&lt;/span&gt; 용어가 cmdlet, 함수, 스크립트 파일 또는 실행할 수 있는 프로그램 이름으로 인식되지 않습니다. 이름이 정확한지 확인하고 경로
가 포함된 경우 경로가 올바른지 검증한 다음 다시 시도하십시오.
위치 줄:1 문자:1
+ add
+ ~~~
    + CategoryInfo          : ObjectNotFound: &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;add:String&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt;, CommandNotFoundExcept 
   ion
    + FullyQualifiedErrorId : CommandNotFoundException&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;스크립트 파일 자체를 실행하면 아무런 결과도 나오지 않고 함수명을 바로 호출하면 에러가 발생합니다.&lt;/p&gt;

&lt;p&gt;여기서 에러를 발생하지 않고 실행하는 방법이 &lt;code class=&quot;highlighter-rouge&quot;&gt;Dot Sourcing&lt;/code&gt;입니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&amp;gt; . .&lt;span class=&quot;se&quot;&gt;\a&lt;/span&gt;dd.ps1

&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&amp;gt; add
4&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Dot Sourcing&lt;/code&gt;은 위 코드를 살펴보면 실행하고자 스크립트 앞에 &lt;code class=&quot;highlighter-rouge&quot;&gt;.&lt;/code&gt;을 붙여 한 번 실행한 뒤 함수명으로 바로 실행이 가능하도록 하는 것 입니다.&lt;/p&gt;

&lt;p&gt;쉽게 말하면 &lt;code class=&quot;highlighter-rouge&quot;&gt;해당 스크립트의 내용을 현재 쉘에 로드해 둔 것&lt;/code&gt;이라 생각하면 됩니다.&lt;/p&gt;

&lt;p&gt;자 이제, 함수를 작성하는 방법은 알았으니 함수의 본질로 넘어가 보도록 하겠습니다.&lt;/p&gt;

&lt;p&gt;함수를 사용하는 건 &lt;code class=&quot;highlighter-rouge&quot;&gt;인자 값&lt;/code&gt;을 넘겨 &lt;code class=&quot;highlighter-rouge&quot;&gt;연산&lt;/code&gt;을 하는 것 입니다.&lt;/p&gt;

&lt;h4 id=&quot;parameter&quot;&gt;Parameter&lt;/h4&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;k&quot;&gt;function &lt;/span&gt;paramadd &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$num1&lt;/span&gt;, &lt;span class=&quot;nv&quot;&gt;$num2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;){&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$num1&lt;/span&gt; + &lt;span class=&quot;nv&quot;&gt;$num2&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;위와 같이 paramadd 라는 함수를 작성 한 후 아래와 같이 실행해 봅시다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&amp;gt; . .&lt;span class=&quot;se&quot;&gt;\p&lt;/span&gt;aramadd.ps1

&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&amp;gt; paramadd 1 2
3

&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&amp;gt; paramadd 1 &lt;span class=&quot;s2&quot;&gt;&quot;2&quot;&lt;/span&gt;
3

&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&amp;gt; paramadd 1 &lt;span class=&quot;s2&quot;&gt;&quot;b&quot;&lt;/span&gt;
값 &lt;span class=&quot;s2&quot;&gt;&quot;b&quot;&lt;/span&gt;을&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;를&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;System.Int32&quot;&lt;/span&gt; 유형으로 변환할 수 없습니다. 오류: &lt;span class=&quot;s2&quot;&gt;&quot;입력 문자열의 형식이 잘못되었습니다.&quot;&lt;/span&gt;
위치 C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&lt;span class=&quot;se&quot;&gt;\p&lt;/span&gt;aramadd.ps1:2 문자:5
+     &lt;span class=&quot;nv&quot;&gt;$num1&lt;/span&gt; + &lt;span class=&quot;nv&quot;&gt;$num2&lt;/span&gt;
+     ~~~~~~~~~~~~~
    + CategoryInfo          : InvalidArgument: &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;:&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt;, RuntimeException
    + FullyQualifiedErrorId : InvalidCastFromStringToInteger&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;인자 값으로 1과 2를 넣어 실행한 경우 정상적으로 3이라는 결과를 출력해 줍니다.&lt;/p&gt;

&lt;p&gt;여기서 2를 문자열 “2”로 변환하여 넣은 경우도 신기하게 3이라는 결과를 출력해줍니다.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;숫자 형태로 이루어진 문자&lt;/code&gt;는 PowerShell에서 숫자로 변환하여 실행을 해줍니다.&lt;/p&gt;

&lt;p&gt;진짜 문자형태인 “b”를 넣었을 경우에는 에러를 발생합니다. 에러의 내용을 살펴보면 &lt;code class=&quot;highlighter-rouge&quot;&gt;&quot;b&quot;를 &quot;System.Int32&quot;유형으로 변환할 수 없습니다.&lt;/code&gt; 라고 출력하는 것을 보아 앞의 &lt;code class=&quot;highlighter-rouge&quot;&gt;$num1의 형태가 Int32이기 때문에 이에 맞춰 변환하는 과정&lt;/code&gt;에서 에러가 발생한 것입니다.&lt;/p&gt;

&lt;p&gt;반대로 “1”과 2를 넣은 경우에는 정상적으로 실행됩니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&amp;gt; paramadd &lt;span class=&quot;s2&quot;&gt;&quot;1&quot;&lt;/span&gt; 2
12&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;어떤 연산을 하는 경우 앞의 변수의 형태에 따라 뒤의 변수 형태를 변환하는 것을 알 수 있습니다.&lt;/p&gt;

&lt;p&gt;또한 인자 값을 지정하여 함수를 실행할 수도 있습니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&amp;gt; paramadd -num1 1 -num2 2
3

&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&amp;gt; paramadd -num2 1 -num1 2
3&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;함수에서 사용하는 변수를 &lt;code class=&quot;highlighter-rouge&quot;&gt;-&lt;/code&gt;과 함께 사용하여 &lt;code class=&quot;highlighter-rouge&quot;&gt;순서에 상관없이&lt;/code&gt; 사용할 수 있습니다.&lt;/p&gt;

&lt;p&gt;다음으로 함수의 인자 개수에 대해서 설명하겠습니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;k&quot;&gt;function &lt;/span&gt;overparam &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$num1&lt;/span&gt;, &lt;span class=&quot;nv&quot;&gt;$num2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$num1&lt;/span&gt; + &lt;span class=&quot;nv&quot;&gt;$num2&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;위와 같이 overparam 함수를 작성합니다. overparam에서 사용하는 인자 값의 개수는 2개 인데 아래 실행 예제를 살펴보면 3개의 인자 값을 넣어도 에러를 발생하지 않습니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&amp;gt; overparam 1 2
3

&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&amp;gt; overparam 1 2 3
3&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;보통 다른 언어에서는 인자 값을 맞춰 코딩을 하기 때문에 에러가 발생하는데 PowerShell의 경우 에러를 출력하지 않습니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;k&quot;&gt;function &lt;/span&gt;overparam2 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$num1&lt;/span&gt;, &lt;span class=&quot;nv&quot;&gt;$num2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;){&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$num1&lt;/span&gt; + &lt;span class=&quot;nv&quot;&gt;$num2&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$args&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;위와 같이 스크립트를 작성한 후 아래와 같이 실행해 봅시다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&amp;gt; . .&lt;span class=&quot;se&quot;&gt;\o&lt;/span&gt;verparam2.ps1

&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&amp;gt; overparam2 1 2
3

&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&amp;gt; overparam2 1 2 3
3
3

&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&amp;gt; overparam2 1 2 3 4
3
3
4

&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&amp;gt; overparam2 1 2 3 4 5
3
3
4
5&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;위 실행예제를 보면 인자 개수가 2개이지만 값을 3개, 4개 넣었을 때 &lt;code class=&quot;highlighter-rouge&quot;&gt;$args&lt;/code&gt;를 통해 출력 된 다는 것을 알 수 있습니다.&lt;/p&gt;

&lt;h4 id=&quot;default-value&quot;&gt;Default Value&lt;/h4&gt;

&lt;p&gt;c++에서 함수의 &lt;code class=&quot;highlighter-rouge&quot;&gt;Default value(기본 값)&lt;/code&gt;을 지정할 수 있는데, PowerShell에서도 기본 값을 사용할 수 있습니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;k&quot;&gt;function &lt;/span&gt;defaultvalue&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$num1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 11, &lt;span class=&quot;nv&quot;&gt;$num2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;){&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$num1&lt;/span&gt; + &lt;span class=&quot;nv&quot;&gt;$num2&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&amp;gt; . .&lt;span class=&quot;se&quot;&gt;\d&lt;/span&gt;efaultvalue.ps1

&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&amp;gt; defaultvalue 1 2
3

&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&amp;gt; defaultvalue 2
2

&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&amp;gt; defaultvalue -num2 2
13&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;$num1의 값을 11로 기본 값으로 선언하고 실행합니다. 인자 값이 있는 경우에는 해당 값을 이용해 연산을 하지만 없는 경우 기본 값을 이용해 연산을 합니다.&lt;/p&gt;

&lt;p&gt;추가적으로 함수 내에서 사용하는 변수는 &lt;code class=&quot;highlighter-rouge&quot;&gt;지역변수&lt;/code&gt;입니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&amp;gt; &lt;span class=&quot;nv&quot;&gt;$num1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 11
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&amp;gt; &lt;span class=&quot;k&quot;&gt;function &lt;/span&gt;add&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$num1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 2, &lt;span class=&quot;nv&quot;&gt;$num2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;gp&quot;&gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$num1&lt;/span&gt; + &lt;span class=&quot;nv&quot;&gt;$num2&lt;/span&gt;
&lt;span class=&quot;gp&quot;&gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&amp;gt; &lt;span class=&quot;nv&quot;&gt;$num1&lt;/span&gt;
11
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&amp;gt; add 1 2
3
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&amp;gt; add -num2 2
4&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h4 id=&quot;mandatory&quot;&gt;Mandatory&lt;/h4&gt;

&lt;p&gt;다음으로는 함수의 인자의 조건에 대해서 알아보겠습니다. PowreShell에서는 인자 값에 대한 조건을 줄 수 있는데 &lt;code class=&quot;highlighter-rouge&quot;&gt;param([parameter () ], [parameter () ])&lt;/code&gt;과 같은 형식을 사용합니다. 아래 예제를 보겠습니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;k&quot;&gt;function &lt;/span&gt;paramcheck
&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;param&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;([&lt;/span&gt;parameter &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Mandatory &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)]&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$val1&lt;/span&gt;, &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Parameter&lt;span class=&quot;o&quot;&gt;()]&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$val2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;nb&quot;&gt;Write-Output&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;val1 is &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$val1&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;Write-Output&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;val2 is &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$val2&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;소스코드를 보면 &lt;code class=&quot;highlighter-rouge&quot;&gt;Mandatory = $true&lt;/code&gt;가 작성된 것을 볼 수 있는데, &lt;code class=&quot;highlighter-rouge&quot;&gt;Mandatory&lt;/code&gt;는 &lt;code class=&quot;highlighter-rouge&quot;&gt;의무적인&lt;/code&gt;이라는 뜻으로 해당 변수에 대해서는 무조건 값이 필요하다는 것을 뜻합니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&amp;gt; . .&lt;span class=&quot;se&quot;&gt;\p&lt;/span&gt;aramcheck.ps1

&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&amp;gt; paramcheck 1 2
val1 is 1
val2 is 2

&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&amp;gt; paramcheck -val1 1 -val2 2
val1 is 1
val2 is 2

&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&amp;gt; paramcheck -val1 1
val1 is 1
val2 is 

&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&amp;gt; paramcheck -val2 2
cmdlet paramcheck&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;명령 파이프라인 위치 1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
다음 매개 변수에 대한 값을 제공하십시오.
val1: 1
val1 is 1
val2 is 2&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;위 실행 예제를 보면 알 수 있듯이 &lt;code class=&quot;highlighter-rouge&quot;&gt;val2&lt;/code&gt;에 대한 값만 전달하는 경우 사용자마다 다르지만 에러를 발생하거나 위 경우처럼 val1에 대한 값을 요구하게 됩니다.&lt;/p&gt;

&lt;h4 id=&quot;position&quot;&gt;Position&lt;/h4&gt;
&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Position&lt;/code&gt;에 대해서 알아보겠습니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;k&quot;&gt;function &lt;/span&gt;paramcheck
&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;param&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;([&lt;/span&gt;parameter &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Mandatory &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$true&lt;/span&gt;, Position &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 1&lt;span class=&quot;o&quot;&gt;)]&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$val1&lt;/span&gt;, &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Parameter&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Position &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 0&lt;span class=&quot;o&quot;&gt;)]&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$val2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;nb&quot;&gt;Write-Output&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;val1 is &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$val1&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;Write-Output&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;val2 is &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$val2&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Position&lt;/code&gt;은 각 인자 값에 대한 &lt;code class=&quot;highlighter-rouge&quot;&gt;순서&lt;/code&gt;를 지정하는 것 입니다. 아래 실행 예제를 보도록 하겠습니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&amp;gt; . .&lt;span class=&quot;se&quot;&gt;\p&lt;/span&gt;aramcheck.ps1

&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&amp;gt; paramcheck 1 2
val1 is 2
val2 is 1&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;두 번째 인자 값인 &lt;code class=&quot;highlighter-rouge&quot;&gt;val2&lt;/code&gt;는 &lt;code class=&quot;highlighter-rouge&quot;&gt;Posiotion = 0&lt;/code&gt;으로 되어있고 &lt;code class=&quot;highlighter-rouge&quot;&gt;val1&lt;/code&gt;은 &lt;code class=&quot;highlighter-rouge&quot;&gt;Position = 1&lt;/code&gt;로 되어있기 때문에 순서 상 val2가 먼저 값을 받게 됩니다.&lt;/p&gt;

&lt;h4 id=&quot;valuefrompipeline&quot;&gt;ValueFromPipeline&lt;/h4&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ValueFromPipeline&lt;/code&gt;에 대해서 알아보겠습니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;k&quot;&gt;function &lt;/span&gt;paramcheck
&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;param&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;([&lt;/span&gt;parameter &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Mandatory &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$true&lt;/span&gt;, Position &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 0, ValueFromPipeline &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)]&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$val1&lt;/span&gt;, &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Parameter&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Position &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 1&lt;span class=&quot;o&quot;&gt;)]&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$val2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;nb&quot;&gt;Write-Output&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;val1 is &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$val1&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;Write-Output&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;val2 is &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$val2&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ValueFromPipeline&lt;/code&gt;은 Pipeline을 통해 함수의 인자 값을 넣어줄 수 있는 방법을 말합니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&amp;gt; . .&lt;span class=&quot;se&quot;&gt;\p&lt;/span&gt;aramcheck.ps1

&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&amp;gt; 33 | paramcheck
val1 is 33
val2 is &lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h4 id=&quot;allownull&quot;&gt;AllowNull&lt;/h4&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;AllowNull&lt;/code&gt;에 대해서 알아보겠습니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;k&quot;&gt;function &lt;/span&gt;paramcheck
&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;param&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;([&lt;/span&gt;parameter &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Mandatory &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$true&lt;/span&gt;, Position &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 0, ValueFromPipeline &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)]&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$val1&lt;/span&gt;, &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Parameter&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Position &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 1&lt;span class=&quot;o&quot;&gt;)]&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$val2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;nb&quot;&gt;Write-Output&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;val1 is &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$val1&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;Write-Output&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;val2 is &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$val2&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;위 예제에서 &lt;code class=&quot;highlighter-rouge&quot;&gt;val1&lt;/code&gt;에 대한 값을 &lt;code class=&quot;highlighter-rouge&quot;&gt;NULL&lt;/code&gt;로 하고 실행하면 아래와 같이 에러가 발생합니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&amp;gt; . .&lt;span class=&quot;se&quot;&gt;\p&lt;/span&gt;aramcheck.ps1

&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&amp;gt; paramcheck -val1 &lt;span class=&quot;nv&quot;&gt;$NULL&lt;/span&gt; -val2 2
paramcheck : &lt;span class=&quot;s1&quot;&gt;'val1'&lt;/span&gt; 매개 변수가 null이므로 인수를 해당 매개 변수에 바인딩할 수 없습니다.
위치 줄:1 문자:18
+ paramcheck -val1 &lt;span class=&quot;nv&quot;&gt;$NULL&lt;/span&gt; -val2 2
+                  ~~~~~
    + CategoryInfo          : InvalidData: &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;:&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;paramcheck], ParameterBindingValidat 
   ionException
    + FullyQualifiedErrorId : ParameterArgumentValidationErrorNullNotAllowed,paramch 
   eck&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;k&quot;&gt;function &lt;/span&gt;paramcheck
&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;param&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;([&lt;/span&gt;parameter &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Mandatory &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$true&lt;/span&gt;, Position &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 0, ValueFromPipeline &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;AllowNull&lt;span class=&quot;o&quot;&gt;()]&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$val1&lt;/span&gt;, &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Parameter&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Position &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 1&lt;span class=&quot;o&quot;&gt;)]&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$val2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;nb&quot;&gt;Write-Output&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;val1 is &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$val1&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;Write-Output&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;val2 is &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$val2&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;위와 같이 &lt;code class=&quot;highlighter-rouge&quot;&gt;[AllowNull()]&lt;/code&gt;를 작성한 후 실행하면 아래와 같이 에러가 발생하지 않는 것을 볼 수 있습니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&amp;gt; . .&lt;span class=&quot;se&quot;&gt;\p&lt;/span&gt;aramcheck.ps1

&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&amp;gt; paramcheck -val1 &lt;span class=&quot;nv&quot;&gt;$NULL&lt;/span&gt; -val2 2
val1 is 
val2 is 2&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h4 id=&quot;validateset&quot;&gt;ValidateSet&lt;/h4&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ValidateSet&lt;/code&gt;에 대해서 알아보겠습니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;k&quot;&gt;function &lt;/span&gt;paramcheck
&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;param&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;([&lt;/span&gt;parameter &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Mandatory &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$true&lt;/span&gt;, Position &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 0, ValueFromPipeline &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;ValidateSet&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1,2,3&lt;span class=&quot;o&quot;&gt;)]&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$val1&lt;/span&gt;, &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Parameter&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Position &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 1&lt;span class=&quot;o&quot;&gt;)]&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$val2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;nb&quot;&gt;Write-Output&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;val1 is &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$val1&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;Write-Output&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;val2 is &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$val2&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;paramcheck -val1&lt;/code&gt;을 입력한 뒤, &lt;code class=&quot;highlighter-rouge&quot;&gt;tab&lt;/code&gt;을 누르면 사용할 수 있는 값을 출력해 줍니다.&lt;/p&gt;

&lt;p&gt;이 외의 값을 사용하면 에러를 발생합니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&amp;gt; . .&lt;span class=&quot;se&quot;&gt;\p&lt;/span&gt;aramcheck.ps1

&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&amp;gt; paramcheck -val1 3 -val2 4
val1 is 3
val2 is 4

&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&amp;gt; paramcheck -val1 33 -val2 4
paramcheck : &lt;span class=&quot;s1&quot;&gt;'val1'&lt;/span&gt; 매개 변수에 대한 인수의 유효성을 검사할 수 없습니다. &lt;span class=&quot;s2&quot;&gt;&quot;33&quot;&lt;/span&gt; 인수가 ValidateSet 특성에 지정된 &lt;span class=&quot;s2&quot;&gt;&quot;1,2,
3&quot;&lt;/span&gt; 집합에 속하지 않습니다. 집합에 속한 인수를 제공하고 명령을 다시 시도하십시오.
위치 줄:1 문자:18
+ paramcheck -val1 33 -val2 4
+                  ~~
    + CategoryInfo          : InvalidData: &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;:&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;paramcheck], ParameterBindingValidat 
   ionException
    + FullyQualifiedErrorId : ParameterArgumentValidationError,paramcheck&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

</description>
        <pubDate>Tue, 08 Aug 2017 20:29:00 +0900</pubDate>
        <link>http://localhost:4000/technique/2017/08/08/Functios/</link>
        <guid isPermaLink="true">http://localhost:4000/technique/2017/08/08/Functios/</guid>
        
        <category>powershell</category>
        
        
        <category>technique</category>
        
      </item>
    
      <item>
        <title>Execution Policy</title>
        <description>&lt;p&gt;PowerShell에서 Script를 바로 실행할 수 없습니다.&lt;/p&gt;

&lt;p&gt;notepad를 이용해서 “HelloWorld!”를 작성한 뒤 &lt;code class=&quot;highlighter-rouge&quot;&gt;HelloWorld.ps1&lt;/code&gt; 파일을 생성합니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&amp;gt; .&lt;span class=&quot;se&quot;&gt;\H&lt;/span&gt;elloWorld.ps1
.&lt;span class=&quot;se&quot;&gt;\H&lt;/span&gt;elloWorld.ps1 : 이 시스템에서 스크립트를 실행할 수 없으므로 C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&lt;span class=&quot;se&quot;&gt;\H&lt;/span&gt;elloWorld.ps1 파일을 로드할 수 없습니다. 자세한 내용은 http://go.microsoft.com/fwlink/?Li
&lt;span class=&quot;nv&quot;&gt;nkID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;135170의 about_Execution_Policies를 참조하십시오.
위치 줄:1 문자:1
+ .&lt;span class=&quot;se&quot;&gt;\H&lt;/span&gt;elloWorld.ps1
+ ~~~~~~~~~~~~~~~~
    + CategoryInfo          : 보안 오류: &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;:&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt;, PSSecurityException
    + FullyQualifiedErrorId : UnauthorizedAccess&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;위 에러를 살펴보면 HelloWorld.ps1 파일을 로드할 수 없고 &lt;code class=&quot;highlighter-rouge&quot;&gt;about_Execution_Policies&lt;/code&gt;를 참조하라고 나옵니다.&lt;/p&gt;

&lt;p&gt;먼저 현재 권한이 어떻게 되는지 살펴보겠습니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&amp;gt; &lt;span class=&quot;nb&quot;&gt;Get-ExecutionPolicy
&lt;/span&gt;Restricted&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;현재 권한은 &lt;code class=&quot;highlighter-rouge&quot;&gt;Restricted&lt;/code&gt; 이며 &lt;code class=&quot;highlighter-rouge&quot;&gt;제한된&lt;/code&gt;이라는 뜻을 갖고 있습니다. 말 그대로 제한된 권한을 사용한다는 것입니다. 아무래도 아무 스크립트나 실행할 수 없도록 한 것 같습니다.&lt;/p&gt;

&lt;p&gt;여기서 &lt;code class=&quot;highlighter-rouge&quot;&gt;Get-Help&lt;/code&gt;를 이용해 about_Execution_Policies에 대해서 찾아보겠습니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&amp;gt; &lt;span class=&quot;nb&quot;&gt;Get-Help &lt;/span&gt;about_Execution_Policies
TOPIC
    about_Execution_Policies

&lt;span class=&quot;kt&quot;&gt;SHORT &lt;/span&gt;DESCRIPTION
    Describes the Windows PowerShell execution policies and explains
    how to manage them.
    ...&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;중략&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

WINDOWS POWERSHELL EXECUTION POLICIES
-------------------------------------

   The Windows PowerShell execution policies are as follows:

   &lt;span class=&quot;s2&quot;&gt;&quot;Restricted&quot;&lt;/span&gt; is the default policy.

       Restricted
           - Default execution policy &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;Windows 8,
             Windows Server 2012, and Windows 8.1.

           - Permits individual commands, but will not run
             scripts.

           - Prevents running of all script files, including
             formatting and configuration files &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;.ps1xml&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;, module
             script files &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;.psm1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;, and Windows PowerShell
             profiles &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;.ps1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.

             ...&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;중략&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

       Bypass
           - Nothing is blocked and there are no warnings or
             prompts.

           - This execution policy is designed &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;configurations
             &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;which a Windows PowerShell script is built &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;to a
             a larger application or &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;configurations &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;which
             Windows PowerShell is the foundation &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;a program
             that has its own security model.


       Undefined
           - There is no execution policy &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;the current scope.

           - &lt;span class=&quot;k&quot;&gt;If &lt;/span&gt;the execution policy &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;all scopes is Undefined, the
             effective execution policy is Restricted, which is the
             default execution policy.


   Note: On systems that &lt;span class=&quot;k&quot;&gt;do &lt;/span&gt;not distinguish Universal Naming Convention &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;UNC&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
         paths &lt;span class=&quot;k&quot;&gt;from &lt;/span&gt;Internet paths, scripts that are identified by a UNC path
         might not be permitted to run with the RemoteSigned execution policy.
         ...&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;생략&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;위 도움말을 보면 &lt;code class=&quot;highlighter-rouge&quot;&gt;Restricted&lt;/code&gt; 권한은 Default로 되어있고 이를 해지하려면 &lt;code class=&quot;highlighter-rouge&quot;&gt;bypass&lt;/code&gt;권한을 이용해야 합니다.&lt;/p&gt;

&lt;p&gt;권한을 변경하기 위해서 &lt;code class=&quot;highlighter-rouge&quot;&gt;관리자 권한&lt;/code&gt;으로 PowerShell를 실행시킨 후 &lt;code class=&quot;highlighter-rouge&quot;&gt;Set-ExecutionPolicy Bypass&lt;/code&gt;를 입력해 줍니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;Windows PowerShell
Copyright &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;C&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 2016 Microsoft Corporation. All rights reserved.

&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;INDOWS&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;ystem32&amp;gt; &lt;span class=&quot;nb&quot;&gt;Set-ExecutionPolicy &lt;/span&gt;Bypass

실행 규칙 변경
실행 정책은 신뢰하지 않는 스크립트로부터 사용자를 보호합니다. 실행 정책을 변경하면 about_Execution_Policies 도움말
항목&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;http://go.microsoft.com/fwlink/?LinkID&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;135170&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;에 설명된 보안 위험에 노출될 수 있습니다. 실행 정책을
변경하시겠습니까?
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Y] 예&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Y&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;A] 모두 예&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;A&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;N] 아니요&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;N&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;L] 모두 아니요&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;L&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;S] 일시 중단&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;S&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;?] 도움말 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;기본값은 &lt;span class=&quot;s2&quot;&gt;&quot;N&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: Y&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;그 후 다시 &lt;code class=&quot;highlighter-rouge&quot;&gt;Get-ExecutionPolicy&lt;/code&gt;를 실행하면 &lt;code class=&quot;highlighter-rouge&quot;&gt;Bypass&lt;/code&gt;로 권한이 변경된 것을 알 수 있습니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&amp;gt; &lt;span class=&quot;nb&quot;&gt;Get-ExecutionPolicy
&lt;/span&gt;Bypass&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;다시 HelloWorld.ps1를 실행하면 정상적으로 실행되는 것을 알 수 있습니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&amp;gt; .&lt;span class=&quot;se&quot;&gt;\H&lt;/span&gt;elloWorld.ps1
Hello World&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
</description>
        <pubDate>Tue, 08 Aug 2017 17:59:00 +0900</pubDate>
        <link>http://localhost:4000/technique/2017/08/08/Execution_Policy/</link>
        <guid isPermaLink="true">http://localhost:4000/technique/2017/08/08/Execution_Policy/</guid>
        
        <category>powershell</category>
        
        
        <category>technique</category>
        
      </item>
    
      <item>
        <title>Condition_and_Loop</title>
        <description>&lt;p&gt;이번에는 PowerShell에서 사용하는 조건문과 반복문에 대해서 알아보도록 하겠습니다.&lt;/p&gt;

&lt;h3 id=&quot;조건문&quot;&gt;조건문&lt;/h3&gt;

&lt;p&gt;다른 언어와 마찬가지로 PowerShell에서 &lt;code class=&quot;highlighter-rouge&quot;&gt;if&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;if~else&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;if~elseif~else&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;switch&lt;/code&gt;를 사용합니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 -gt 0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;1 &amp;gt; 0&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
1 &amp;gt; 0
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 -gt 5&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;1 &amp;gt; 0&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;1 &amp;lt; 5&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
1 &amp;lt; 5
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nv&quot;&gt;$num&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 2
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$num&lt;/span&gt; -eq 1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;num is 1&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;elseif&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$num&lt;/span&gt; -eq 2 &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;num is 2&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;i don't know&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
num is 2
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nv&quot;&gt;$num&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 3&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;위와 같이 다른 언어에서 사용하는 것과 동일하게 PowerShell에서 사용할 수 있습니다.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;switch&lt;/code&gt; 구문도 동일하게 사용하지만 좀 더 추가된 것이 있습니다. &lt;code class=&quot;highlighter-rouge&quot;&gt;*&lt;/code&gt;를 이용하는 방법인데, 아래 예제를 보겠습니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;k&quot;&gt;switch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$num&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;1&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;num is 1&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; 2&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;num is two&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; default&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;i don't know&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;}}&lt;/span&gt;
i don&lt;span class=&quot;s1&quot;&gt;'t know
PS C:\Users\k3y6reak&amp;gt; $str = &quot;abcd&quot;
PS C:\Users\k3y6reak&amp;gt; switch -wildcard ($str) { a*{&quot;a~&quot;} *b*{&quot;~b~&quot;} c*{&quot;c~&quot;}}
a~
~b~&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;*&lt;/code&gt;를 사용해서 switch 구문을 이용할 수 있습니다.&lt;/p&gt;

&lt;h3 id=&quot;반복문&quot;&gt;반복문&lt;/h3&gt;

&lt;p&gt;마찬가지로 &lt;code class=&quot;highlighter-rouge&quot;&gt;while&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;do~while&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;for&lt;/code&gt;를 사용할 수 있으며 추가적으로 &lt;code class=&quot;highlighter-rouge&quot;&gt;do~until&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;foreach&lt;/code&gt;를 사용할 수 있습니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nv&quot;&gt;$count&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 3
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$count&lt;/span&gt; -gt 0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;gp&quot;&gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;gp&quot;&gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;count is &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$count&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;gp&quot;&gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$count&lt;/span&gt;--
&lt;span class=&quot;gp&quot;&gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
count is 3
count is 2
count is 1
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nv&quot;&gt;$count&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 3
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
&lt;span class=&quot;gp&quot;&gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;gp&quot;&gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;count is &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$count&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;gp&quot;&gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$count&lt;/span&gt;--
&lt;span class=&quot;gp&quot;&gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;gp&quot;&gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;while&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$count&lt;/span&gt; -gt 0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
count is 3
count is 2
count is 1&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;while&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;do~while&lt;/code&gt;은 동일하게 실행됩니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nv&quot;&gt;$count&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 3
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
&lt;span class=&quot;gp&quot;&gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;gp&quot;&gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;count is &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$count&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;gp&quot;&gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$count&lt;/span&gt;--
&lt;span class=&quot;gp&quot;&gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;gp&quot;&gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;until&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$count&lt;/span&gt; -gt 0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
count is 3
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
&lt;span class=&quot;gp&quot;&gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;gp&quot;&gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;count is &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$count&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;gp&quot;&gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$count&lt;/span&gt;--
&lt;span class=&quot;gp&quot;&gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;gp&quot;&gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;until&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$count&lt;/span&gt; -lt 0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
count is 2
count is 1
count is 0&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;until&lt;/code&gt;은 &lt;code class=&quot;highlighter-rouge&quot;&gt;~때 까지&lt;/code&gt;로 처음 실행한 &lt;code class=&quot;highlighter-rouge&quot;&gt;$count -gt 0&lt;/code&gt;의 의미는 &lt;code class=&quot;highlighter-rouge&quot;&gt;0보다 클 때까지만&lt;/code&gt;실행하기 때문에 count는 3이됩니다.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;while&lt;/code&gt;과 &lt;code class=&quot;highlighter-rouge&quot;&gt;until&lt;/code&gt;은 서로 반대되는 개념이라고 생각하면 됩니다.&lt;/p&gt;

&lt;p&gt;for문 또한 동일하게 사용할 수 있습니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 0; &lt;span class=&quot;nv&quot;&gt;$i&lt;/span&gt; -lt 10; &lt;span class=&quot;nv&quot;&gt;$i&lt;/span&gt;++&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;gp&quot;&gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;gp&quot;&gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;i is &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$i&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;gp&quot;&gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
i is 0
i is 1
i is 2
i is 3
i is 4
i is 5
i is 6
i is 7
i is 8
i is 9&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;foreach&lt;/code&gt; 구문은 python 에서 for문과 동일합니다. java에도 foreach구문이 있죠.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nv&quot;&gt;$arr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Hello World!&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;k&quot;&gt;foreach&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$str&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$arr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;gp&quot;&gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;gp&quot;&gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$str&lt;/span&gt;
&lt;span class=&quot;gp&quot;&gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
Hello World!
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nv&quot;&gt;$arr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 1,2,3,4,5
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;k&quot;&gt;foreach&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$num&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$arr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;gp&quot;&gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;gp&quot;&gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$num&lt;/span&gt;
&lt;span class=&quot;gp&quot;&gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
1
2
3
4
5&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;위 예제를 보면 문자열인 경우 각 인덱스별로 값을 출력하는 것이 아니라 한 번에 출력하는 것을 알 수 있습니다.&lt;/p&gt;

&lt;p&gt;이 외에도 ForEach-Object와 Where-Object가 있습니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nb&quot;&gt;Get-Process&lt;/span&gt; | &lt;span class=&quot;k&quot;&gt;ForEach&lt;/span&gt;-Object &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_&lt;/span&gt;.Name&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
acrotray
ApplicationFrameHost
armsvc
coherence
coherence
coherence
conhost
csrss
csrss
dasHost
dllhost
dwm
explorer
fontdrvhost
fontdrvhost
Idle
IpOverUsbSvc
lsass
Memory Compression
MSASCuiL
msdtc
MsMpEng
NisSrv
OneDrive
powershell&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Get-Process를 이용해 얻은 값을 ForEach-Object를 통해서 &lt;code class=&quot;highlighter-rouge&quot;&gt;_.&lt;/code&gt;에 넣어준 후 &lt;code class=&quot;highlighter-rouge&quot;&gt;Name&lt;/code&gt;만 출력해주는 방법입니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nb&quot;&gt;Get-ChildItem &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop | &lt;span class=&quot;nb&quot;&gt;Where-Object&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_&lt;/span&gt;.Name -match &lt;span class=&quot;s2&quot;&gt;&quot;exe&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;


    디렉터리: C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
-a----    2017. 8. 2.  오전 12:35        1368442 asby.exe&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Where-Object를 이용해 &lt;code class=&quot;highlighter-rouge&quot;&gt;grep&lt;/code&gt; 처럼 사용할 수 있습니다.&lt;/p&gt;
</description>
        <pubDate>Tue, 08 Aug 2017 12:58:00 +0900</pubDate>
        <link>http://localhost:4000/technique/2017/08/08/condition_and_loop/</link>
        <guid isPermaLink="true">http://localhost:4000/technique/2017/08/08/condition_and_loop/</guid>
        
        <category>powershell</category>
        
        
        <category>technique</category>
        
      </item>
    
      <item>
        <title>Type and Array</title>
        <description>&lt;p&gt;PowerShell에서 각 변수에 대한 자료형을 알아보는 방법과 배열에 대해서 알아보도록 하겠습니다.&lt;/p&gt;

&lt;h3 id=&quot;type&quot;&gt;Type&lt;/h3&gt;

&lt;p&gt;PowerShell에서는 각 변수에 &lt;code class=&quot;highlighter-rouge&quot;&gt;.GetType()&lt;/code&gt;를 붙여주면 자료형을 알 수 있습니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;s2&quot;&gt;&quot;3&quot;&lt;/span&gt;.GetType&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;

IsPublic IsSerial Name                                     BaseType
-------- -------- ----                                     --------
True     True     &lt;span class=&quot;kt&quot;&gt;String                                   &lt;/span&gt;System.Object


&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nv&quot;&gt;$a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 3
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nv&quot;&gt;$a&lt;/span&gt;.GetType&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;

IsPublic IsSerial Name                                     BaseType
-------- -------- ----                                     --------
True     True     Int32                                    System.ValueType


&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nv&quot;&gt;$b&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 3.2
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nv&quot;&gt;$b&lt;/span&gt;.GetType&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;

IsPublic IsSerial Name                                     BaseType
-------- -------- ----                                     --------
True     True     &lt;span class=&quot;kt&quot;&gt;Double                                   &lt;/span&gt;System.ValueType&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;다른 언어들과 동일하게 자료형이 정해지는 것을 알 수 있습니다.&lt;/p&gt;

&lt;p&gt;문자열을 사용하는 경우 &lt;code class=&quot;highlighter-rouge&quot;&gt;'&lt;/code&gt;과 &lt;code class=&quot;highlighter-rouge&quot;&gt;&quot;&lt;/code&gt;에 대한 차이를 알아야 합니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nv&quot;&gt;$a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Hello My name is k3y6reak&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nv&quot;&gt;$b&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'Hello My name is k3y6reak'&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nv&quot;&gt;$a&lt;/span&gt;.GetType&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;

IsPublic IsSerial Name                                     BaseType
-------- -------- ----                                     --------
True     True     &lt;span class=&quot;kt&quot;&gt;String                                   &lt;/span&gt;System.Object


&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nv&quot;&gt;$b&lt;/span&gt;.GetType&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;

IsPublic IsSerial Name                                     BaseType
-------- -------- ----                                     --------
True     True     &lt;span class=&quot;kt&quot;&gt;String                                   &lt;/span&gt;System.Object


&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;s2&quot;&gt;&quot;val a is &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$a&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
val a is Hello My name is k3y6reak
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;s1&quot;&gt;'val b is $b'&lt;/span&gt;
val b is &lt;span class=&quot;nv&quot;&gt;$b&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;s2&quot;&gt;&quot;val b is &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$b&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
val b is Hello My name is k3y6reak&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;'&lt;/code&gt;과 &lt;code class=&quot;highlighter-rouge&quot;&gt;&quot;&lt;/code&gt;는 모두 동일하게 String 자료형을 갖고 있으나 변수의 내용을 출력할 때는 위와 같이 차이를 보입니다.&lt;/p&gt;

&lt;p&gt;여러 줄을 이용하여 문자열을 작성하고 싶다면 &lt;code class=&quot;highlighter-rouge&quot;&gt;@&quot;&lt;/code&gt;으로 시작해 &lt;code class=&quot;highlighter-rouge&quot;&gt;&quot;@&lt;/code&gt;로 끝나면 됩니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nv&quot;&gt;$str&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; @&lt;span class=&quot;s2&quot;&gt;&quot;
&amp;gt;&amp;gt; &quot;&lt;/span&gt;Hi&lt;span class=&quot;s2&quot;&gt;&quot;
&amp;gt;&amp;gt; &quot;&lt;/span&gt;My name is&lt;span class=&quot;s2&quot;&gt;&quot;
&amp;gt;&amp;gt; &quot;&lt;/span&gt;k3y6reak&lt;span class=&quot;s2&quot;&gt;&quot;
&amp;gt;&amp;gt; &quot;&lt;/span&gt;@
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nv&quot;&gt;$str&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&quot;Hi&quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&quot;My name is&quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&quot;k3y6reak&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;배열&quot;&gt;배열&lt;/h3&gt;

&lt;p&gt;배열은 다른언어와 동일하게 사용할 수 있습니다. 대부분의 스크립트 언어는 하나의 배열에 여러가지의 형태가 들어가도 상관없는 것 처럼 PowerShell 또한 여러가지 형태가 들어갈 수 있습니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nv&quot;&gt;$arr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 1,2,3
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nv&quot;&gt;$arr&lt;/span&gt;
1
2
3
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nv&quot;&gt;$arr&lt;/span&gt;.GetType&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;

IsPublic IsSerial Name                                     BaseType
-------- -------- ----                                     --------
True     True     &lt;span class=&quot;kt&quot;&gt;Object&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt;                                 System.Array&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;여기서 배열에 대한 자료형은 Object[]로 나타낸 다는 것에 주의하면 됩니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nv&quot;&gt;$arr2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 1, 2.3, &lt;span class=&quot;s2&quot;&gt;&quot;Hello&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nv&quot;&gt;$arr2&lt;/span&gt;
1
2.3
Hello&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;위 예제처럼 여러가지 자료형을 갖는 배열을 만들 수 있습니다.&lt;/p&gt;

&lt;p&gt;아무것도 없는 배열을 만들고 싶다면 &lt;code class=&quot;highlighter-rouge&quot;&gt;$arr = @()&lt;/code&gt;로 만들 수 있습니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nv&quot;&gt;$arr3&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; @&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nv&quot;&gt;$arr3&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nv&quot;&gt;$arr3&lt;/span&gt;.GetType&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;

IsPublic IsSerial Name                                     BaseType
-------- -------- ----                                     --------
True     True     &lt;span class=&quot;kt&quot;&gt;Object&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt;                                 System.Array&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;마찬가지로 &lt;code class=&quot;highlighter-rouge&quot;&gt;[]&lt;/code&gt;를 이용하여 각 인덱스의 값을 출력할 수 있습니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nv&quot;&gt;$arr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Hello My name is k3y6reak&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nv&quot;&gt;$arr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;0]
&lt;span class=&quot;nb&quot;&gt;H
PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nv&quot;&gt;$arr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;1]
e&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;또한 &lt;code class=&quot;highlighter-rouge&quot;&gt;[]&lt;/code&gt;를 이용하여 값의 자료형을 변환할 수 있습니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nv&quot;&gt;$i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 3.2
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nv&quot;&gt;$i&lt;/span&gt;.GetType&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;

IsPublic IsSerial Name                                     BaseType
-------- -------- ----                                     --------
True     True     &lt;span class=&quot;kt&quot;&gt;Double                                   &lt;/span&gt;System.ValueType


&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$i&lt;/span&gt;
3&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
</description>
        <pubDate>Mon, 07 Aug 2017 19:45:00 +0900</pubDate>
        <link>http://localhost:4000/technique/2017/08/07/Type_and_Array/</link>
        <guid isPermaLink="true">http://localhost:4000/technique/2017/08/07/Type_and_Array/</guid>
        
        <category>powershell</category>
        
        
        <category>technique</category>
        
      </item>
    
      <item>
        <title>Operators</title>
        <description>&lt;p&gt;이번에는 PowerShell에서 사용하는 연산자에 대해서 알아보도록 하겠습니다.&lt;/p&gt;

&lt;p&gt;PowerShell에서도 마찬가지로 다른 언어와 동일하게 연산자가 사용됩니다. 산술, 대입, 비교, 리다이렉션, 논리, 타입 등이 존재합니다.&lt;/p&gt;

&lt;h3 id=&quot;산술-연산자&quot;&gt;산술 연산자&lt;/h3&gt;

&lt;p&gt;산술 연산자는 &lt;code class=&quot;highlighter-rouge&quot;&gt;덧셈, 뺄셈, 나눗셈, 곱셈&lt;/code&gt;을 하는 것을 뜻합니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; 3 + 1
4
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; 3 - 1
2
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; 3 &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; 2
6
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; 3 / 2
1.5
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; 3 % 2
1&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;다른 언어의 경우 나눗셈을 할 때 &lt;code class=&quot;highlighter-rouge&quot;&gt;정수값&lt;/code&gt;을 출력해주지만 PowerSell에서는 &lt;code class=&quot;highlighter-rouge&quot;&gt;소수&lt;/code&gt;로 출력하는 것이 다릅니다.&lt;/p&gt;

&lt;h3 id=&quot;대입-연산자&quot;&gt;대입 연산자&lt;/h3&gt;

&lt;p&gt;대입 연산자는 &lt;code class=&quot;highlighter-rouge&quot;&gt;변수에 값을 넣는 것&lt;/code&gt;을 뜻합니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nv&quot;&gt;$a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 3
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nv&quot;&gt;$a&lt;/span&gt;
3
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nv&quot;&gt;$a&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 2
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nv&quot;&gt;$a&lt;/span&gt;
6
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nv&quot;&gt;$a&lt;/span&gt; -&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 1
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nv&quot;&gt;$a&lt;/span&gt;
5
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nv&quot;&gt;$a&lt;/span&gt; +&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 3
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nv&quot;&gt;$a&lt;/span&gt;
8
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nv&quot;&gt;$a&lt;/span&gt; /&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 3
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nv&quot;&gt;$a&lt;/span&gt;
2.66666666666667
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nv&quot;&gt;$a&lt;/span&gt; %&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 2
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nv&quot;&gt;$a&lt;/span&gt;
0.666666666666667&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;비교-연산자&quot;&gt;비교 연산자&lt;/h3&gt;

&lt;p&gt;비교 연산자는 &lt;code class=&quot;highlighter-rouge&quot;&gt;값을 비교하는 것&lt;/code&gt;을 뜻합니다. 다른 언어와는 다르게 ==, !=, &amp;lt; 등 을 사용하지 못합니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; 2 &amp;lt; 3
위치 줄:1 문자:3
+ 2 &amp;lt; 3
+   ~
&lt;span class=&quot;s1&quot;&gt;'&amp;lt;'&lt;/span&gt; 연산자는 나중에 사용하도록 예약되어 있습니다.
    + CategoryInfo          : ParserError: &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;:&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt;, ParentContainsErrorRecordException
    + FullyQualifiedErrorId : RedirectionNotSupported

&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; 2 &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; 3
위치 줄:1 문자:1
+ 2 &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; 3
+ ~
대입 식이 잘못되었습니다. 대입 연산자의 입력은 변수 또는 속성과 같이 대입을 허용할 수 있는 개체여야 합니다.
    + CategoryInfo          : ParserError: &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;:&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt;, ParentContainsErrorRecordException
    + FullyQualifiedErrorId : InvalidLeftHandSide&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;위와 같이 에러를 발생하기 때문에 다른 연산자를 사용해야 합니다.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;-eq, -ne, -gt, -lt, -le, -ge, -match, -notmatch, -replace, -like, -notlike, -in, -notin, -contains, -notcontains&lt;/code&gt;가 있습니다.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;-eq&lt;/code&gt;는 equal 로 값이 같은지를 확인합니다. 숫자와 문자 모두 비교가 가능합니다.
문자를 비교할 때는 대소문자를 따지지 않습니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; 2 -eq 3
False
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; 2 -eq 2
True
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;s2&quot;&gt;&quot;Hello&quot;&lt;/span&gt; -eq &lt;span class=&quot;s2&quot;&gt;&quot;Hello&quot;&lt;/span&gt;
True
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;s2&quot;&gt;&quot;Hello&quot;&lt;/span&gt; -eq &lt;span class=&quot;s2&quot;&gt;&quot;HellO&quot;&lt;/span&gt;
True&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;-ne&lt;/code&gt;는 not equal 로 값이 다른지를 확인합니다. 숫자와 문자 모두 비교가 가능합니다.
문자를 비교할 때는 대소문자를 따지지 않습니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; 2 -ne 3
True
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;s2&quot;&gt;&quot;Hello&quot;&lt;/span&gt; -ne &lt;span class=&quot;s2&quot;&gt;&quot;World&quot;&lt;/span&gt;
True&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;-gt&lt;/code&gt;는 greater than 로 값이 큰지를 확인합니다. 숫자와 문자 모두 비교가 가능합니다.
문자를 비교할 때는 각 문자의 ascii 값으로 비교합니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; 4 -gt 3
True
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;s2&quot;&gt;&quot;Hello&quot;&lt;/span&gt; -gt &lt;span class=&quot;s2&quot;&gt;&quot;Hell0&quot;&lt;/span&gt;
True
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;s2&quot;&gt;&quot;Hello&quot;&lt;/span&gt; -gt &lt;span class=&quot;s2&quot;&gt;&quot;Helln&quot;&lt;/span&gt;
True
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;s2&quot;&gt;&quot;Hello&quot;&lt;/span&gt; -gt &lt;span class=&quot;s2&quot;&gt;&quot;Hellp&quot;&lt;/span&gt;
False&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;-lt&lt;/code&gt;는 less than 로 값이 작은지를 확인합니다. 숫자와 문자 모두 비교가 가능합니다.
문자를 비교할 때는 각 문자의 ascii 값으로 비교합니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;s2&quot;&gt;&quot;Hello&quot;&lt;/span&gt; -lt &lt;span class=&quot;s2&quot;&gt;&quot;Hell0&quot;&lt;/span&gt;
False
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; 2 -lt 3
True&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;이외의 연산자는 직접 실습해 보시길 바랍니다.&lt;/p&gt;

&lt;h3 id=&quot;리다이렉션&quot;&gt;리다이렉션&lt;/h3&gt;

&lt;p&gt;리다이렉션은 linux와 동일하게 사용됩니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;s2&quot;&gt;&quot;Hello&quot;&lt;/span&gt; &amp;gt; hello.txt
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;hello.txt
Hello
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;s2&quot;&gt;&quot;World&quot;&lt;/span&gt; &amp;gt;&amp;gt; hello.txt
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;hello.txt
Hello
World&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;논리-연산자&quot;&gt;논리 연산자&lt;/h3&gt;

&lt;p&gt;논리 연산자는 &lt;code class=&quot;highlighter-rouge&quot;&gt;and, or, not, !&lt;/code&gt;를 말합니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;2 -eq 3&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; -and &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;4 -eq 4&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
False
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;2 -eq 3&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; -or &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;4 -eq 4&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
True&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;분할-병합&quot;&gt;분할, 병합&lt;/h3&gt;

&lt;p&gt;분할과 병합은 &lt;code class=&quot;highlighter-rouge&quot;&gt;split, join&lt;/code&gt;으로 할 수 있습니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;s2&quot;&gt;&quot;Hello World My name is k3y6reak&quot;&lt;/span&gt; -split &lt;span class=&quot;s2&quot;&gt;&quot; &quot;&lt;/span&gt;
Hello
World
My
name
is
k3y6reak
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;s2&quot;&gt;&quot;Hello&quot;&lt;/span&gt;, &lt;span class=&quot;s2&quot;&gt;&quot;My name is k3y6reak&quot;&lt;/span&gt; -join &lt;span class=&quot;s2&quot;&gt;&quot;World&quot;&lt;/span&gt;
HelloWorldMy name is k3y6reak&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;타입&quot;&gt;타입&lt;/h3&gt;

&lt;p&gt;타입은 값의 형태를 확인거나 변환할 수 있습니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; 3 -is &lt;span class=&quot;s2&quot;&gt;&quot;int&quot;&lt;/span&gt;
True
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; 3 -is &lt;span class=&quot;s2&quot;&gt;&quot;float&quot;&lt;/span&gt;
False
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;s2&quot;&gt;&quot;3&quot;&lt;/span&gt; -is &lt;span class=&quot;s2&quot;&gt;&quot;string&quot;&lt;/span&gt;
True
&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; 0x12 -as &lt;span class=&quot;s2&quot;&gt;&quot;int&quot;&lt;/span&gt;
18&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

</description>
        <pubDate>Mon, 07 Aug 2017 15:20:00 +0900</pubDate>
        <link>http://localhost:4000/technique/2017/08/07/Operators/</link>
        <guid isPermaLink="true">http://localhost:4000/technique/2017/08/07/Operators/</guid>
        
        <category>powershell</category>
        
        
        <category>technique</category>
        
      </item>
    
      <item>
        <title>SHA2017 Suspect File1 (100)</title>
        <description>&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h3 id=&quot;문제&quot;&gt;문제&lt;/h3&gt;

&lt;p&gt;Suspect File 1 (100)&lt;/p&gt;

&lt;p&gt;We found some software on our suspects development server, it looks like they created some different versions, are you able to crack the software?&lt;/p&gt;

&lt;p&gt;Challenge created by the Digital and Biometric Traces division of the Netherlands Forensic Institute.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h3 id=&quot;풀이&quot;&gt;풀이&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;root@ubuntu:/home/k3y6reak/Desktop# &lt;/span&gt;./100
Sorry
&lt;span class=&quot;gp&quot;&gt;root@ubuntu:/home/k3y6reak/Desktop# &lt;/span&gt;./100 a
Sorry&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;해당 바이너리를 실행하면 위와같이 Sorry만 출력한다.&lt;/p&gt;

&lt;p&gt;IDA를 이용해서 디컴파일하여 소스코드를 보게 되면 아래와 같이 do~while()로 시작하는 것을 알 수 있으며 v10 값이 &lt;code class=&quot;highlighter-rouge&quot;&gt;0xc9702e05&lt;/code&gt;되어야만 Yes!를 출력한다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-c&quot; data-lang=&quot;c&quot;&gt;	&lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;while&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
		&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;while&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
			&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
				&lt;span class=&quot;p&quot;&gt;...(&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;생략&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
			&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
		&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;while&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v10&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xc9702e05&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;가장 처음 비교하는 부분인 &lt;code class=&quot;highlighter-rouge&quot;&gt;0x8048977&lt;/code&gt;에 Breakpoint를 걸어두고 &lt;code class=&quot;highlighter-rouge&quot;&gt;r aaaaaaaaa&lt;/code&gt;로 실행한 뒤 &lt;code class=&quot;highlighter-rouge&quot;&gt;finish&lt;/code&gt; 명령을 계속해서 실행한다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ida&quot; data-lang=&quot;ida&quot;&gt;.text:08048977                 cmp     eax, 96C8ACCAh
.text:0804897C                 jg      short loc_8048990
.text:0804897E                 cmp     eax, 8FD5472Dh
.text:08048983                 jnz     short loc_8048977
.text:08048985                 jmp     short loc_8048940&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;----------------------------------registers-----------------------------------]
EAX: 0x5c4742c2
EBX: 0x8048164 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&amp;lt;_init&amp;gt;:	push   ebx&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
ECX: 0x80ed5e8 --&amp;gt; 0x0
EDX: 0xe6cbc1fb
ESI: 0x80ea0c4 --&amp;gt; 0x8068270 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&amp;lt;__strcpy_sse2&amp;gt;:	mov    edx,DWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;esp+0x4]&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
EDI: 0x46 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'F'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
EBP: 0xffffd4f8 --&amp;gt; 0x1000
ESP: 0xffffd370 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;flag{57201791ea24f3acd852cee3271333a8}&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\0&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;02&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\0&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;02&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
EIP: 0x8048977 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&amp;lt;main+263&amp;gt;:	cmp    eax,0x96c8acca&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
EFLAGS: 0x246 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;carry PARITY adjust ZERO sign &lt;span class=&quot;nb&quot;&gt;trap &lt;/span&gt;INTERRUPT direction overflow&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;-------------------------------------code-------------------------------------]
   0x804896d &amp;lt;main+253&amp;gt;:	or     cl,al
   0x804896f &amp;lt;main+255&amp;gt;:	mov    eax,0x6b8a9776
   0x8048974 &amp;lt;main+260&amp;gt;:	cmovne eax,edx
&lt;span class=&quot;gp&quot;&gt;=&amp;gt; &lt;/span&gt;0x8048977 &amp;lt;main+263&amp;gt;:	cmp    eax,0x96c8acca
   0x804897c &amp;lt;main+268&amp;gt;:	jg     0x8048990 &amp;lt;main+288&amp;gt;
   0x804897e &amp;lt;main+270&amp;gt;:	cmp    eax,0x8fd5472d
   0x8048983 &amp;lt;main+275&amp;gt;:	jne    0x8048977 &amp;lt;main+263&amp;gt;
   0x8048985 &amp;lt;main+277&amp;gt;:	jmp    0x8048940 &amp;lt;main+208&amp;gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;------------------------------------stack-------------------------------------]
0000| 0xffffd370 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;flag{57201791ea24f3acd852cee3271333a8}&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\0&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;02&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\0&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;02&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
0004| 0xffffd374 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;{57201791ea24f3acd852cee3271333a8}&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\0&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;02&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\0&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;02&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
0008| 0xffffd378 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;01791ea24f3acd852cee3271333a8}&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\0&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;02&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\0&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;02&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
0012| 0xffffd37c &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;1ea24f3acd852cee3271333a8}&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\0&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;02&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\0&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;02&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
0016| 0xffffd380 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;4f3acd852cee3271333a8}&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\0&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;02&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\0&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;02&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
0020| 0xffffd384 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;cd852cee3271333a8}&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\0&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;02&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\0&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;02&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
0024| 0xffffd388 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;2cee3271333a8}&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\0&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;02&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\0&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;02&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
0028| 0xffffd38c &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;3271333a8}&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\0&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;02&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\0&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;02&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;------------------------------------------------------------------------------]
Legend: code, data, rodata, value

Breakpoint 1, 0x08048977 &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;main &lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
gdb-peda&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;finish&lt;/code&gt;명령을 계속해서 실행하면 위와같이 stack에 flag에 대한 정보가 나오게 된다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;root@ubuntu:/home/k3y6reak/Desktop# &lt;/span&gt;./100 flag&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;57201791ea24f3acd852cee3271333a8&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
Yes!
root@ubuntu:/home/k3y6reak/Desktop#&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;따라서 &lt;code class=&quot;highlighter-rouge&quot;&gt;flag{57201791ea24f3acd852cee3271333a8}&lt;/code&gt;가 된다.&lt;/p&gt;
</description>
        <pubDate>Mon, 07 Aug 2017 14:14:00 +0900</pubDate>
        <link>http://localhost:4000/ctfs/2017/08/07/sha2017_suspect_file1_100/</link>
        <guid isPermaLink="true">http://localhost:4000/ctfs/2017/08/07/sha2017_suspect_file1_100/</guid>
        
        
        <category>ctfs</category>
        
      </item>
    
      <item>
        <title>SHA2017 asby (100)</title>
        <description>&lt;h3 id=&quot;문제&quot;&gt;문제&lt;/h3&gt;

&lt;p&gt;asby (100)&lt;/p&gt;

&lt;p&gt;Eindbazen team member asby has by far been putting the most energy and time in creating the SHA2017 CTF. To honor his dedication and all his effort we created this challenge as an ode to him.&lt;/p&gt;

&lt;p&gt;You can choose to reverse engineer this challenge or you can “asby” it. Good luck with the option you choose.&lt;/p&gt;

&lt;h3 id=&quot;풀이&quot;&gt;풀이&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;What is the flag? k3y6reak
Checking char 1:WRONG!
What is the flag?&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;asby.exe 파일을 실행하면 위와 같이 What is the flag? 라는 문자열이 나타나며 입력을 하면 각 자리마다 값을 비교한다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-assembly&quot; data-lang=&quot;assembly&quot;&gt;0040179B | 89 D0                    | MOV EAX, EDX                                     |
0040179D | 0F B6 44 05 C9           | MOVZX EAX, BYTE PTR SS:[EBP + EAX - 37]          |
004017A2 | 31 C8                    | XOR EAX, ECX                                     |
004017A4 | 83 F0 2A                 | XOR EAX, 2A                                      |
004017A7 | 38 45 80                 | CMP BYTE PTR SS:[EBP - 80], AL                   |
004017AA | 0F 94 C0                 | SETE AL                                          |
004017AD | 84 C0                    | TEST AL, AL                                      |
004017AF | 74 16                    | JE asby.4017C7                                   |
004017B1 | C7 44 24 04 4F 90 48 00  | MOV DWORD PTR SS:[ESP + 4], asby.48904F          | 48904F:&quot;CORRECT!\n&quot;
004017B9 | C7 04 24 40 81 48 00     | MOV DWORD PTR SS:[ESP], asby.488140              |
004017C0 | E8 4B 9F 07 00           | CALL asby.47B710                                 |
004017C5 | EB 1D                    | JMP asby.4017E4                                  |
004017C7 | C7 44 24 04 59 90 48 00  | MOV DWORD PTR SS:[ESP + 4], asby.489059          | 489059:&quot;WRONG!\n&quot;
004017CF | C7 04 24 40 81 48 00     | MOV DWORD PTR SS:[ESP], asby.488140              |
004017D6 | C7 45 88 02 00 00 00     | MOV DWORD PTR SS:[EBP - 78], 2                   |
004017DD | E8 2E 9F 07 00           | CALL asby.47B710                                 |
004017E2 | EB 29                    | JMP asby.40180D                                  |&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;각 자리를 비교하는 부분은 &lt;code class=&quot;highlighter-rouge&quot;&gt;0x004017a7&lt;/code&gt; 에서 비교를 하는데 &lt;code class=&quot;highlighter-rouge&quot;&gt;0x004017a4&lt;/code&gt;에서 입력한 값과 &lt;code class=&quot;highlighter-rouge&quot;&gt;0x2a를 xor 연산한 값&lt;/code&gt;을 비교하게 된다.&lt;/p&gt;

&lt;p&gt;여기서 &lt;code class=&quot;highlighter-rouge&quot;&gt;WRONG!&lt;/code&gt;이 출력되면 다시 flag를 입력해야 하기 때문에 값이 틀려도 &lt;code class=&quot;highlighter-rouge&quot;&gt;CORRECT!&lt;/code&gt;가 나오도록 하기 위해서 바이너리를 패치한다.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;004017AF | 74 16                    | JE asby.4017C7&lt;/code&gt; 이 부분을 &lt;code class=&quot;highlighter-rouge&quot;&gt;NOP&lt;/code&gt;으로 패치한 뒤에 비교하는 값을 모두 찾아내면 된다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&amp;gt;asby.exe
What is the flag? flag&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;024baa8ac03ef22fdde61c0f11069f2f&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
Checking char 1:CORRECT!
Checking char 2:CORRECT!
Checking char 3:CORRECT!
Checking char 4:CORRECT!
Checking char 5:CORRECT!
Checking char 6:CORRECT!
Checking char 7:CORRECT!
Checking char 8:CORRECT!
Checking char 9:CORRECT!
Checking char 10:CORRECT!
Checking char 11:CORRECT!
Checking char 12:CORRECT!
Checking char 13:CORRECT!
Checking char 14:CORRECT!
Checking char 15:CORRECT!
Checking char 16:CORRECT!
Checking char 17:CORRECT!
Checking char 18:CORRECT!
Checking char 19:CORRECT!
Checking char 20:CORRECT!
Checking char 21:CORRECT!
Checking char 22:CORRECT!
Checking char 23:CORRECT!
Checking char 24:CORRECT!
Checking char 25:CORRECT!
Checking char 26:CORRECT!
Checking char 27:CORRECT!
Checking char 28:CORRECT!
Checking char 29:CORRECT!
Checking char 30:CORRECT!
Checking char 31:CORRECT!
Checking char 32:CORRECT!
Checking char 33:CORRECT!
Checking char 34:CORRECT!
Checking char 35:CORRECT!
Checking char 36:CORRECT!
Checking char 37:CORRECT!
Checking char 38:CORRECT!

Congrats, it seems you asby&lt;span class=&quot;s1&quot;&gt;'ed the flag out of the challenge!&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;각 자리를 모두 찾아내면 &lt;code class=&quot;highlighter-rouge&quot;&gt;flag{024baa8ac03ef22fdde61c0f11069f2f}&lt;/code&gt;가 나오게 된다.&lt;/p&gt;
</description>
        <pubDate>Mon, 07 Aug 2017 14:11:00 +0900</pubDate>
        <link>http://localhost:4000/ctfs/2017/08/07/sha2017_asby_100/</link>
        <guid isPermaLink="true">http://localhost:4000/ctfs/2017/08/07/sha2017_asby_100/</guid>
        
        
        <category>ctfs</category>
        
      </item>
    
      <item>
        <title>Cmdlet</title>
        <description>&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;이번에는 PowerShell에서 사용되는 cmdlet에 대해서 알아 보도록 하겠습니다.&lt;/p&gt;

&lt;p&gt;PowerShell에서 명령어를 사용하기 위해서 &lt;code class=&quot;highlighter-rouge&quot;&gt;Get-Command&lt;/code&gt;를 입력하면 아래와 같이 많은 명령어들이 출력되는 것을 볼 수 있습니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nb&quot;&gt;Get-Command

&lt;/span&gt;CommandType     Name                                               Version    Source
-----------     ----                                               -------    ------
Alias           Add-ProvisionedAppxPackage                         3.0        Dism
Alias           Apply-WindowsUnattend                              3.0        Dism
Alias           Disable-PhysicalDiskIndication                     2.0.0.0    Storage
Alias           Disable-StorageDiagnosticLog                       2.0.0.0    Storage
Alias           Enable-PhysicalDiskIndication                      2.0.0.0    Storage
Alias           Enable-StorageDiagnosticLog                        2.0.0.0    Storage
Alias           Flush-Volume                                       2.0.0.0    Storage
Alias           Get-DiskSNV                                        2.0.0.0    Storage
Alias           Get-PhysicalDiskSNV                                2.0.0.0    Storage
Alias           Get-ProvisionedAppxPackage                         3.0        Dism
Alias           Get-StorageEnclosureSNV                            2.0.0.0    Storage
Alias           Initialize-Volume                                  2.0.0.0    Storage
Alias           &lt;span class=&quot;nb&quot;&gt;Move&lt;/span&gt;-SmbClient                                     2.0.0.0    SmbWitness
Alias           Remove-ProvisionedAppxPackage                      3.0        Dism
Alias           &lt;span class=&quot;nb&quot;&gt;Write&lt;/span&gt;-FileSystemCache                              2.0.0.0    Storage
&lt;span class=&quot;k&quot;&gt;Function        &lt;/span&gt;A:
&lt;span class=&quot;k&quot;&gt;Function        &lt;/span&gt;Add-BCDataCacheExtension                           1.0.0.0    BranchCache
&lt;span class=&quot;k&quot;&gt;Function        &lt;/span&gt;Add-BitLockerKeyProtector                          1.0.0.0    BitLocker
&lt;span class=&quot;k&quot;&gt;Function        &lt;/span&gt;Add-DnsClientNrptRule                              1.0.0.0    DnsClient
&lt;span class=&quot;k&quot;&gt;Function        &lt;/span&gt;Add-DtcClusterTMMapping                            1.0.0.0    MsDtc
&lt;span class=&quot;k&quot;&gt;Function        &lt;/span&gt;Add-EtwTraceProvider                               1.0.0.0    EventTracingManagement
&lt;span class=&quot;k&quot;&gt;Function        &lt;/span&gt;Add-InitiatorIdToMaskingSet                        2.0.0.0    Storage
...&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;생략&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;이 중에서 알아볼 명령어는 cmdlet에 대한 명령어인데 해당 명령어만 출력하도록 해보겠습니다.
&lt;code class=&quot;highlighter-rouge&quot;&gt;Get-Command -CommandType cmdlet&lt;/code&gt;을 실행합니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nb&quot;&gt;Get-Command&lt;/span&gt; -CommandType cmdlet

CommandType     Name                                               Version    Source
-----------     ----                                               -------    ------
Cmdlet          Add-AppvClientConnectionGroup                      1.0.0.0    AppvClient
Cmdlet          Add-AppvClientPackage                              1.0.0.0    AppvClient
Cmdlet          Add-AppvPublishingServer                           1.0.0.0    AppvClient
Cmdlet          Add-AppxPackage                                    2.0.0.0    Appx
Cmdlet          Add-AppxProvisionedPackage                         3.0        Dism
Cmdlet          Add-AppxVolume                                     2.0.0.0    Appx
Cmdlet          Add-BitsFile                                       2.0.0.0    BitsTransfer
Cmdlet          Add-CertificateEnrollmentPolicyServer              1.0.0.0    PKI
Cmdlet          Add-Computer                                       3.1.0.0    Microsoft.PowerShell.Management
Cmdlet          &lt;span class=&quot;nb&quot;&gt;Add-Content                                        &lt;/span&gt;3.1.0.0    Microsoft.PowerShell.Management
Cmdlet          &lt;span class=&quot;nb&quot;&gt;Add-History                                        &lt;/span&gt;3.0.0.0    Microsoft.PowerShell.Core
Cmdlet          Add-JobTrigger                                     1.1.0.0    PSScheduledJob
Cmdlet          Add-KdsRootKey                                     1.0.0.0    Kds
Cmdlet          Add-LocalGroupMember                               1.0.0.0    Microsoft.PowerShell.LocalAccounts
Cmdlet          &lt;span class=&quot;nb&quot;&gt;Add-Member                                         &lt;/span&gt;3.1.0.0    Microsoft.PowerShell.Utility
Cmdlet          &lt;span class=&quot;nb&quot;&gt;Add-PSSnapin                                       &lt;/span&gt;3.0.0.0    Microsoft.PowerShell.Core
Cmdlet          Add-SignerRule                                     1.0        ConfigCI
Cmdlet          Add-Type                                           3.1.0.0    Microsoft.PowerShell.Utility&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;cmdlet에 대한 명령어 목록이 출력된 것을 확인할 수 있습니다. 이 중에서 process와 관련된 명령어를 찾고자 한다면 &lt;code class=&quot;highlighter-rouge&quot;&gt;Get-Command -CommandType cmdlet -Name *process&lt;/code&gt; 을 입력합니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nb&quot;&gt;Get-Command&lt;/span&gt; -CommandType cmdlet -Name &lt;span class=&quot;k&quot;&gt;*process

&lt;/span&gt;CommandType     Name                                               Version    Source
-----------     ----                                               -------    ------
Cmdlet          Debug-Process                                      3.1.0.0    Microsoft.PowerShell.Management
Cmdlet          Enter-PSHostProcess                                3.0.0.0    Microsoft.PowerShell.Core
Cmdlet          &lt;span class=&quot;k&quot;&gt;Exit&lt;/span&gt;-PSHostProcess                                 3.0.0.0    Microsoft.PowerShell.Core
Cmdlet          &lt;span class=&quot;nb&quot;&gt;Get-Process                                        &lt;/span&gt;3.1.0.0    Microsoft.PowerShell.Management
Cmdlet          &lt;span class=&quot;nb&quot;&gt;Start&lt;/span&gt;-Process                                      3.1.0.0    Microsoft.PowerShell.Management
Cmdlet          &lt;span class=&quot;nb&quot;&gt;Stop-Process                                       &lt;/span&gt;3.1.0.0    Microsoft.PowerShell.Management
Cmdlet          Wait-Process                                       3.1.0.0    Microsoft.PowerShell.Management&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;여기서 Start-Process를 이용하여 notepad.exe를 실행시켜 보도록 하겠습니다. 그 전에 Start-Process를 어떻게 사용해야 하는지 알고 싶다면 &lt;code class=&quot;highlighter-rouge&quot;&gt;Get-Help Start-Process -example&lt;/code&gt;를 입력합니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nb&quot;&gt;Get-Help Start&lt;/span&gt;-Process -example

이름
    &lt;span class=&quot;nb&quot;&gt;Start&lt;/span&gt;-Process

개요
    Starts one or more processes on the &lt;span class=&quot;nb&quot;&gt;local &lt;/span&gt;computer.


    Example 1: &lt;span class=&quot;nb&quot;&gt;Start &lt;/span&gt;a &lt;span class=&quot;k&quot;&gt;process &lt;/span&gt;that uses default values

    &lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\&amp;gt;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;Start&lt;/span&gt;-Process -FilePath &lt;span class=&quot;s2&quot;&gt;&quot;sort.exe&quot;&lt;/span&gt;

    This &lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;starts a &lt;span class=&quot;k&quot;&gt;process &lt;/span&gt;that uses the Sort.exe file &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;the current folder. The &lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;uses all of the default values, including the default window style, working folder, and credentials.
    Example 2: Print a text file

    &lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\&amp;gt;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;Start&lt;/span&gt;-Process -FilePath &lt;span class=&quot;s2&quot;&gt;&quot;myfile.txt&quot;&lt;/span&gt; -WorkingDirectory &lt;span class=&quot;s2&quot;&gt;&quot;C:&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\P&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;S-Test&quot;&lt;/span&gt; -Verb Print

    This &lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;starts a &lt;span class=&quot;k&quot;&gt;process &lt;/span&gt;that prints the C:&lt;span class=&quot;se&quot;&gt;\P&lt;/span&gt;S-Test&lt;span class=&quot;se&quot;&gt;\M&lt;/span&gt;yFile.txt file.
    Example 3: &lt;span class=&quot;nb&quot;&gt;Start &lt;/span&gt;a &lt;span class=&quot;k&quot;&gt;process &lt;/span&gt;to &lt;span class=&quot;nb&quot;&gt;sort &lt;/span&gt;items to a new file

    &lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\&amp;gt;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;Start&lt;/span&gt;-Process -FilePath &lt;span class=&quot;s2&quot;&gt;&quot;Sort.exe&quot;&lt;/span&gt; -RedirectStandardInput &lt;span class=&quot;s2&quot;&gt;&quot;Testsort.txt&quot;&lt;/span&gt; -RedirectStandardOutput &lt;span class=&quot;s2&quot;&gt;&quot;Sorted.txt&quot;&lt;/span&gt; -RedirectStandardError &lt;span class=&quot;s2&quot;&gt;&quot;SortError.txt&quot;&lt;/span&gt; -UseNewEnvironment

    This &lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;starts a &lt;span class=&quot;k&quot;&gt;process &lt;/span&gt;that sorts items &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;the Testsort.txt file and returns the sorted items &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;the Sorted.txt files. Any errors are written to the SortError.txt file.

    The UseNewEnvironment parameter specifies that the &lt;span class=&quot;k&quot;&gt;process &lt;/span&gt;runs with its own environment variables.
    Example 4: &lt;span class=&quot;nb&quot;&gt;Start &lt;/span&gt;a &lt;span class=&quot;k&quot;&gt;process in &lt;/span&gt;a maximized window

    &lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\&amp;gt;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;Start&lt;/span&gt;-Process -FilePath &lt;span class=&quot;s2&quot;&gt;&quot;notepad&quot;&lt;/span&gt; -Wait -WindowStyle Maximized

    This &lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;starts the Notepad &lt;span class=&quot;k&quot;&gt;process&lt;/span&gt;. It maximizes the window and retains the window &lt;span class=&quot;k&quot;&gt;until &lt;/span&gt;the &lt;span class=&quot;k&quot;&gt;process &lt;/span&gt;completes.
    Example 5: &lt;span class=&quot;nb&quot;&gt;Start &lt;/span&gt;Windows Powershell as an administrator

    &lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\&amp;gt;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;Start&lt;/span&gt;-Process -FilePath &lt;span class=&quot;s2&quot;&gt;&quot;powershell&quot;&lt;/span&gt; -Verb runAs

    This &lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;starts Windows PowerShell by &lt;span class=&quot;k&quot;&gt;using &lt;/span&gt;the Run as administrator option.
    Example 6: &lt;span class=&quot;k&quot;&gt;Using &lt;/span&gt;different verbs to &lt;span class=&quot;nb&quot;&gt;start &lt;/span&gt;a &lt;span class=&quot;k&quot;&gt;process

    &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\&amp;gt;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$startExe&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;New-Object &lt;/span&gt;System.Diagnostics.ProcessStartInfo -Args PowerShell.exe
    &lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\&amp;gt;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$startExe&lt;/span&gt;.verbs
    open
    runas

    &lt;span class=&quot;c1&quot;&gt;# Starts a PowerShell process in a new console window.&lt;/span&gt;

    &lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\&amp;gt;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Start&lt;/span&gt;-Process -FilePath &lt;span class=&quot;s2&quot;&gt;&quot;powershell.exe&quot;&lt;/span&gt; -Verb open

    &lt;span class=&quot;c1&quot;&gt;# Starts a PowerShell process with &quot;Run as Administrator&quot; permissions.&lt;/span&gt;

    &lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\&amp;gt;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Start&lt;/span&gt;-Process -FilePath &lt;span class=&quot;s2&quot;&gt;&quot;powershell.exe&quot;&lt;/span&gt; -Verb runas

    These commands show how to find the verbs that can be used when starting a &lt;span class=&quot;k&quot;&gt;process&lt;/span&gt;, and the effect of &lt;span class=&quot;k&quot;&gt;using &lt;/span&gt;the verbs to &lt;span class=&quot;nb&quot;&gt;start &lt;/span&gt;the &lt;span class=&quot;k&quot;&gt;process&lt;/span&gt;.

    The available verbs are determined by the file name extension of the file that runs &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;the &lt;span class=&quot;k&quot;&gt;process&lt;/span&gt;. To find the verbs &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;a &lt;span class=&quot;k&quot;&gt;process&lt;/span&gt;, create a System.Diagnostics.ProcessStartInfo &lt;span class=&quot;kt&quot;&gt;object &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;the &lt;span class=&quot;k&quot;&gt;process &lt;/span&gt;file
     and look &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;the Verbs &lt;span class=&quot;nb&quot;&gt;property &lt;/span&gt;of the &lt;span class=&quot;kt&quot;&gt;object&lt;/span&gt;. This example uses the PowerShell.exe file that runs &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;the PowerShell &lt;span class=&quot;k&quot;&gt;process&lt;/span&gt;.

    The first &lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;uses &lt;span class=&quot;nb&quot;&gt;New-Object &lt;/span&gt;to create a System.Diagnostics.ProcessStartInfo &lt;span class=&quot;kt&quot;&gt;object &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;PowerShell.exe, the file that runs &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;the PowerShell &lt;span class=&quot;k&quot;&gt;process&lt;/span&gt;. The &lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;saves the ProcessStartInfo &lt;span class=&quot;kt&quot;&gt;object &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;t
    he &lt;span class=&quot;nv&quot;&gt;$startExe&lt;/span&gt; variable.

    The second &lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;displays the values &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;the Verbs &lt;span class=&quot;nb&quot;&gt;property &lt;/span&gt;of the ProcessStartInfo &lt;span class=&quot;kt&quot;&gt;object &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;the &lt;span class=&quot;nv&quot;&gt;$startExe&lt;/span&gt; variable. The results show that you can use the Open and Runas verbs with PowerShell.exe, or wit
    &lt;span class=&quot;nb&quot;&gt;h &lt;/span&gt;any &lt;span class=&quot;k&quot;&gt;process &lt;/span&gt;that runs a .exe file.

    The third &lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;starts a PowerShell &lt;span class=&quot;k&quot;&gt;process &lt;/span&gt;with the Open verb. The Open verb starts the &lt;span class=&quot;k&quot;&gt;process in &lt;/span&gt;a new console window.

    The fourth &lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;starts a PowerShell &lt;span class=&quot;k&quot;&gt;process &lt;/span&gt;with the RunAs verb. The RunAs verb starts the &lt;span class=&quot;k&quot;&gt;process &lt;/span&gt;with permissions of a member of the Administrators &lt;span class=&quot;nb&quot;&gt;group &lt;/span&gt;on the computer. This is the same as starting
    Windows PowerShell by &lt;span class=&quot;k&quot;&gt;using &lt;/span&gt;the Run as administrator option.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Start-Process notepad.exe&lt;/code&gt;를 입력하면 아래와 같이 notepad.exe가 실행된 것을 알 수 있습니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/powershell/cmdlet/start_process.png&quot; alt=&quot;powershell_start_process&quot; /&gt;&lt;/p&gt;

&lt;p&gt;반대로 &lt;code class=&quot;highlighter-rouge&quot;&gt;Stop-Process notepad.exe&lt;/code&gt;를 입력하면 아래와 같이 에러가 발생합니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nb&quot;&gt;Stop-Process &lt;/span&gt;notepad.exe
&lt;span class=&quot;nb&quot;&gt;Stop-Process&lt;/span&gt; : &lt;span class=&quot;s1&quot;&gt;'InputObject'&lt;/span&gt; 매개 변수를 바인딩할 수 없습니다. &lt;span class=&quot;s2&quot;&gt;&quot;System.String&quot;&lt;/span&gt; 유형의 &lt;span class=&quot;s2&quot;&gt;&quot;notepad.exe&quot;&lt;/span&gt; 값을 &lt;span class=&quot;s2&quot;&gt;&quot;System.Diagnostics.Process&quot;&lt;/span&gt; 유형으로 변환할 수 없습니다.
위치 줄:1 문자:14
+ &lt;span class=&quot;nb&quot;&gt;Stop-Process &lt;/span&gt;notepad.exe
+              ~~~~~~~~~~~
    + CategoryInfo          : InvalidArgument: &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;:&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;Stop-Process&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;, ParameterBindingException
    + FullyQualifiedErrorId : CannotConvertArgumentNoMessage,Microsoft.PowerShell.Commands.StopProcessCommand&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Get-Help&lt;/code&gt;를 이용해서 Stop-Proces에 대한 예시를 살펴봅니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nb&quot;&gt;Get-Help Stop-Process&lt;/span&gt; -example

이름
    &lt;span class=&quot;nb&quot;&gt;Stop-Process

&lt;/span&gt;개요
    Stops one or more running processes.


    Example 1: Stop all instances of a &lt;span class=&quot;k&quot;&gt;process

    &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\&amp;gt;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;Stop-Process&lt;/span&gt; -Name &lt;span class=&quot;s2&quot;&gt;&quot;notepad&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;위와 같이 &lt;code class=&quot;highlighter-rouge&quot;&gt;-Name&lt;/code&gt;이라는 옵션을 이용해야 합니다. 직접 실행해 보면 notepad가 종료된 것을 알 수 있습니다.&lt;/p&gt;

</description>
        <pubDate>Fri, 04 Aug 2017 17:06:00 +0900</pubDate>
        <link>http://localhost:4000/technique/2017/08/04/cmdlet/</link>
        <guid isPermaLink="true">http://localhost:4000/technique/2017/08/04/cmdlet/</guid>
        
        <category>powershell</category>
        
        
        <category>technique</category>
        
      </item>
    
      <item>
        <title>PowerShell 기초</title>
        <description>&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h3 id=&quot;개념&quot;&gt;개념&lt;/h3&gt;

&lt;p&gt;Linux에서 터미널을 이용하여 ls, pwd 등과 같은 명령어를 사용하는 것 처럼 Windows에서도 명령어들을 이용하여 사용할 수 있도록 하는 것이 PowerShell 입니다.&lt;/p&gt;

&lt;p&gt;물론 Windows에서는 cmd라고 하는 것도 있지만 이보다 더 많은 명령어들이 포함되어 있습니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/powershell/basic/ps_cmd.png&quot; alt=&quot;powershell_and_cmd&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h3 id=&quot;설명&quot;&gt;설명&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nb&quot;&gt;ls


    &lt;/span&gt;디렉터리: C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
d-r---   2017. 7. 31.   오후 8:13                Contacts
d-r---    2017. 8. 2.   오후 2:33                Desktop
d-r---    2017. 8. 2.   오후 2:09                Documents
d-r---    2017. 8. 2.   오후 2:33                Downloads
d-r---   2017. 7. 31.   오후 8:13                Favorites
d-r---   2017. 7. 31.   오후 8:13                Links
d-r---   2017. 7. 31.   오후 8:13                Music
d-r---   2017. 7. 31.   오후 5:35                OneDrive
d-r---   2017. 7. 31.   오후 8:13                Pictures
d-r---   2017. 7. 31.   오후 8:13                Saved Games
d-r---   2017. 7. 31.   오후 8:13                Searches
d-r---   2017. 7. 31.   오후 8:13                Videos


&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nb&quot;&gt;dir


    &lt;/span&gt;디렉터리: C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
d-r---   2017. 7. 31.   오후 8:13                Contacts
d-r---    2017. 8. 2.   오후 2:33                Desktop
d-r---    2017. 8. 2.   오후 2:09                Documents
d-r---    2017. 8. 2.   오후 2:33                Downloads
d-r---   2017. 7. 31.   오후 8:13                Favorites
d-r---   2017. 7. 31.   오후 8:13                Links
d-r---   2017. 7. 31.   오후 8:13                Music
d-r---   2017. 7. 31.   오후 5:35                OneDrive
d-r---   2017. 7. 31.   오후 8:13                Pictures
d-r---   2017. 7. 31.   오후 8:13                Saved Games
d-r---   2017. 7. 31.   오후 8:13                Searches
d-r---   2017. 7. 31.   오후 8:13                Videos


&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;PowerShell에서는 PowerShell에서만 사용할 수 있는 명령어도 있지만 기존에 사용하던 Windows 명령어도 사용이 가능하고, Linux에서 사용하던 명령어도 사용할 수 있습니다.&lt;/p&gt;

&lt;p&gt;Linux에서 명령어를 사용할 때 alias라는 명령어가 있는데 이는 명령어의 별칭을 붙여서 사용할 수 있습니다. 즉, a라고 입력을 하면 ls가 실행이 되도록 하는 것이죠.&lt;/p&gt;

&lt;p&gt;PowerShell에서도 ls, dir이 모두 같은 결과값을 출력하는데 alias를 통해서 같은 명령어를 실행할 것입니다.&lt;/p&gt;

&lt;p&gt;alias에 대한 명령어가 어떤것이 있는지 확인하기 위해서 &lt;code class=&quot;highlighter-rouge&quot;&gt;Get-Help *alias&lt;/code&gt;를 입력합니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nb&quot;&gt;Get-Help&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;alias

&lt;/span&gt;Name                              Category  Module                    Synopsis
----                              --------  ------                    --------
&lt;span class=&quot;nb&quot;&gt;Export-Alias                      &lt;/span&gt;Cmdlet    Microsoft.PowerShell.U... ...
&lt;span class=&quot;nb&quot;&gt;Get-Alias                         &lt;/span&gt;Cmdlet    Microsoft.PowerShell.U... ...
&lt;span class=&quot;nb&quot;&gt;Import-Alias                      &lt;/span&gt;Cmdlet    Microsoft.PowerShell.U... ...
&lt;span class=&quot;nb&quot;&gt;New-Alias                         &lt;/span&gt;Cmdlet    Microsoft.PowerShell.U... ...
&lt;span class=&quot;nb&quot;&gt;Set-Alias                         &lt;/span&gt;Cmdlet    Microsoft.PowerShell.U... ...&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;위 결과값에서 Get-Alias라는 명령어를 볼 수 있는데 모든 명령어를 확인 하기위해서 &lt;code class=&quot;highlighter-rouge&quot;&gt;Get-Alias *&lt;/code&gt;를 입력합니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nb&quot;&gt;Get-Alias&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;

CommandType     Name                                               Version    Source
-----------     ----                                               -------    ------
...
Alias           &lt;span class=&quot;nb&quot;&gt;dir&lt;/span&gt; -&amp;gt; &lt;span class=&quot;nb&quot;&gt;Get-ChildItem&lt;/span&gt;
...
Alias           &lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; -&amp;gt; &lt;span class=&quot;nb&quot;&gt;Get-ChildItem&lt;/span&gt;
...&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ls&lt;/code&gt; 명령어와 &lt;code class=&quot;highlighter-rouge&quot;&gt;dir&lt;/code&gt; 명령어는 PowerShell에서 Get-ChildItem 명령어가 실행되도록 되어있는 것을 알 수 있습니다.&lt;/p&gt;

&lt;p&gt;PowerShell에서는 명령어에 대한 예시들을 &lt;code class=&quot;highlighter-rouge&quot;&gt;Get-Help&lt;/code&gt;를 통해서 알 수 있습니다. 사용하는 OS의 환경에 따라, Get-Help 명령어가 안 될 수도 있습니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nb&quot;&gt;Get-Help Get-Alias

&lt;/span&gt;이름
    &lt;span class=&quot;nb&quot;&gt;Get-Alias

&lt;/span&gt;구문
    &lt;span class=&quot;nb&quot;&gt;Get-Alias&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[[&lt;/span&gt;-Name] &amp;lt;&lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt;&amp;gt;]  &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&amp;lt;CommonParameters&amp;gt;]

    &lt;span class=&quot;nb&quot;&gt;Get-Alias&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&amp;lt;CommonParameters&amp;gt;]


별칭
    &lt;span class=&quot;nb&quot;&gt;gal


&lt;/span&gt;설명
    Get-Help가 이 컴퓨터에서 이 cmdlet에 대한 도움말 파일을 찾을 수 없습니다. 일부 도움말만 표시합니다.
        -- 이 cmdlet을 포함하는 모듈에 대한 도움말 파일을 다운로드하여 설치하려면 Update-Help를 사용하십시오.
        -- 이 cmdlet에 대한 도움말 항목을 온라인으로 보려면 &lt;span class=&quot;s2&quot;&gt;&quot;Get-Help Get-Alias -Online&quot;&lt;/span&gt;을 입력하거나
           http://go.microsoft.com/fwlink/?LinkID&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;113306&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;으&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;로 이동하십시오.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;위 경우 &lt;code class=&quot;highlighter-rouge&quot;&gt;설명&lt;/code&gt; 부분을 보면 일부 도움말만 표시한다고 되어있는데 Update-Help를 통해서 도움말을 다운로드 합니다. 여기서 중요한 것은 반드시 &lt;code class=&quot;highlighter-rouge&quot;&gt;관리자 권한&lt;/code&gt;으로 실행해야 합니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/powershell/basic/update_help.png&quot; alt=&quot;powershell_and_cmd&quot; /&gt;&lt;/p&gt;

&lt;p&gt;설치가 완료되면 &lt;code class=&quot;highlighter-rouge&quot;&gt;Get-Help Get-Alias -examples&lt;/code&gt;를 입력해 봅니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;3y6reak&amp;gt; &lt;span class=&quot;nb&quot;&gt;Get-Help Get-Alias&lt;/span&gt; -examples

이름
    &lt;span class=&quot;nb&quot;&gt;Get-Alias

&lt;/span&gt;개요
    Gets the aliases &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;the current session.


    Example 1: Get all aliases &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;the current session

    &lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\&amp;gt;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;Get-Alias
    &lt;/span&gt;CommandType     Name
    -----------     ----
    Alias           % -&amp;gt; &lt;span class=&quot;k&quot;&gt;ForEach&lt;/span&gt;-Object
    Alias           ? -&amp;gt; &lt;span class=&quot;nb&quot;&gt;Where-Object
    &lt;/span&gt;Alias           &lt;span class=&quot;nb&quot;&gt;ac&lt;/span&gt; -&amp;gt; &lt;span class=&quot;nb&quot;&gt;Add-Content
    &lt;/span&gt;Alias           &lt;span class=&quot;nb&quot;&gt;asnp&lt;/span&gt; -&amp;gt; &lt;span class=&quot;nb&quot;&gt;Add-PSSnapin
    &lt;/span&gt;Alias           &lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; -&amp;gt; &lt;span class=&quot;nb&quot;&gt;Get-Content
    &lt;/span&gt;Alias           &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; -&amp;gt; &lt;span class=&quot;nb&quot;&gt;Set-Location
    &lt;/span&gt;Alias           &lt;span class=&quot;nb&quot;&gt;chdir&lt;/span&gt; -&amp;gt; &lt;span class=&quot;nb&quot;&gt;Set-Location
    &lt;/span&gt;Alias           &lt;span class=&quot;nb&quot;&gt;clc&lt;/span&gt; -&amp;gt; &lt;span class=&quot;nb&quot;&gt;Clear-Content
    &lt;/span&gt;Alias           &lt;span class=&quot;nb&quot;&gt;clear&lt;/span&gt; -&amp;gt; &lt;span class=&quot;nb&quot;&gt;Clear&lt;/span&gt;-Host
    Alias           &lt;span class=&quot;nb&quot;&gt;clhy&lt;/span&gt; -&amp;gt; &lt;span class=&quot;nb&quot;&gt;Clear&lt;/span&gt;-History â€¦

    This &lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;gets all aliases &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;the current session.

    The output shows the &amp;lt;&lt;span class=&quot;nb&quot;&gt;alias&lt;/span&gt;&amp;gt; -&amp;gt; &amp;lt;definition&amp;gt; format that was introduced &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;Windows PowerShell 3.0. This format is u
    sed only &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;aliases that &lt;span class=&quot;k&quot;&gt;do &lt;/span&gt;not include hyphens, because aliases with hyphens are typically preferred names &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;cm
    dlets and functions, rather than nicknames.
    Example 2: Get aliases by name

    &lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\&amp;gt;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;Get-Alias&lt;/span&gt; -Name g&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;, s&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; -Exclude Get-&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;

    This &lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;gets all aliases that &lt;span class=&quot;k&quot;&gt;begin &lt;/span&gt;with g or s, except &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;aliases that &lt;span class=&quot;k&quot;&gt;begin &lt;/span&gt;with Get-.
    Example 3: Get aliases &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;a cmdlet

    &lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\&amp;gt;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;Get-Alias&lt;/span&gt; -Definition &lt;span class=&quot;nb&quot;&gt;Get-ChildItem

    &lt;/span&gt;This &lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;gets the aliases &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;the &lt;span class=&quot;nb&quot;&gt;Get-ChildItem &lt;/span&gt;cmdlet.

    By default, the &lt;span class=&quot;nb&quot;&gt;Get-Alias &lt;/span&gt;cmdlet gets the item name when you know the alias. The Definition parameter gets the alia
    s when you know the item name.
    Example 4: Get aliases by &lt;span class=&quot;nb&quot;&gt;property

    PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\&amp;gt;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;Get-Alias&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;Where-Object&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_&lt;/span&gt;.Options -Match &lt;span class=&quot;s2&quot;&gt;&quot;ReadOnly&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    This &lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;gets all aliases &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;which the value of the Options &lt;span class=&quot;nb&quot;&gt;property &lt;/span&gt;is ReadOnly. This &lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;provides a quick
     way to find the aliases that are built into Windows PowerShell, because they have the ReadOnly option.

    Options is just one &lt;span class=&quot;nb&quot;&gt;property &lt;/span&gt;of the AliasInfo objects that &lt;span class=&quot;nb&quot;&gt;Get-Alias &lt;/span&gt;gets. To find all properties and methods of Al
    iasInfo objects, &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;Get-Alias&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;get-member&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;.
    Example 5: Get aliases by name and &lt;span class=&quot;k&quot;&gt;filter &lt;/span&gt;by beginning letter

    &lt;span class=&quot;nb&quot;&gt;PS &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\&amp;gt;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;Get-Alias&lt;/span&gt; -Definition &lt;span class=&quot;s2&quot;&gt;&quot;*-PSSession&quot;&lt;/span&gt; -Exclude e&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; -Scope Global

    This example gets aliases &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;commands that have names that &lt;span class=&quot;k&quot;&gt;end in&lt;/span&gt; -PSSession, except &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;those that &lt;span class=&quot;k&quot;&gt;begin &lt;/span&gt;with e.

    The &lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;uses the Scope parameter to apply the &lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;the global scope. This is useful &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;scripts when you w
    ant to get the aliases &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;the session.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;위와 같이 해당 명령어에 대한 예제들도 출력하는 것을 볼 수 있습니다.&lt;/p&gt;
</description>
        <pubDate>Thu, 03 Aug 2017 13:20:00 +0900</pubDate>
        <link>http://localhost:4000/technique/2017/08/03/PowerShell_basic/</link>
        <guid isPermaLink="true">http://localhost:4000/technique/2017/08/03/PowerShell_basic/</guid>
        
        <category>powershell</category>
        
        
        <category>technique</category>
        
      </item>
    
      <item>
        <title>Save Frame Pointer Overwrite</title>
        <description>&lt;h3 id=&quot;개념&quot;&gt;개념&lt;/h3&gt;

&lt;p&gt;Buffer Overflow가 발생하는 프로그램의 취약점을 이용하여 Save Frame Pinter를 덮어씌워 원하는 주소로 이동하는 방법을 말합니다.&lt;/p&gt;

&lt;h3 id=&quot;설명&quot;&gt;설명&lt;/h3&gt;

&lt;p&gt;Buffer Overflow에서 잠깐 언급했던 Save Frame Pointer(SFP)는 &lt;code class=&quot;highlighter-rouge&quot;&gt;이전 함수의 ebp&lt;/code&gt;를 저장해 두고 함수의 실행이 끝나면 돌아가는 역할을 했습니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-c&quot; data-lang=&quot;c&quot;&gt;&lt;span class=&quot;cp&quot;&gt;#include &amp;lt;stdio.h&amp;gt;
&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Main Func&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;sub_func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;sub_func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;scanf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;%s&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;위 소스코드를 보면 main 함수에서는 출력과 sub_func()을 호출하고 sub_func 함수에서는 buf가 8개의 공간이 할당되었고 scanf를 이용해 buf에 값을 저장합니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;gdb-peda$ &lt;/span&gt;Dump of assembler code &lt;span class=&quot;k&quot;&gt;for function &lt;/span&gt;main:
0x0804846d &amp;lt;+0&amp;gt;:	push	ebp
0x0804846e &amp;lt;+1&amp;gt;:	mov 	ebp,esp
0x08048470 &amp;lt;+3&amp;gt;:	sub 	esp,0x4
0x08048473 &amp;lt;+6&amp;gt;:	mov	DWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;esp],0x8048540
0x0804847a &amp;lt;+13&amp;gt;:	call	0x8048330 &amp;lt;puts@plt&amp;gt;
0x0804847f &amp;lt;+18&amp;gt;:	call	0x804848b &amp;lt;sub_func&amp;gt;
0x08048484 &amp;lt;+23&amp;gt;:	mov	eax,0
0x08048489 &amp;lt;+28&amp;gt;:	leave
0x0804848a &amp;lt;+29&amp;gt;:	ret
End of assembler dump.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;위 어셈블리 코드에서 puts와 sub_func의 호출을 볼 수 있으며 puts를 호출하기 전 esp에 &lt;code class=&quot;highlighter-rouge&quot;&gt;0x8048540&lt;/code&gt; 값을 저장하고 있습니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;gdb-peda$ &lt;/span&gt;x/s 0x8048540
0x8048540:	&lt;span class=&quot;s2&quot;&gt;&quot;Main Func&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;0x804847f&lt;/code&gt;에 Breakpoint를 걸고 해당 주소까지 실행해 보도록 하겠습니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;gdb-peda$ &lt;/span&gt;Dump of assembler code &lt;span class=&quot;k&quot;&gt;for function &lt;/span&gt;main:
	0x0804846d &amp;lt;+0&amp;gt;:	push	ebp
	0x0804846e &amp;lt;+1&amp;gt;:	mov 	ebp,esp
	0x08048470 &amp;lt;+3&amp;gt;:	sub 	esp,0x4
	0x08048473 &amp;lt;+6&amp;gt;:	mov	DWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;esp],0x8048540
	0x0804847a &amp;lt;+13&amp;gt;:	call	0x8048330 &amp;lt;puts@plt&amp;gt;
&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;gt;	0x0804847f &amp;lt;+18&amp;gt;:	call	0x804848b &amp;lt;sub_func&amp;gt;
	0x08048484 &amp;lt;+23&amp;gt;:	mov	eax,0
	0x08048489 &amp;lt;+28&amp;gt;:	leave
	0x0804848a &amp;lt;+29&amp;gt;:	ret
End of assembler dump.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;해당 위치에서 esp 부터 10개의 값은 아래와 같습니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;gdb-peda$ &lt;/span&gt;x/10wx &lt;span class=&quot;nv&quot;&gt;$esp&lt;/span&gt;
0xbffff154:	0x08048540	0x00000000	0xb7e2fa83	0x00000001
0xbffff164:	0xbffff1f4	0xbffff1fc	0xb7feccea	0x00000001
0xbffff174:	0xbffff1f4	0xbffff194&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;이제 여기서 sub_func 함수 안으로 들어가 보도록 하겠습니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;gdb-peda$ &lt;/span&gt;Dump of assembler code &lt;span class=&quot;k&quot;&gt;for function &lt;/span&gt;sub_func:
&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;gt;	0x0804848b &amp;lt;+0&amp;gt;:	push	ebp
	0x0804848c &amp;lt;+1&amp;gt;:	mov 	ebp,esp
	0x0804848e &amp;lt;+3&amp;gt;:	sub 	esp,0x10
	0x08048491 &amp;lt;+6&amp;gt;:	lea	eax,[ebp-0x8]
	0x08048494 &amp;lt;+9&amp;gt;:	mov	DWORD PTR[esp+0x4],eax
	0x08048498 &amp;lt;+13&amp;gt;:	mov	DWORD PTR[esp],0x804854b
	0x0804849f &amp;lt;+20&amp;gt;:	call	0x8048360 &amp;lt;__isoc99_scanf@plt&amp;gt;
	0x080484a4 &amp;lt;+25&amp;gt;:	leave
	0x080484a5 &amp;lt;+26&amp;gt;:	ret
End of assembler dump.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;sub_func 함수 내로 들어온 후 esp 값을 확인해보면 아래와 같습니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;gdb-peda$ &lt;/span&gt;x/10wx &lt;span class=&quot;nv&quot;&gt;$esp&lt;/span&gt;
0xbffff150:	0x08048484	0x08048540	0x00000000	0xb7e2fa83
0xbffff160:	0x00000001	0xbffff1f4	0xbffff1fc	0xb7feccea
0xbffff170:	0x00000001	0xbffff1f4&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;스택에 쌓여진 값을 살펴보면 &lt;code class=&quot;highlighter-rouge&quot;&gt;0x8048484&lt;/code&gt;라는 값을 확인할 수 있는데 이 값은 main함수에서 sub_func이 있는 곳의 다음 주소를 나타냅니다. &lt;code class=&quot;highlighter-rouge&quot;&gt;다음 주소를 쌓아두는 이유는 sub_func 함수가 끝나면 main에서 다음 코드를 실행해야 하기 때문에 쌓아둔 것&lt;/code&gt;이며 이 값이 &lt;code class=&quot;highlighter-rouge&quot;&gt;Return&lt;/code&gt;값이 됩니다.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;0x804849f&lt;/code&gt;에 Breakpoint를 걸고 해당 주소까지 실행 후 스택을 확인해 보도록 하겠습니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;gdb-peda$ &lt;/span&gt;Dump of assembler code &lt;span class=&quot;k&quot;&gt;for function &lt;/span&gt;sub_func:
	0x0804848b &amp;lt;+0&amp;gt;:	push	ebp
	0x0804848c &amp;lt;+1&amp;gt;:	mov 	ebp,esp
	0x0804848e &amp;lt;+3&amp;gt;:	sub 	esp,0x10
	0x08048491 &amp;lt;+6&amp;gt;:	lea	eax,[ebp-0x8]
	0x08048494 &amp;lt;+9&amp;gt;:	mov	DWORD PTR[esp+0x4],eax
	0x08048498 &amp;lt;+13&amp;gt;:	mov	DWORD PTR[esp],0x804854b
&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;gt;	0x0804849f &amp;lt;+20&amp;gt;:	call	0x8048360 &amp;lt;__isoc99_scanf@plt&amp;gt;
	0x080484a4 &amp;lt;+25&amp;gt;:	leave
	0x080484a5 &amp;lt;+26&amp;gt;:	ret
End of assembler dump.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;gdb-peda$ &lt;/span&gt;x/10wx &lt;span class=&quot;nv&quot;&gt;$esp&lt;/span&gt;
0xbffff13c:	0x0804854b	0xbffff144	0x00000000	0x00000000
0xbffff14c:	0xbffff158	0x08048484	0x08048540	0x00000000
0xbffff15c:	0xb7e2fa83	0x00000001&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;scanf 함수가 사용하는 인자 값은 2개이기 때문에 &lt;code class=&quot;highlighter-rouge&quot;&gt;0x804854b&lt;/code&gt;와 &lt;code class=&quot;highlighter-rouge&quot;&gt;0xbffff144&lt;/code&gt;가 인자 값이 됩니다.
0x804854b는 &lt;code class=&quot;highlighter-rouge&quot;&gt;%s&lt;/code&gt;가 되며 0xbffff144는 &lt;code class=&quot;highlighter-rouge&quot;&gt;buf의 주소&lt;/code&gt;가 됩니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;gdb-peda$ &lt;/span&gt;x/10wx 0xbffff144
0xbffff144:	0x00000000	0x00000000	0xbffff158	0x08048484
0xbffff154:	0x08048540	0x00000000	0xb7e2fa83	0x00000001
0xbffff164:	0xbffff1f4	0xbffff1fc&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;0xbffff144의 스택을 살펴보면 아직 scanf가 실행되지 않았기 때문에 값이 0x00000000로 되어있는 것을 알 수 있습니다. scanf가 실행되고 난 뒤를 실펴보기 위해 &lt;code class=&quot;highlighter-rouge&quot;&gt;ni&lt;/code&gt;명령으로 실행 후 &lt;code class=&quot;highlighter-rouge&quot;&gt;12345678&lt;/code&gt;값을 입력하고 다시 스택을 살펴보면 아래와 같습니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;gdb-peda$ &lt;/span&gt;x/10wx 0xbffff144
0xbffff144:	0x34333231	0x38373635	0xbffff100	0x08048484
0xbffff154:	0x08048540	0x00000000	0xb7e2fa83	0x00000001
0xbffff164:	0xbffff1f4	0xbffff1fc&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;buf의 다음은 Save Frame Pointer 이므로 0xbffff100이 Save Frame Pointer가 됩니다.&lt;/p&gt;

&lt;p&gt;값을 입력하기 전에 SFP의 값은 0xbffff158 이었는데 0xbffff100으로 바뀐 이유는 문자열을 입력하면서 &lt;code class=&quot;highlighter-rouge&quot;&gt;마지막에 Null이 포함&lt;/code&gt;된 것입니다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h3 id=&quot;이해&quot;&gt;이해&lt;/h3&gt;
&lt;p&gt;LOB의 golem 소소코드를 이용하여 SFP를 실습해 보도록 하겠습니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-c&quot; data-lang=&quot;c&quot;&gt;&lt;span class=&quot;cp&quot;&gt;#include &amp;lt;stdio.h&amp;gt;
#include &amp;lt;stdlib.h&amp;gt;
&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;proglem_child&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;buffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;40&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;strncpy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;buffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;41&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;%s&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;buffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;argc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[])&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;argv error&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;exit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;prolem_child&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;main 함수에서 argv로 인자 값을 받아오고 해당 값을 problem_child 함수에서 src로 받습니다.
src로 받은 값을 buffer에 41개 만큼 저장합니다.&lt;/p&gt;

&lt;p&gt;여기서 중요한 것은 &lt;code class=&quot;highlighter-rouge&quot;&gt;buffer의 크기는 40인데 strncpy를 이용해 41개를 넣어주는 것입니다.&lt;/code&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;gdb-peda$ &lt;/span&gt;pdisas main
Dump of assembler code &lt;span class=&quot;k&quot;&gt;for function &lt;/span&gt;main:
	0x080484aa &amp;lt;+0&amp;gt;:	push	ebp
	0x080484ab &amp;lt;+1&amp;gt;:	mov 	ebp,esp
	0x080484ad &amp;lt;+3&amp;gt;:	sub 	esp,0x4
	0x080484b0 &amp;lt;+6&amp;gt;:	cmp	DWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;ebp+0x8],0x1
	0x080484b4 &amp;lt;+10&amp;gt;:	jg	0x80484ce &amp;lt;main+36&amp;gt;
	0x080484b6 &amp;lt;+12&amp;gt;:	mov	DWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;esp],0x8048570
	0x080484bd &amp;lt;+19&amp;gt;:	call	0x8048330 &amp;lt;puts@plt&amp;gt;
	0x080484c2 &amp;lt;+24&amp;gt;:	mov	DWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;esp],0x0
	0x080484c9 &amp;lt;+31&amp;gt;:	call	0x8048350 &amp;lt;&lt;span class=&quot;nb&quot;&gt;exit&lt;/span&gt;@plt&amp;gt;
	0x080484ce &amp;lt;+36&amp;gt;:	mov	eax, DWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;ebp+0xc]
	0x080484d1 &amp;lt;+39&amp;gt;:	add 	eax,0x4
	0x080484d4 &amp;lt;+42&amp;gt;:	mov	eax,DWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;eax]
	0x080484d6 &amp;lt;+44&amp;gt;:	mov	DWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;esp],eax
	0x080484d9 &amp;lt;+47&amp;gt;:	call	0x804847d &amp;lt;problem_child&amp;gt;
	0x080484de &amp;lt;+52&amp;gt;:	leave
	0x080484df &amp;lt;+53&amp;gt;:	ret
End of assembler dump.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;problem_child 위치에 Breakpoint를 걸고 `python -c ‘print “A”*40 + “B”’`를 이용해 argv[1]에 값을 넣고 problem_child 함수 안으로 들어갑니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;Dump of assembler code &lt;span class=&quot;k&quot;&gt;for function &lt;/span&gt;problem_child:
&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;gt;	0x0804847d &amp;lt;+0&amp;gt;:	push	ebp
	0x0804847e &amp;lt;+1&amp;gt;:	mov 	ebp,esp
	0x08048480 &amp;lt;+3&amp;gt;:	sub 	esp,0x34
	0x08048483 &amp;lt;+6&amp;gt;:	mov	DWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;esp+0x8],0x29
	0x0804848b &amp;lt;+14&amp;gt;:	mov	eax,DWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;ebp+0x8]
	0x0804848e &amp;lt;+17&amp;gt;:	mov	DWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;esp+0x4],eax
	0x08048492 &amp;lt;+21&amp;gt;:	lea 	eax,[ebp-0x28]
	0x08048495 &amp;lt;+24&amp;gt;:	mov 	DWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;esp],eax
	0x08048498 &amp;lt;+27&amp;gt;:	call 	0x8048370 &amp;lt;strncpy@plt&amp;gt;
	0x0804849d &amp;lt;+32&amp;gt;:	lea 	eax,[ebp-0x28]
	0x080484a0 &amp;lt;+35&amp;gt;:	mov	DWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;esp],eax
	0x080484a3 &amp;lt;+38&amp;gt;:	call	0x8048330 &amp;lt;puts@plt&amp;gt;
	0x080484a8 &amp;lt;+43&amp;gt;:	leave
	0x080484a9 &amp;lt;+44&amp;gt;:	ret
End of assembler dump.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;0x804849d&lt;/code&gt;에 Breakpoint를 걸고 buf의 값을 확인해 보도록 하겠습니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;Dump of assembler code &lt;span class=&quot;k&quot;&gt;for function &lt;/span&gt;problem_child:
	0x0804847d &amp;lt;+0&amp;gt;:	push	ebp
	0x0804847e &amp;lt;+1&amp;gt;:	mov 	ebp,esp
	0x08048480 &amp;lt;+3&amp;gt;:	sub 	esp,0x34
	0x08048483 &amp;lt;+6&amp;gt;:	mov	DWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;esp+0x8],0x29
	0x0804848b &amp;lt;+14&amp;gt;:	mov	eax,DWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;ebp+0x8]
	0x0804848e &amp;lt;+17&amp;gt;:	mov	DWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;esp+0x4],eax
	0x08048492 &amp;lt;+21&amp;gt;:	lea 	eax,[ebp-0x28]
	0x08048495 &amp;lt;+24&amp;gt;:	mov 	DWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;esp],eax
	0x08048498 &amp;lt;+27&amp;gt;:	call 	0x8048370 &amp;lt;strncpy@plt&amp;gt;
	0x0804849d &amp;lt;+32&amp;gt;:	lea 	eax,[ebp-0x28]
	0x080484a0 &amp;lt;+35&amp;gt;:	mov	DWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;esp],eax
	0x080484a3 &amp;lt;+38&amp;gt;:	call	0x8048330 &amp;lt;puts@plt&amp;gt;
	0x080484a8 &amp;lt;+43&amp;gt;:	leave
	0x080484a9 &amp;lt;+44&amp;gt;:	ret
End of assembler dump.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;gdb-peda$ &lt;/span&gt;x/10wx &lt;span class=&quot;nv&quot;&gt;$ebp&lt;/span&gt;-0x28
0xbffff0f4:	0x41414141	0x41414141	0x41414141	0x41414141
0xbffff104:	0x41414141	0x41414141	0x41414141	0x41414141
0xbffff114:	0x41414141	0x41414141	0xbffff142 	0x080484de
0xbffff124:	0xbffff39f	0x00000000 	0xb7e2fa83 	0x00000002
0xbffff134:	0xbffff1c4	0xbffff1d0	0xb7feccea	0x00000002&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;40개의 A와 B를 넣었더니 위와 같이 buf에 값이 채워졌습니다. 그리고 SFP의 값이 &lt;code class=&quot;highlighter-rouge&quot;&gt;0xbffff142&lt;/code&gt;로 변조된 것도 확인할 수 있습니다.&lt;/p&gt;

&lt;p&gt;이 변조된 값을 &lt;code class=&quot;highlighter-rouge&quot;&gt;함수의 에필로그&lt;/code&gt;를 이용하여 리턴 값을 조작할 수 있습니다.&lt;/p&gt;

&lt;p&gt;함수의 에필로그는 &lt;code class=&quot;highlighter-rouge&quot;&gt;leave&lt;/code&gt;와 &lt;code class=&quot;highlighter-rouge&quot;&gt;ret&lt;/code&gt;이 있는데 이 어셈블리어는 각각 &lt;code class=&quot;highlighter-rouge&quot;&gt;mov esp, ebp&lt;/code&gt; &lt;code class=&quot;highlighter-rouge&quot;&gt;pop ebp&lt;/code&gt;와 &lt;code class=&quot;highlighter-rouge&quot;&gt;pop eip&lt;/code&gt; &lt;code class=&quot;highlighter-rouge&quot;&gt;jmp eip&lt;/code&gt;가 됩니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;gdb-peda$ &lt;/span&gt;pdisas main
Dump of assembler code &lt;span class=&quot;k&quot;&gt;for function &lt;/span&gt;main:
	0x080484aa &amp;lt;+0&amp;gt;:	push	ebp
	0x080484ab &amp;lt;+1&amp;gt;:	mov 	ebp,esp
	0x080484ad &amp;lt;+3&amp;gt;:	sub 	esp,0x4
	0x080484b0 &amp;lt;+6&amp;gt;:	cmp	DWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;ebp+0x8],0x1
	0x080484b4 &amp;lt;+10&amp;gt;:	jg	0x80484ce &amp;lt;main+36&amp;gt;
	0x080484b6 &amp;lt;+12&amp;gt;:	mov	DWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;esp],0x8048570
	0x080484bd &amp;lt;+19&amp;gt;:	call	0x8048330 &amp;lt;puts@plt&amp;gt;
	0x080484c2 &amp;lt;+24&amp;gt;:	mov	DWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;esp],0x0
	0x080484c9 &amp;lt;+31&amp;gt;:	call	0x8048350 &amp;lt;&lt;span class=&quot;nb&quot;&gt;exit&lt;/span&gt;@plt&amp;gt;
	0x080484ce &amp;lt;+36&amp;gt;:	mov	eax, DWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;ebp+0xc]
	0x080484d1 &amp;lt;+39&amp;gt;:	add 	eax,0x4
	0x080484d4 &amp;lt;+42&amp;gt;:	mov	eax,DWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;eax]
	0x080484d6 &amp;lt;+44&amp;gt;:	mov	DWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;esp],eax
	0x080484d9 &amp;lt;+47&amp;gt;:	call	0x804847d &amp;lt;problem_child&amp;gt;
&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;gt;	0x080484de &amp;lt;+52&amp;gt;:	leave
	0x080484df &amp;lt;+53&amp;gt;:	ret
End of assembler dump.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;main에서 leave 위치까지 실행한 뒤에 ebp와 esp를 확인하면 아래와 같습니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;gdb-peda$ &lt;/span&gt;i r ebp
ebp 	0xbffff142 	0xbffff142&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;ebp를 확인한 결과 조작된 0xbffff142가 되었습니다. 여기서 leave 명령을 실행하면 &lt;code class=&quot;highlighter-rouge&quot;&gt;mov esp,ebp&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;pop ebp&lt;/code&gt; 이므로 ebp의 값을 esp로 옮기고 pop하여 ebp에 저장합니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;gdb-peda$ &lt;/span&gt;i r ebp esp
ebp 	0xf1c40000 	0xf1c40000
esp 	0xbffff146 	0xbffff146&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;변조 된 ebp 값이 &lt;code class=&quot;highlighter-rouge&quot;&gt;mov esp, ebp&lt;/code&gt;를 통해서 esp에 저장이 되었고 &lt;code class=&quot;highlighter-rouge&quot;&gt;pop ebp&lt;/code&gt;를 하면서 +4 만큼 증가되었습니다.&lt;/p&gt;

&lt;p&gt;그래서 esp의 값이 0xbffff146이 됩니다. (0xbffff142 + 0x4)&lt;/p&gt;

&lt;p&gt;그 후 0xbffff146에 있는 값을 &lt;code class=&quot;highlighter-rouge&quot;&gt;pop eip&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;jmp eip&lt;/code&gt;하면서 해당 위치로 이동하게 됩니다.&lt;/p&gt;

&lt;p&gt;따라서 &lt;code class=&quot;highlighter-rouge&quot;&gt;|shellcode 주소|\x90*n|shellcode|stack 주소 - 0x4|&lt;/code&gt;와 같은 payload를 사용할 수 있습니다.&lt;/p&gt;

</description>
        <pubDate>Tue, 25 Jul 2017 10:05:00 +0900</pubDate>
        <link>http://localhost:4000/technique/2017/07/25/Save_Frame_Pointer_Overwrite/</link>
        <guid isPermaLink="true">http://localhost:4000/technique/2017/07/25/Save_Frame_Pointer_Overwrite/</guid>
        
        <category>systemhacking</category>
        
        
        <category>technique</category>
        
      </item>
    
      <item>
        <title>Buffer Overflow</title>
        <description>&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h3 id=&quot;개념&quot;&gt;개념&lt;/h3&gt;

&lt;p&gt;Buffer Overflow (이하 bof)는 크기가 정해진 배열에 해당 크기 만큼 입력해야 하지만 &lt;code class=&quot;highlighter-rouge&quot;&gt;버퍼보다 큰 값&lt;/code&gt;
을 넣을 수 있는 취약점을 말합니다.&lt;/p&gt;

&lt;p&gt;예를들어, &lt;code class=&quot;highlighter-rouge&quot;&gt;char buf[10]&lt;/code&gt;로 선언했다면 buf는 총 10개의 공간을 갖게 됩니다. 하지만 프로그램이 실행 되면서 buf에 10개가 아닌 11개, 12개 혹은 그 이상의 값이 들어가는 것을 확인하지 않고 실행 하므로서 발생하는 취약점을 뜻 합니다.&lt;/p&gt;

&lt;p&gt;그래서 bof는 stack corruption으로도 불립니다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h3 id=&quot;설명&quot;&gt;설명&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-c&quot; data-lang=&quot;c&quot;&gt;&lt;span class=&quot;cp&quot;&gt;#include &amp;lt;stdio.h&amp;gt;
&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;scanf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;%s&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;위 소스코드를 보면 buf라는 char 배열에 총 8개의 값을 넣을 수 있고, scanf를 이용해서 buf에 값을 넣어줍니다. &lt;code class=&quot;highlighter-rouge&quot;&gt;scanf()&lt;/code&gt;는 &lt;code class=&quot;highlighter-rouge&quot;&gt;크기 제한&lt;/code&gt;이 없기 때문에 해당 부분에서 취약점이 발생할 수 있습니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;gdb-peda$ &lt;/span&gt;Dump of assembler code &lt;span class=&quot;k&quot;&gt;for function &lt;/span&gt;main:
0x0804843d &amp;lt;+0&amp;gt;:	push	ebp
0x0804843e &amp;lt;+1&amp;gt;:	mov 	ebp,esp
0x08048440 &amp;lt;+3&amp;gt;:	sub 	esp,0x10
0x08048443 &amp;lt;+6&amp;gt;:	lea 	eax,[ebp-0x8]
0x08048446 &amp;lt;+9&amp;gt;:	mov	DWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;esp+0x4],eax
0x0804844a &amp;lt;+13&amp;gt;:	mov	DWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;esp], 0x80484f0
0x08048451 &amp;lt;+20&amp;gt;:	call	0x80484330 &amp;lt;__isoc99_scanf@plt&amp;gt;
0x08048456 &amp;lt;+25&amp;gt;:	mov	eax,0x0
0x0804845b &amp;lt;+30&amp;gt;:	leave
0x0804845c &amp;lt;+31&amp;gt;:	ret
End of assembler dump.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;위 코드에서 &lt;code class=&quot;highlighter-rouge&quot;&gt;push ebp&lt;/code&gt; &lt;code class=&quot;highlighter-rouge&quot;&gt;mov ebp,esp&lt;/code&gt;가 함수의 프롤로그가 되며, &lt;code class=&quot;highlighter-rouge&quot;&gt;leave&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;ret&lt;/code&gt;이 함수의 에필로그가 됩니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;0x08048446 &amp;lt;+9&amp;gt;:	mov	DWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;esp+0x4],eax
0x0804844a &amp;lt;+13&amp;gt;:	mov	DWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;esp], 0x80484f0
0x08048451 &amp;lt;+20&amp;gt;:	call	0x80484330 &amp;lt;__isoc99_scanf@plt&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;스택 구조에 대해서 설명을 붙이자면 위 어셈블리 코드를 보면 scanf가 실행되기 전 &lt;code class=&quot;highlighter-rouge&quot;&gt;esp&lt;/code&gt;와 &lt;code class=&quot;highlighter-rouge&quot;&gt;esp+0x4&lt;/code&gt;에 값을 넣고 있는 것을 알 수 있습니다.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;scanf&lt;/code&gt;함수는 보통 &lt;code class=&quot;highlighter-rouge&quot;&gt;scanf(&quot;%s&quot;, buf)&lt;/code&gt; 형태로 코드를 작성합니다.&lt;/p&gt;

&lt;p&gt;여기서 &lt;code class=&quot;highlighter-rouge&quot;&gt;%s&lt;/code&gt;와 &lt;code class=&quot;highlighter-rouge&quot;&gt;buf&lt;/code&gt;가 &lt;code class=&quot;highlighter-rouge&quot;&gt;인자 값&lt;/code&gt;이 되기 때문에 &lt;code class=&quot;highlighter-rouge&quot;&gt;esp&lt;/code&gt;와 &lt;code class=&quot;highlighter-rouge&quot;&gt;esp+0x4&lt;/code&gt;에 값을 넣어주게 됩니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;gdb-peda$ &lt;/span&gt;x/2wx &lt;span class=&quot;nv&quot;&gt;$esp&lt;/span&gt;
0xbffff148:	0x080484f0	0xbffff150
&lt;span class=&quot;gp&quot;&gt;gdb-peda$ &lt;/span&gt;x/s 0x80484f0
0x80484f0:	&lt;span class=&quot;s2&quot;&gt;&quot;%s&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;esp 위치부터 2개가 값을 확인해 보면 &lt;code class=&quot;highlighter-rouge&quot;&gt;0x80484f0&lt;/code&gt;와 &lt;code class=&quot;highlighter-rouge&quot;&gt;0xbffff150&lt;/code&gt;이 있습니다. scanf가 필요한 인자 값이 2개 이므로 각각 &lt;code class=&quot;highlighter-rouge&quot;&gt;%s&lt;/code&gt;와 &lt;code class=&quot;highlighter-rouge&quot;&gt;buf&lt;/code&gt;를 뜻하게 됩니다.&lt;/p&gt;

&lt;p&gt;scanf를 실행한 뒤에 buf의 주소를 확인해 보면 값이 쌓여있는 것을 알 수 있습니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;gdb-peda$ &lt;/span&gt;x/10wx 0xbffff150
0xbffff150:	0x34333231	0x00000000	0x00000000	0xb7e1fa83
0xbffff160:	0x00000001	0xbffff1f4	0xbffff1fc	0xb7feccea
0xbffff170:	0x00000001	0xbffff1f4&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;1234&lt;/code&gt;라는 값을 입력했더니 &lt;code class=&quot;highlighter-rouge&quot;&gt;0x34333231&lt;/code&gt;라는 값이 저장되었습니다. 1234라는 값이 각각 hex 값으로 저장된 것입니다. 하지만 ascii 코드를 살펴보면 4321 순으로 저장된 것을 볼 수 있습니다.&lt;/p&gt;

&lt;p&gt;이는 &lt;code class=&quot;highlighter-rouge&quot;&gt;리틀엔디안과 빅엔디안&lt;/code&gt;차이에 따라서 결정됩니다.&lt;/p&gt;

&lt;p&gt;코드를 하나씩 살펴보면서 값이 어떻게 저장되는지 확인해 봤습니다. &lt;code class=&quot;highlighter-rouge&quot;&gt;scanf&lt;/code&gt;함수에서 취약점이 발생한다고 했으니 어떻게 되는지 알아보도록 하겠습니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;gdb-peda$ &lt;/span&gt;x/4wx 0xbffff150
0xbffff150:	0x34333231	0x38373635	0x00000000	0xb7e1fa83&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;이번에는 &lt;code class=&quot;highlighter-rouge&quot;&gt;12345678&lt;/code&gt;을 입력했습니다. 위 스택을 살펴보면 &lt;code class=&quot;highlighter-rouge&quot;&gt;4321 8765&lt;/code&gt; 순으로 쌓인 것을 알 수 있으며 buf의 크기가 8인데 8자리를 모두 사용했습니다.&lt;/p&gt;

&lt;p&gt;여기서 &lt;code class=&quot;highlighter-rouge&quot;&gt;scanf 함수는 크기를 제한하지 않으므로&lt;/code&gt; 값을 더 입력해 보겠습니다.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;gdb-peda$ &lt;/span&gt;x/4wx 0xbffff150
0xbffff150:	0x34333231	0x38373635	0x32313039	0x36353433&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;값을 더 입력했더니 뒤에 존재했던 값들이 모두 덮어 씌워졌습니다.&lt;/p&gt;

&lt;p&gt;이 상태에서 프로그램을 진행 시키면 &lt;code class=&quot;highlighter-rouge&quot;&gt;0x36353433 in ?? ()&lt;/code&gt; 과 같이 나타납니다. 이 말은 &lt;code class=&quot;highlighter-rouge&quot;&gt;0x36353433 주소로 이동&lt;/code&gt;을 했다는 것 입니다.&lt;/p&gt;

&lt;p&gt;이제 여기서 &lt;code class=&quot;highlighter-rouge&quot;&gt;Save Frame Pointer&lt;/code&gt;와 &lt;code class=&quot;highlighter-rouge&quot;&gt;Return&lt;/code&gt;을 알아야 합니다.&lt;/p&gt;

&lt;p&gt;Save Frame Pointer는 &lt;code class=&quot;highlighter-rouge&quot;&gt;이전함수에서의 ebp 값을 저장&lt;/code&gt;해 둡니다. 해당 함수가 실행되고 난 후에 다시 돌아가야 할 때 이 값을 기준으로 돌아가게 됩니다.&lt;/p&gt;

&lt;p&gt;Return은 해당 주소로 이동하는 것입니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/system_hacking/bof/stack.png&quot; alt=&quot;stack&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Stack의 구조는 위와 같이 이루어져 있기 때문에 앞서 값을 넘치게 입력했을 경우 0x36353433로 이동하게 된 것입니다.&lt;/p&gt;

&lt;p&gt;이러한 방법으로 &lt;code class=&quot;highlighter-rouge&quot;&gt;RET 값을 조작해서 system 함수를 호출하거나 프로그램 상에서 호출되지 않는 함수에도 접근이 가능&lt;/code&gt;하게 됩니다.&lt;/p&gt;
</description>
        <pubDate>Mon, 24 Jul 2017 15:03:00 +0900</pubDate>
        <link>http://localhost:4000/technique/2017/07/24/Buffer_OverFlow/</link>
        <guid isPermaLink="true">http://localhost:4000/technique/2017/07/24/Buffer_OverFlow/</guid>
        
        <category>systemhacking</category>
        
        
        <category>technique</category>
        
      </item>
    
  </channel>
</rss>
